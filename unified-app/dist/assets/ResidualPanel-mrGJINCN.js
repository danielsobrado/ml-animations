import{r,j as e,y as s}from"./index-quAWpIA7.js";import{m as a}from"./proxy-D7LjGbFl.js";import{P as o}from"./plus-C2RRVVSj.js";function h(){const[t,i]=r.useState(!0),[l,d]=r.useState(!0),n=t?1:.1;return e.jsxs("div",{className:"p-8 h-full flex flex-col items-center overflow-y-auto",children:[e.jsxs("div",{className:"max-w-3xl w-full text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-violet-400 mb-4",children:"Residual Connections"}),e.jsxs("p",{className:"text-lg text-slate-700 dark:text-slate-300 leading-relaxed",children:["The ",e.jsx("strong",{children:'"Add & Norm"'})," pattern used in every Transformer layer.",e.jsx("br",{}),"Residuals allow gradients to flow directly through the network."]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 w-full max-w-4xl mb-8",children:[e.jsx("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:"Residual Connection"}),e.jsx("p",{className:"text-xs text-slate-800 dark:text-slate-400",children:"Skip connection (Add)"})]}),e.jsx("button",{onClick:()=>i(!t),className:`relative w-16 h-8 rounded-full transition-colors ${t?"bg-green-500":"bg-slate-600"}`,children:e.jsx(a.div,{className:"absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-lg",animate:{x:t?32:0},transition:{type:"spring",stiffness:500,damping:30}})})]})}),e.jsx("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:"Layer Normalization"}),e.jsx("p",{className:"text-xs text-slate-800 dark:text-slate-400",children:"Normalize (Norm)"})]}),e.jsx("button",{onClick:()=>d(!l),className:`relative w-16 h-8 rounded-full transition-colors ${l?"bg-violet-500":"bg-slate-600"}`,children:e.jsx(a.div,{className:"absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-lg",animate:{x:l?32:0},transition:{type:"spring",stiffness:500,damping:30}})})]})})]}),e.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl border border-slate-700 w-full max-w-4xl",children:[e.jsx("h3",{className:"font-bold text-white mb-6 text-center",children:"Data Flow Through Transformer Layer"}),e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"bg-cyan-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg",children:"Input (x)"}),e.jsx(s,{className:"rotate-90 text-slate-800 dark:text-slate-400",size:32}),e.jsx("div",{className:"bg-purple-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg",children:"Sublayer (Attention / FFN)"}),e.jsx(s,{className:"rotate-90 text-slate-800 dark:text-slate-400",size:32}),t?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-green-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg flex items-center gap-3",children:[e.jsx(o,{size:24}),"Add (x + sublayer)"]}),e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute -left-32 top-1/2 transform -translate-y-1/2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-bold",children:"Skip"}),e.jsx(s,{className:"text-green-400",size:24})]})})]}):e.jsx("div",{className:"bg-slate-600 px-8 py-4 rounded-xl text-slate-700 dark:text-slate-300 font-bold text-lg opacity-50",children:"(No Residual)"}),e.jsx(s,{className:"rotate-90 text-slate-800 dark:text-slate-400",size:32}),l?e.jsx("div",{className:"bg-violet-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg",children:"Layer Norm"}):e.jsx("div",{className:"bg-slate-600 px-8 py-4 rounded-xl text-slate-700 dark:text-slate-300 font-bold text-lg opacity-50",children:"(No Normalization)"}),e.jsx(s,{className:"rotate-90 text-slate-800 dark:text-slate-400",size:32}),e.jsx("div",{className:"bg-cyan-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg",children:"Output"})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-700",children:[e.jsx("h4",{className:"font-bold text-white mb-4 text-center",children:"Gradient Flow (Backward Pass)"}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("div",{className:"text-slate-800 dark:text-slate-400",children:"Weak"}),e.jsx("div",{className:"flex-1 h-8 bg-slate-700 rounded-full overflow-hidden",children:e.jsx(a.div,{className:"h-full bg-gradient-to-r from-red-500 to-green-500",initial:{width:"0%"},animate:{width:`${n*100}%`},transition:{duration:.5}})}),e.jsx("div",{className:"text-slate-800 dark:text-slate-400",children:"Strong"})]}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-400 mt-4 text-center",children:t?"✅ Residual connections allow gradients to flow directly!":"⚠️ Without residuals, gradients vanish in deep networks."})]})]}),e.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-violet-500/50 w-full max-w-4xl mt-8",children:[e.jsx("h4",{className:"font-bold text-white mb-3 text-center",children:"The Transformer Formula"}),e.jsxs("div",{className:"font-mono text-center text-lg",children:[e.jsx("span",{className:"text-violet-300",children:"output = LayerNorm("}),e.jsx("span",{className:"text-cyan-300",children:"x"}),e.jsx("span",{className:"text-green-300",children:" + "}),e.jsx("span",{className:"text-purple-300",children:"Sublayer(x)"}),e.jsx("span",{className:"text-violet-300",children:")"})]}),e.jsx("p",{className:"text-xs text-slate-800 dark:text-slate-400 mt-3 text-center",children:"This pattern appears twice in every Transformer layer: once for attention, once for FFN."})]})]})}export{h as default};
