import{r as t,j as e,a as u,Z as p}from"./index-BmgLEcVh.js";import{S as g}from"./scale-CzSzz-6i.js";function N(){const[s,c]=t.useState(1),[n,d]=t.useState(150),[a,x]=t.useState(25),[r,m]=t.useState(!1);t.useEffect(()=>{if(r){const o=setInterval(()=>{d(l=>Math.max(20,l-Math.random()*5)),x(l=>{const h=10+Math.random()*5;return l+(h-l)*.1})},200);return()=>clearInterval(o)}},[r]);const i=n+s*a;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["VAE Loss: ",e.jsx("span",{className:"text-pink-400",children:"The ELBO"})]}),e.jsx("p",{className:"text-gray-400",children:"Evidence Lower Bound = Reconstruction Loss + KL Divergence"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-center text-lg font-bold mb-4",children:"The VAE Loss Function"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 flex-wrap text-lg font-mono",children:[e.jsx("span",{className:"text-gray-400",children:"‚Ñí"}),e.jsx("span",{className:"text-gray-500",children:"="}),e.jsx("div",{className:"bg-blue-900/30 border border-blue-500/30 rounded-lg px-4 py-2",children:e.jsxs("span",{className:"text-blue-400",children:["ùîº",e.jsx("sub",{children:"q(z|x)"}),"[log p(x|z)]"]})}),e.jsx("span",{className:"text-gray-500",children:"‚àí"}),e.jsx("div",{className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-2",children:e.jsx("span",{className:"text-purple-400",children:"Œ≤ ¬∑ KL(q(z|x) || p(z))"})})]}),e.jsxs("div",{className:"mt-4 grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-4 border border-blue-500/30",children:[e.jsxs("h4",{className:"font-bold text-blue-400 flex items-center gap-2",children:[e.jsx(u,{size:18}),"Reconstruction Loss"]}),e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"How well can we reconstruct the input from z? Usually Binary Cross-Entropy (for [0,1] pixels) or MSE. Encourages decoder to output xÃÇ ‚âà x."}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 font-mono",children:"BCE = -Œ£[x¬∑log(xÃÇ) + (1-x)¬∑log(1-xÃÇ)]"})]}),e.jsxs("div",{className:"bg-purple-900/20 rounded-xl p-4 border border-purple-500/30",children:[e.jsxs("h4",{className:"font-bold text-purple-400 flex items-center gap-2",children:[e.jsx(g,{size:18}),"KL Divergence Loss"]}),e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"Forces q(z|x) to be close to the prior p(z) = N(0, I). Regularizes the latent space to be smooth and continuous."}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 font-mono",children:"KL = -¬Ω Œ£[1 + log(œÉ¬≤) - Œº¬≤ - œÉ¬≤]"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(p,{size:20,className:"text-yellow-400"}),"Interactive Loss Balance"]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Œ≤ (KL Weight):"}),e.jsx("span",{className:"text-purple-400 font-mono",children:s.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:s,onChange:o=>c(parseFloat(o.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0 (No KL)"}),e.jsx("span",{children:"1 (Standard VAE)"}),e.jsx("span",{children:"4 (Strong regularization)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-blue-400",children:"Reconstruction Loss"}),e.jsx("span",{className:"font-mono",children:n.toFixed(1)})]}),e.jsx("div",{className:"h-6 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 transition-all duration-300",style:{width:`${Math.min(100,n/2)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-purple-400",children:"KL Loss √ó Œ≤"}),e.jsx("span",{className:"font-mono",children:(s*a).toFixed(1)})]}),e.jsx("div",{className:"h-6 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 transition-all duration-300",style:{width:`${Math.min(100,s*a/2)}%`}})})]}),e.jsxs("div",{className:"pt-2 border-t border-white/10",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-pink-400 font-bold",children:"Total Loss (ELBO)"}),e.jsx("span",{className:"font-mono font-bold",children:i.toFixed(1)})]}),e.jsx("div",{className:"h-8 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-pink-500 to-rose-600 transition-all duration-300",style:{width:`${Math.min(100,i/4)}%`}})})]})]}),e.jsx("button",{onClick:()=>m(!r),className:"mt-4 px-4 py-2 bg-pink-600 hover:bg-pink-700 rounded-lg transition-colors",children:r?"Stop Training Simulation":"Simulate Training"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-pink-900/30 rounded-2xl p-6 border border-purple-500/30",children:[e.jsx("h3",{className:"text-lg font-bold mb-3 text-purple-300",children:"üî¨ Œ≤-VAE: Disentanglement"}),e.jsxs("p",{className:"text-gray-300 mb-4",children:["By increasing Œ≤ ",">","1, we get ",e.jsx("strong",{children:"Œ≤-VAE"})," which encourages more disentangled latent representations. Each latent dimension learns to capture a single factor of variation."]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsx("p",{className:"font-bold text-center",children:"Œ≤ = 0"}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"Regular autoencoder. No KL constraint, no generation ability."})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3 ring-2 ring-purple-500/50",children:[e.jsx("p",{className:"font-bold text-center text-purple-400",children:"Œ≤ = 1"}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"Standard VAE. Balance of reconstruction and regularization."})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsxs("p",{className:"font-bold text-center",children:["Œ≤ ",">"," 1"]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-1",children:"Œ≤-VAE. Stronger regularization ‚Üí more disentanglement, blurrier reconstructions."})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"üìê KL Divergence Closed Form"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"For Gaussian distributions, KL divergence has a closed-form solution (no sampling needed!):"}),e.jsxs("div",{className:"bg-black/40 rounded-xl p-4 font-mono text-sm overflow-x-auto",children:[e.jsxs("p",{className:"text-purple-300",children:["KL(q(z|x) || p(z)) = -¬Ω Œ£",e.jsx("sub",{children:"j=1"}),e.jsx("sup",{children:"J"})," (1 + log(œÉ",e.jsx("sub",{children:"j"}),"¬≤) - Œº",e.jsx("sub",{children:"j"}),"¬≤ - œÉ",e.jsx("sub",{children:"j"}),"¬≤)"]}),e.jsx("p",{className:"text-gray-500 mt-2",children:"where J = latent_dim, and Œº, œÉ are outputs from encoder"})]}),e.jsxs("div",{className:"mt-4 bg-green-900/20 rounded-xl p-4 border border-green-500/30",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-2",children:"PyTorch Implementation:"}),e.jsx("pre",{className:"text-sm overflow-x-auto",children:e.jsx("code",{className:"text-green-300",children:`def kl_divergence(mu, logvar):
    # KL(q(z|x) || N(0, I))
    # = -0.5 * sum(1 + log(sigma^2) - mu^2 - sigma^2)
    return -0.5 * torch.sum(1 + logvar - mu.pow(2) - logvar.exp())

def vae_loss(x, x_recon, mu, logvar, beta=1.0):
    # Reconstruction loss (BCE for binary images)
    recon_loss = F.binary_cross_entropy(x_recon, x, reduction='sum')
    
    # KL divergence
    kl_loss = kl_divergence(mu, logvar)
    
    return recon_loss + beta * kl_loss`})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-4 border border-blue-500/30",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-2",children:"‚¨ÜÔ∏è High Reconstruction, Low KL"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Sharp, accurate reconstructions"}),e.jsx("li",{children:'‚Ä¢ Latent space may have "holes"'}),e.jsx("li",{children:"‚Ä¢ Poor generation quality"}),e.jsx("li",{children:"‚Ä¢ Overfitting to training data"})]})]}),e.jsxs("div",{className:"bg-purple-900/20 rounded-xl p-4 border border-purple-500/30",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-2",children:"‚¨ÜÔ∏è Low Reconstruction, High KL"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Blurry reconstructions"}),e.jsx("li",{children:"‚Ä¢ Smooth, continuous latent space"}),e.jsx("li",{children:"‚Ä¢ Better generation/interpolation"}),e.jsx("li",{children:"‚Ä¢ Information bottleneck"})]})]})]})]})}export{N as default};
