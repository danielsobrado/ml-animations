import{r as n,j as e,T as g,C as c,w as d,Z as j}from"./index-CsxpOLHd.js";import{P as b}from"./play-CIyTSByC.js";import{R as p}from"./rotate-ccw-xVnQluc9.js";import{C as u}from"./check-circle-C5pajHEW.js";function w(){const[s,i]=n.useState(1),[o,a]=n.useState(!1),r=[{title:"Step 1: The Ratio Hypothesis",description:"Word meaning is captured by probability ratios: F(w_i, w_j, wÌƒ_k) should encode P_ik / P_jk"},{title:"Step 2: Derive the Form",description:"Through mathematical derivation, we arrive at: w_i Â· wÌƒ_k + b_i + bÌƒ_k = log(X_ik)"},{title:"Step 3: Define the Loss",description:"Minimize the difference between dot product and log co-occurrence"},{title:"Step 4: Add Weighting",description:"Weight frequent co-occurrences less with f(X_ij) to prevent domination by common pairs"},{title:"Step 5: Final Objective",description:"The complete weighted least squares objective function"}],x=()=>{a(!0);let l=1;i(1);const t=setInterval(()=>{l++,l>r.length?(a(!1),clearInterval(t)):i(l)},3e3)},m=()=>{i(1),a(!1)};return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"gradient-text",children:"GloVe Objective:"})," The Math Behind the Magic"]}),e.jsx("p",{className:"text-gray-400",children:"Understanding how GloVe learns meaningful word vectors"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[e.jsxs("button",{onClick:x,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-violet-600 hover:bg-violet-700 disabled:opacity-50 rounded-lg transition-colors",children:[e.jsx(b,{size:18}),"Play Animation"]}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(p,{size:18}),"Reset"]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:r.map((l,t)=>e.jsx("button",{onClick:()=>i(t+1),className:`px-3 py-1 rounded-full text-sm transition-all ${s===t+1?"bg-violet-600 text-white":s>t+1?"bg-green-900/50 text-green-400":"bg-white/10 text-gray-400 hover:bg-white/20"}`,children:s>t+1?e.jsx(u,{size:14}):t+1},t))}),e.jsxs("div",{className:"bg-gradient-to-r from-violet-900/30 to-cyan-900/30 rounded-xl p-4 border border-violet-500/30",children:[e.jsx("h3",{className:"text-lg font-bold text-violet-400 mb-1",children:r[s-1].title}),e.jsx("p",{className:"text-gray-300",children:r[s-1].description})]}),s>=1&&e.jsxs("div",{className:`bg-black/30 rounded-xl p-6 border border-white/10 transition-all ${s===1?"ring-2 ring-violet-500":""}`,children:[e.jsxs("h4",{className:"flex items-center gap-2 text-lg font-bold text-violet-400 mb-4",children:[e.jsx(g,{size:20}),"The Probability Ratio Hypothesis"]}),e.jsx("div",{className:"bg-gradient-to-r from-violet-900/20 to-cyan-900/20 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-center font-mono text-lg text-gray-200",children:["F(w",e.jsx("sub",{children:"i"}),", w",e.jsx("sub",{children:"j"}),", wÌƒ",e.jsx("sub",{children:"k"}),") = P",e.jsx("sub",{children:"ik"})," / P",e.jsx("sub",{children:"jk"})]})}),e.jsx("p",{className:"text-gray-300 mb-4",children:"We want a function F that, given two word vectors and a context vector, encodes how much more likely word i co-occurs with k compared to word j."}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-violet-900/20 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-violet-400 font-mono",children:["w",e.jsx("sub",{children:"i"})]}),e.jsx("p",{className:"text-gray-400",children:'Word vector for "ice"'})]}),e.jsxs("div",{className:"bg-cyan-900/20 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-cyan-400 font-mono",children:["w",e.jsx("sub",{children:"j"})]}),e.jsx("p",{className:"text-gray-400",children:'Word vector for "steam"'})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-green-400 font-mono",children:["wÌƒ",e.jsx("sub",{children:"k"})]}),e.jsx("p",{className:"text-gray-400",children:'Context vector for "solid"'})]})]})]}),s>=2&&e.jsxs("div",{className:`bg-black/30 rounded-xl p-6 border border-white/10 transition-all ${s===2?"ring-2 ring-violet-500":""}`,children:[e.jsxs("h4",{className:"flex items-center gap-2 text-lg font-bold text-cyan-400 mb-4",children:[e.jsx(c,{size:20}),"Mathematical Derivation"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-black/30 rounded-lg p-3 font-mono text-sm",children:[e.jsx("p",{className:"text-gray-400",children:"Starting point:"}),e.jsxs("p",{className:"text-gray-200",children:["F(w",e.jsx("sub",{children:"i"})," - w",e.jsx("sub",{children:"j"}),", wÌƒ",e.jsx("sub",{children:"k"}),") = P",e.jsx("sub",{children:"ik"})," / P",e.jsx("sub",{children:"jk"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d,{className:"text-violet-400",size:24})}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-3 font-mono text-sm",children:[e.jsx("p",{className:"text-gray-400",children:"Using dot product (F = exp):"}),e.jsxs("p",{className:"text-gray-200",children:["exp((w",e.jsx("sub",{children:"i"})," - w",e.jsx("sub",{children:"j"}),") Â· wÌƒ",e.jsx("sub",{children:"k"}),") = P",e.jsx("sub",{children:"ik"})," / P",e.jsx("sub",{children:"jk"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d,{className:"text-violet-400",size:24})}),e.jsxs("div",{className:"bg-gradient-to-r from-violet-900/30 to-cyan-900/30 rounded-lg p-4 font-mono",children:[e.jsx("p",{className:"text-gray-400",children:"Final form:"}),e.jsxs("p",{className:"text-xl text-white text-center mt-2",children:["w",e.jsx("sub",{className:"text-violet-400",children:"i"})," Â· wÌƒ",e.jsx("sub",{className:"text-cyan-400",children:"k"})," + b",e.jsx("sub",{className:"text-violet-400",children:"i"})," + bÌƒ",e.jsx("sub",{className:"text-cyan-400",children:"k"})," = log(X",e.jsx("sub",{className:"text-green-400",children:"ik"}),")"]})]})]})]}),s>=3&&e.jsxs("div",{className:`bg-black/30 rounded-xl p-6 border border-white/10 transition-all ${s===3?"ring-2 ring-violet-500":""}`,children:[e.jsxs("h4",{className:"flex items-center gap-2 text-lg font-bold text-green-400 mb-4",children:[e.jsx(j,{size:20}),"Basic Loss Function"]}),e.jsx("div",{className:"bg-gradient-to-r from-green-900/20 to-cyan-900/20 rounded-lg p-4 font-mono text-center",children:e.jsxs("p",{className:"text-xl text-gray-200",children:["J = Î£",e.jsx("sub",{children:"i,j"})," (w",e.jsx("sub",{children:"i"})," Â· wÌƒ",e.jsx("sub",{children:"j"})," + b",e.jsx("sub",{children:"i"})," + bÌƒ",e.jsx("sub",{children:"j"})," - log X",e.jsx("sub",{children:"ij"}),")Â²"]})}),e.jsx("p",{className:"text-gray-300 mt-4 text-center",children:"Minimize the squared difference between the model prediction and the log co-occurrence."}),e.jsxs("div",{className:"mt-4 p-3 bg-yellow-900/20 rounded-lg border border-yellow-500/30",children:[e.jsx("p",{className:"text-yellow-400 font-medium",children:"âš ï¸ Problem:"}),e.jsx("p",{className:"text-sm text-gray-300",children:'Common word pairs (like "the, of") dominate the loss. We need weighting!'})]})]}),s>=4&&e.jsxs("div",{className:`bg-black/30 rounded-xl p-6 border border-white/10 transition-all ${s===4?"ring-2 ring-violet-500":""}`,children:[e.jsxs("h4",{className:"flex items-center gap-2 text-lg font-bold text-yellow-400 mb-4",children:[e.jsx(c,{size:20}),"Weighting Function f(X)"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gradient-to-r from-yellow-900/20 to-orange-900/20 rounded-lg p-4 font-mono",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Weighting function:"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-200",children:"f(x) = "}),e.jsxs("p",{className:"text-gray-200 mt-1",children:["(x / x",e.jsx("sub",{children:"max"}),")",e.jsx("sup",{children:"Î±"})," Â  if x < x",e.jsx("sub",{children:"max"})]}),e.jsx("p",{className:"text-gray-200 mt-1",children:"1 Â Â Â Â Â Â Â Â Â Â Â Â Â  otherwise"})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[e.jsxs("p",{className:"text-gray-300",children:[e.jsxs("span",{className:"text-yellow-400 font-mono",children:["x",e.jsx("sub",{children:"max"})," = 100"]})," â€” cap for frequent words"]}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("span",{className:"text-yellow-400 font-mono",children:"Î± = 0.75"})," â€” smoothing parameter"]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"f(x) visualization:"}),e.jsx("div",{className:"h-32 flex items-end gap-1",children:[1,10,25,50,75,100,150,200].map((l,t)=>{const h=l<=100?Math.pow(l/100,.75):1;return e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:"w-full bg-gradient-to-t from-yellow-600 to-yellow-400 rounded-t",style:{height:`${h*100}%`}}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:l})]},t)})}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Co-occurrence count X"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-400 font-medium",children:"f(0) = 0"}),e.jsx("p",{className:"text-gray-400",children:"No contribution from zero counts"})]}),e.jsxs("div",{className:"bg-cyan-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-cyan-400 font-medium",children:"f(100) = 1"}),e.jsx("p",{className:"text-gray-400",children:"Capped at x_max"})]})]})]}),s>=5&&e.jsxs("div",{className:`bg-gradient-to-r from-violet-900/30 to-cyan-900/30 rounded-xl p-6 border border-violet-500/50 transition-all ${s===5?"ring-2 ring-violet-400 pulse-glow":""}`,children:[e.jsx("h4",{className:"flex items-center gap-2 text-xl font-bold text-white mb-4",children:"ðŸŽ¯ The Complete GloVe Objective"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-6 font-mono text-center",children:e.jsxs("p",{className:"text-2xl text-white",children:["J = Î£",e.jsx("sub",{className:"text-violet-400",children:"i,j=1"}),e.jsx("sup",{className:"text-cyan-400",children:"V"})," f(X",e.jsx("sub",{className:"text-yellow-400",children:"ij"}),")(w",e.jsx("sub",{className:"text-violet-400",children:"i"})," Â· wÌƒ",e.jsx("sub",{className:"text-cyan-400",children:"j"})," + b",e.jsx("sub",{className:"text-violet-400",children:"i"})," + bÌƒ",e.jsx("sub",{className:"text-cyan-400",children:"j"})," - log X",e.jsx("sub",{className:"text-green-400",children:"ij"}),")Â²"]})}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-violet-900/30 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-violet-400 font-mono font-bold",children:["w",e.jsx("sub",{children:"i"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Word vector"})]}),e.jsxs("div",{className:"bg-cyan-900/30 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-cyan-400 font-mono font-bold",children:["wÌƒ",e.jsx("sub",{children:"j"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Context vector"})]}),e.jsxs("div",{className:"bg-yellow-900/30 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-yellow-400 font-mono font-bold",children:["f(X",e.jsx("sub",{children:"ij"}),")"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Weighting function"})]}),e.jsxs("div",{className:"bg-green-900/30 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-green-400 font-mono font-bold",children:["b",e.jsx("sub",{children:"i"}),", bÌƒ",e.jsx("sub",{children:"j"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Bias terms"})]})]}),e.jsxs("div",{className:"mt-6 bg-black/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-violet-400 font-medium mb-2",children:"ðŸŽ“ Final Word Vector"}),e.jsxs("p",{className:"text-gray-300 text-sm",children:["After training, the final word embedding is: ",e.jsx("span",{className:"font-mono text-white",children:"W + WÌƒ"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Since w and wÌƒ are symmetric, adding them gives slightly better performance."})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-6 border border-white/10",children:[e.jsx("h4",{className:"text-lg font-bold text-violet-400 mb-4",children:"ðŸ’¡ Key Properties of the GloVe Objective"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-violet-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-violet-400 font-medium mb-1",children:"Closed-form Statistics"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Uses pre-computed co-occurrence, not mini-batches"})]}),e.jsxs("div",{className:"bg-cyan-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-cyan-400 font-medium mb-1",children:"Weighted Least Squares"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Not SGD on prediction task like Word2Vec"})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-400 font-medium mb-1",children:"Log Transform"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Working in log space captures ratios naturally"})]}),e.jsxs("div",{className:"bg-yellow-900/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-yellow-400 font-medium mb-1",children:"Non-zero Entries Only"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Training only on observed co-occurrences (X_ij > 0)"})]})]})]})]})}export{w as default};
