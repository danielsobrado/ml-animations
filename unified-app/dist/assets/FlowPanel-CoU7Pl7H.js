import{r as l,j as e}from"./index-CsxpOLHd.js";import{S as B,C as M,O as T,W as P,G as A,k as O,M as F,a as I,e as W,f as z,g as H}from"./three.module-CNl0Zq82.js";import{g as u}from"./index-C8pce-KX.js";const m=[{id:"inputs",title:"1. Inputs Arrive",desc:"Previous Hidden State (h_t-1) and New Input (x_t) merge."},{id:"forget",title:"2. Forget Gate",desc:"Sigmoid layer decides what to keep from old Cell State."},{id:"input_gate",title:"3. Input Gate",desc:"Sigmoid layer decides which values to update."},{id:"candidates",title:"4. Candidate Values",desc:"Tanh layer creates new candidate values."},{id:"prep_update",title:"5. Prepare Update",desc:"Multiply Input Gate * Candidates."},{id:"cell_update",title:"6. Update Cell State",desc:"Old State * Forget + New Values. The Conveyor Belt moves!"},{id:"output_gate",title:"7. Output Gate",desc:"Sigmoid layer decides what to output."},{id:"hidden_update",title:"8. Hidden State",desc:"Tanh(Cell State) * Output Gate. The final result."}];function J(){const i=l.useRef(null),[s,g]=l.useState(0),[U,V]=l.useState(!1),S=l.useRef(null),n=l.useRef({});l.useEffect(()=>{if(!i.current)return;const r=i.current.clientWidth,t=400,p=new B;p.background=new M(16317180),S.current=p;const w=new T(r/-2,r/2,t/2,t/-2,.1,1e3);w.position.z=100;const o=new P({antialias:!0});o.setSize(r,t),i.current.appendChild(o.domElement);const a=(h,C,_,j)=>{const d=new A,N=new O(40,40,10),G=new F({color:h}),R=new I(N,G);d.add(R);const x=document.createElement("canvas");x.width=128,x.height=64;const c=x.getContext("2d");c.fillStyle="white",c.font="bold 40px Arial",c.textAlign="center",c.textBaseline="middle",c.fillText(j,64,32);const k=new W(x),E=new z({map:k}),f=new H(E);return f.scale.set(40,20,1),f.position.z=6,d.add(f),d.position.set(C,_,0),p.add(d),d};n.current.h_prev=a(3900150,-200,-100,"h-1"),n.current.x_t=a(2278750,-200,-150,"x_t"),n.current.c_prev=a(15381256,-250,100,"C-1"),n.current.forget=a(15680580,-100,0,"f_t"),n.current.input=a(2278750,0,0,"i_t"),n.current.cand=a(16347926,50,-50,"C~"),n.current.output=a(3900150,150,0,"o_t");const b=()=>{requestAnimationFrame(b),o.render(p,w)};return b(),()=>{var h;o.dispose(),(h=i.current)!=null&&h.contains(o.domElement)&&i.current.removeChild(o.domElement)}},[]);const v=r=>{const t=n.current;switch(r===0&&(u.set(t.h_prev.position,{x:-200,y:-100}),u.set(t.x_t.position,{x:-200,y:-150})),r){case 1:u.to(t.h_prev.position,{x:-150,duration:1}),u.to(t.x_t.position,{x:-150,duration:1});break;case 2:u.to(t.forget.scale,{x:1.2,y:1.2,duration:.5,yoyo:!0,repeat:1});break}},y=()=>{s<m.length&&(g(s+1),v(s+1))};return e.jsxs("div",{className:"p-4 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Bit-by-Bit Animation"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(0),className:"px-4 py-2 bg-slate-200 rounded hover:bg-slate-300 font-bold",children:"Reset"}),e.jsxs("button",{onClick:y,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 font-bold",children:["Next Step (",s,"/",m.length,")"]})]})]}),e.jsx("div",{ref:i,className:"flex-1 bg-slate-100 rounded-xl border border-slate-300 relative overflow-hidden"}),e.jsxs("div",{className:"mt-4 p-4 bg-white rounded-xl border border-slate-200 shadow-sm min-h-[100px]",children:[e.jsx("h3",{className:"font-bold text-lg text-indigo-900",children:m[s>0?s-1:0].title}),e.jsx("p",{className:"text-slate-600",children:m[s>0?s-1:0].desc})]})]})}export{J as default};
