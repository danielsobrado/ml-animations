import{r as b,j as i}from"./index-CsxpOLHd.js";import{S as B,C as U,O as X,W as G,A as D,a7 as F,G as V,k as I,a8 as O,a as T,E as _,b as q,L as H,e as J,f as K,g as Q}from"./three.module-CNl0Zq82.js";import{g as Y}from"./index-C8pce-KX.js";const W=.01;function ne({onStepChange:y}){const f=b.useRef(null),v=b.useRef(null),A=b.useRef(null),$=b.useRef(null),[l,R]=b.useState(0),[j,z]=b.useState(!1),x=[2,1,3],g=[1,-1,1],h=-5,w=x.reduce((e,s,n)=>e+s*g[n],0),d=w+h,p=d>0?d:W*d;b.useEffect(()=>{y&&y(l,d,p)},[l,y,d,p]),b.useEffect(()=>{if(!f.current)return;const e=new B;e.background=new U(16316922),v.current=e;const s=f.current.clientWidth,n=400,a=new X(-s/2,s/2,n/2,-n/2,.1,1e3);a.position.z=100;const t=new G({antialias:!0});t.setSize(s,n),f.current.appendChild(t.domElement),A.current=t;const o=new D(16777215,.8);e.add(o);const c=new F(16777215,.5);c.position.set(0,1,1),e.add(c);const u=()=>{$.current=requestAnimationFrame(u),t.render(e,a)};u();const r=()=>{if(!f.current)return;const m=f.current.clientWidth;a.left=-m/2,a.right=m/2,a.updateProjectionMatrix(),t.setSize(m,n)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r),cancelAnimationFrame($.current),t.dispose(),f.current&&t.domElement&&f.current.removeChild(t.domElement)}},[]),b.useEffect(()=>{if(!v.current)return;const e=v.current;for(;e.children.length>2;)e.remove(e.children[e.children.length-1]);const s=(a,t,o,c,u)=>{const r=new V,m=new I(50,50,10),S=new O({color:a}),E=new T(m,S);r.add(E);const L=new _(m),P=new q({color:3355443}),M=new H(L,P);return r.add(M),r.position.set(t,o,0),r.userData={label:c,value:u},r},n=(a,t,o,c=16,u="#333")=>{const r=document.createElement("canvas"),m=r.getContext("2d");r.width=256,r.height=64,m.fillStyle=u,m.font=`bold ${c*2}px Arial`,m.textAlign="center",m.textBaseline="middle",m.fillText(a,128,32);const S=new J(r),E=new K({map:S}),L=new Q(E);return L.position.set(t,o,1),L.scale.set(128,32,1),L};if(l===0){const a=n("Click Play to start",0,0,20);e.add(a)}if(l>=1){const a=n("X (Input)",-200,140,18,"#2563eb");e.add(a),x.forEach((t,o)=>{const c=s(3900150,-200,80-o*60,"x",t);e.add(c);const u=n(t.toString(),-200,80-o*60,20,"#000");e.add(u)})}if(l>=2){const a=n("W (Weights)",-80,140,18,"#16a34a");e.add(a),g.forEach((t,o)=>{const c=s(2278750,-80,80-o*60,"w",t);e.add(c);const u=n(t.toString(),-80,80-o*60,20,"#000");e.add(u)})}if(l>=3){const a=n("b (Bias)",40,140,18,"#ca8a04");e.add(a);const t=s(15381256,40,20,"b",h);e.add(t);const o=n(h.toString(),40,20,20,"#000");e.add(o)}if(l>=4){const a=n("X · W",160,140,18,"#7c3aed");e.add(a);const t=n(`${x[0]}×${g[0]} + ${x[1]}×${g[1]} + ${x[2]}×${g[2]}`,160,80,12,"#666");e.add(t);const o=n(`= ${w}`,160,40,20,"#7c3aed");e.add(o)}if(l>=5){const a=n("z = X·W + b",160,-20,16,"#dc2626");e.add(a);const t=n(`= ${w} + (${h})`,160,-60,14,"#666");e.add(t);const o=s(15680580,160,-110,"z",d);e.add(o);const c=n(d.toString(),160,-110,20,"#000");e.add(c)}if(l>=6){const a=n("Leaky ReLU(z)",300,100,18,"#ea580c");e.add(a);const t=n(`α = ${W}`,300,60,14,"#666");e.add(t);const o=n(d>0?"z > 0 → z":"z ≤ 0 → α × z",300,20,14,"#666");e.add(o);const c=n(d>0?`= ${d}`:`= ${W} × ${d}`,300,-20,14,"#666");e.add(c);const u=s(16347926,300,-80,"leaky_relu",p);e.add(u);const r=n(p.toFixed(2),300,-80,20,"#000");e.add(r)}},[l,x,g,h,w,d,p]);const N=()=>{if(j)return;z(!0),R(0);const e=Y.timeline({onComplete:()=>z(!1)});for(let s=1;s<=6;s++)e.call(()=>R(s),null,s*1.2)},C=()=>{R(0),z(!1)},k=["Ready","Input Vector X","Weight Vector W","Bias b","Dot Product X · W","Linear Combination z","Apply Leaky ReLU"];return i.jsxs("div",{className:"p-4",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-3 text-center",children:"Animation Demo"}),i.jsx("div",{ref:f,className:"w-full rounded-lg overflow-hidden border border-gray-200"}),i.jsxs("div",{className:"mt-4 flex justify-center gap-4",children:[i.jsx("button",{onClick:N,disabled:j,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:j?"Playing...":"Play"}),i.jsx("button",{onClick:C,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-medium",children:"Reset"})]}),i.jsxs("div",{className:"mt-4 text-center",children:[i.jsxs("p",{className:"text-lg font-semibold text-gray-700",children:["Step ",l,": ",k[l]]}),i.jsx("div",{className:"mt-2 flex justify-center gap-1",children:k.map((e,s)=>i.jsx("div",{className:`w-3 h-3 rounded-full ${s<=l?"bg-blue-600":"bg-gray-300"}`},s))})]}),i.jsxs("div",{className:"mt-4 p-3 bg-orange-50 rounded-lg border border-orange-200",children:[i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Leaky ReLU Formula:"})," f(x) = x if x > 0, else α × x"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Where α is a small constant (typically 0.01). Unlike ReLU, Leaky ReLU allows a small gradient when the input is negative."})]})]})}export{ne as default};
