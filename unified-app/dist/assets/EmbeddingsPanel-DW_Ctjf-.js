import{r as m,j as e,m as u,e as j}from"./index-quAWpIA7.js";import{P as f}from"./pause-Ch50eX2B.js";import{P as N}from"./play-DgR7o5cW.js";import{P as g}from"./plus-C2RRVVSj.js";import{I as y}from"./info-CH9TLaYi.js";function S(){const[a,p]=m.useState(0),[r,c]=m.useState(!1),[d,h]=m.useState(!1),i=["[CLS]","The","cat","sat","[SEP]"],o=[{title:"Token Embeddings",description:"Each token is mapped to a 768-dimensional vector from a learned vocabulary embedding table."},{title:"Segment Embeddings",description:"Indicates which sentence each token belongs to (Sentence A or B). Used for tasks with sentence pairs."},{title:"Position Embeddings",description:"Encodes the position of each token in the sequence (0, 1, 2, ...). BERT learns these, unlike sinusoidal encodings."},{title:"Sum All Three",description:"All three embeddings are element-wise added together to form the final input embedding."}];m.useEffect(()=>{if(r){const t=setInterval(()=>{p(s=>s>=o.length-1?(c(!1),s):s+1)},2500);return()=>clearInterval(t)}},[r]);const b=()=>{p(0),c(!1)},x=t=>{const s=[];for(let n=0;n<8;n++)s.push((Math.sin(t*(n+1))+1)/2);return s};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Input Embeddings: ",e.jsx("span",{className:"text-yellow-400",children:"Three Components Combined"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"BERT's input is the sum of token, segment, and position embeddings"})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs("button",{onClick:()=>c(!r),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg transition-colors",children:[r?e.jsx(f,{size:18}):e.jsx(N,{size:18}),r?"Pause":"Play Animation"]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(u,{size:18}),"Reset"]}),e.jsxs("button",{onClick:()=>h(!d),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${d?"bg-purple-600":"bg-white/10 hover:bg-white/20"}`,children:[e.jsx(j,{size:18}),d?"Hide":"Show"," Dimensions"]})]}),e.jsx("div",{className:"flex justify-center gap-2",children:o.map((t,s)=>e.jsx("button",{onClick:()=>{p(s),c(!1)},className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-all ${s===a?"bg-yellow-500 text-black scale-110":s<a?"bg-yellow-900 text-yellow-300":"bg-white/10 text-gray-700 dark:text-gray-500"}`,children:s+1},s))}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-bold text-yellow-400",children:["Step ",a+1,": ",o[a].title]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:o[a].description})]}),e.jsx("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10 overflow-x-auto",children:e.jsxs("div",{className:"min-w-[700px]",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-24 text-right text-sm text-gray-800 dark:text-gray-400",children:"Tokens:"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded font-mono text-sm ${t.startsWith("[")?"bg-red-600/30 text-red-300":"bg-blue-600/30 text-blue-300"}`,children:t})},s))})]}),e.jsxs("div",{className:`flex items-center gap-4 mb-4 transition-all duration-500 ${a>=0?"opacity-100":"opacity-30"}`,children:[e.jsx("div",{className:"w-24 text-right text-sm text-blue-600 dark:text-blue-400",children:"Token Emb:"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24",children:e.jsxs("div",{className:"bg-blue-900/30 border border-blue-500/30 rounded-lg p-2 h-16 flex flex-col justify-center",children:[e.jsx("div",{className:"flex gap-0.5 justify-center",children:x(s+1).slice(0,6).map((n,l)=>e.jsx("div",{className:"w-2 h-6 rounded-sm bg-blue-500",style:{opacity:.3+n*.7}},l))}),d&&e.jsx("p",{className:"text-xs text-center text-gray-700 dark:text-gray-500 mt-1",children:"768-d"})]})},s))}),e.jsxs("div",{className:"text-xs text-gray-700 dark:text-gray-500",children:["E",e.jsx("sub",{children:"token"})]})]}),a>=1&&e.jsxs("div",{className:"flex items-center gap-4 my-2",children:[e.jsx("div",{className:"w-24"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24 text-center",children:e.jsx(g,{size:16,className:"mx-auto text-gray-700 dark:text-gray-500"})},s))})]}),e.jsxs("div",{className:`flex items-center gap-4 mb-4 transition-all duration-500 ${a>=1?"opacity-100":"opacity-30"}`,children:[e.jsx("div",{className:"w-24 text-right text-sm text-green-400",children:"Segment Emb:"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24",children:e.jsxs("div",{className:"bg-green-900/30 border border-green-500/30 rounded-lg p-2 h-16 flex flex-col justify-center",children:[e.jsx("div",{className:"flex gap-0.5 justify-center",children:x(100).slice(0,6).map((n,l)=>e.jsx("div",{className:"w-2 h-6 rounded-sm bg-green-500",style:{opacity:.3+n*.7}},l))}),e.jsxs("p",{className:"text-xs text-center text-green-400 mt-1",children:["E",e.jsx("sub",{children:"A"})]})]})},s))}),e.jsxs("div",{className:"text-xs text-gray-700 dark:text-gray-500",children:["E",e.jsx("sub",{children:"segment"})]})]}),a>=2&&e.jsxs("div",{className:"flex items-center gap-4 my-2",children:[e.jsx("div",{className:"w-24"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24 text-center",children:e.jsx(g,{size:16,className:"mx-auto text-gray-700 dark:text-gray-500"})},s))})]}),e.jsxs("div",{className:`flex items-center gap-4 mb-4 transition-all duration-500 ${a>=2?"opacity-100":"opacity-30"}`,children:[e.jsx("div",{className:"w-24 text-right text-sm text-purple-600 dark:text-purple-400",children:"Position Emb:"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24",children:e.jsxs("div",{className:"bg-purple-900/30 border border-purple-500/30 rounded-lg p-2 h-16 flex flex-col justify-center",children:[e.jsx("div",{className:"flex gap-0.5 justify-center",children:x(200+s*10).slice(0,6).map((n,l)=>e.jsx("div",{className:"w-2 h-6 rounded-sm bg-purple-500",style:{opacity:.3+n*.7}},l))}),e.jsxs("p",{className:"text-xs text-center text-purple-600 dark:text-purple-400 mt-1",children:["pos=",s]})]})},s))}),e.jsxs("div",{className:"text-xs text-gray-700 dark:text-gray-500",children:["E",e.jsx("sub",{children:"position"})]})]}),a>=3&&e.jsxs("div",{className:"flex items-center gap-4 my-4",children:[e.jsx("div",{className:"w-24"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24 text-center",children:e.jsx("div",{className:"border-t-2 border-white/30 mx-4"})},s))})]}),e.jsxs("div",{className:`flex items-center gap-4 transition-all duration-500 ${a>=3?"opacity-100":"opacity-30"}`,children:[e.jsx("div",{className:"w-24 text-right text-sm text-orange-600 dark:text-orange-400 font-bold",children:"Input Emb:"}),e.jsx("div",{className:"flex gap-4",children:i.map((t,s)=>e.jsx("div",{className:"w-24",children:e.jsxs("div",{className:"bg-orange-900/30 border-2 border-orange-500/50 rounded-lg p-2 h-16 flex flex-col justify-center",children:[e.jsx("div",{className:"flex gap-0.5 justify-center",children:x(300+s*5).slice(0,6).map((n,l)=>e.jsx("div",{className:"w-2 h-6 rounded-sm bg-orange-500",style:{opacity:.5+n*.5}},l))}),d&&e.jsx("p",{className:"text-xs text-center text-gray-700 dark:text-gray-500 mt-1",children:"768-d"})]})},s))}),e.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400 font-bold",children:"â†’ to Encoder"})]})]})}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-4 border border-white/10 text-center",children:[e.jsxs("p",{className:"font-mono text-lg",children:[e.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:["E",e.jsx("sub",{children:"input"})]})," =",e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:[" E",e.jsx("sub",{children:"token"})]})," +",e.jsxs("span",{className:"text-green-400",children:[" E",e.jsx("sub",{children:"segment"})]})," +",e.jsxs("span",{className:"text-purple-600 dark:text-purple-400",children:[" E",e.jsx("sub",{children:"position"})]})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-500 mt-2",children:"All embeddings are 768-dimensional vectors (for BERT-Base)"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-4 border border-blue-500/30",children:[e.jsx("h4",{className:"font-bold text-blue-600 dark:text-blue-400 mb-2",children:"ðŸ”¤ Token Embeddings"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsx("li",{children:"â€¢ Lookup table: vocab_size Ã— 768"}),e.jsx("li",{children:"â€¢ ~30,522 tokens in BERT vocab"}),e.jsx("li",{children:"â€¢ Each token has unique embedding"}),e.jsx("li",{children:"â€¢ Learned during pre-training"})]})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-xl p-4 border border-green-500/30",children:[e.jsx("h4",{className:"font-bold text-green-400 mb-2",children:"ðŸ“‘ Segment Embeddings"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{children:["â€¢ Only 2 vectors: E",e.jsx("sub",{children:"A"})," and E",e.jsx("sub",{children:"B"})]}),e.jsxs("li",{children:["â€¢ E",e.jsx("sub",{children:"A"})," for first sentence"]}),e.jsxs("li",{children:["â€¢ E",e.jsx("sub",{children:"B"})," for second sentence"]}),e.jsx("li",{children:"â€¢ Used in NSP, QA, NLI tasks"})]})]}),e.jsxs("div",{className:"bg-purple-900/20 rounded-xl p-4 border border-purple-500/30",children:[e.jsx("h4",{className:"font-bold text-purple-600 dark:text-purple-400 mb-2",children:"ðŸ“ Position Embeddings"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsx("li",{children:"â€¢ Learned (not sinusoidal)"}),e.jsx("li",{children:"â€¢ Max 512 positions"}),e.jsx("li",{children:"â€¢ Encodes word order"}),e.jsx("li",{children:"â€¢ Position 0 is [CLS]"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(y,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Sentence Pair Example (for NSP, QA, etc.)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"flex gap-2 min-w-max items-end",children:["[CLS]","The","cat","sat","[SEP]","It","was","happy","[SEP]"].map((t,s)=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-mono ${t.startsWith("[")?"bg-red-600/30 text-red-300":s<=4?"bg-blue-600/30 text-blue-300":"bg-green-600/30 text-green-300"}`,children:t}),e.jsx("span",{className:`text-xs ${s<=4?"text-blue-400":"text-green-400"}`,children:s<=4?"Seg A":"Seg B"}),e.jsxs("span",{className:"text-xs text-purple-600 dark:text-purple-400",children:["pos ",s]})]},s))})})]}),e.jsxs("div",{className:"bg-black/40 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400 mb-3",children:"ðŸ PyTorch Implementation:"}),e.jsx("pre",{className:"text-sm overflow-x-auto",children:e.jsx("code",{className:"text-yellow-300",children:`class BertEmbeddings(nn.Module):
    def __init__(self, config):
        super().__init__()
        # Token embeddings: vocab_size Ã— hidden_size
        self.word_embeddings = nn.Embedding(config.vocab_size, config.hidden_size)
        # Position embeddings: max_position Ã— hidden_size
        self.position_embeddings = nn.Embedding(config.max_position, config.hidden_size)
        # Segment embeddings: 2 Ã— hidden_size (Sentence A or B)
        self.token_type_embeddings = nn.Embedding(2, config.hidden_size)
        # Layer normalization and dropout
        self.LayerNorm = nn.LayerNorm(config.hidden_size)
        self.dropout = nn.Dropout(config.dropout)
    
    def forward(self, input_ids, token_type_ids, position_ids):
        # Get all three embeddings
        word_embeds = self.word_embeddings(input_ids)        # [B, L, 768]
        position_embeds = self.position_embeddings(position_ids)  # [B, L, 768]
        segment_embeds = self.token_type_embeddings(token_type_ids)  # [B, L, 768]
        
        # Sum them up
        embeddings = word_embeds + position_embeds + segment_embeds
        
        # LayerNorm + Dropout
        embeddings = self.LayerNorm(embeddings)
        embeddings = self.dropout(embeddings)
        return embeddings  # [B, L, 768]`})})]})]})}export{S as default};
