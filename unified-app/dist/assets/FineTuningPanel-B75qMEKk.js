import{r as o,j as e,e as g,w as c,g as u}from"./index-CsxpOLHd.js";import{P as b}from"./pause-BMcOX1vk.js";import{P as j}from"./play-CIyTSByC.js";import{R as N}from"./rotate-ccw-xVnQluc9.js";function k(){const[s,d]=o.useState(0),[n,l]=o.useState(!1),[x,p]=o.useState("classification"),i=[{title:"Load Pre-trained BERT",description:"Start with BERT weights trained on MLM + NSP (110M parameters for Base)."},{title:"Add Task-Specific Head",description:"Add a small neural network on top for your specific task (e.g., classifier)."},{title:"Prepare Task Data",description:"Format your labeled dataset: add [CLS], [SEP] tokens, segment IDs."},{title:"Fine-tune All Layers",description:"Train the entire model end-to-end on your task with a small learning rate."},{title:"Evaluate & Deploy",description:"Test on held-out data. Fine-tuning takes minutes to hours, not days!"}],m={classification:{name:"Sequence Classification",description:"Classify entire text (sentiment, topic, intent)",inputFormat:"[CLS] This movie was amazing! [SEP]",outputFormat:"Single label from [CLS]",examples:["Sentiment Analysis","Spam Detection","Topic Classification"],head:"Linear(768, num_classes)",color:"blue"},ner:{name:"Token Classification (NER)",description:"Label each token (named entities, POS tags)",inputFormat:"[CLS] John works at Google [SEP]",outputFormat:"Label per token",examples:["Named Entity Recognition","POS Tagging","Chunking"],head:"Linear(768, num_tags) per token",color:"green"},qa:{name:"Question Answering",description:"Find answer span in context passage",inputFormat:"[CLS] Question [SEP] Context passage [SEP]",outputFormat:"Start & end positions",examples:["SQuAD","Reading Comprehension","Extractive QA"],head:"Linear(768, 2) for start/end",color:"purple"},nli:{name:"Sentence Pair Classification",description:"Classify relationship between two sentences",inputFormat:"[CLS] Sentence A [SEP] Sentence B [SEP]",outputFormat:"Entailment/Contradiction/Neutral",examples:["Natural Language Inference","Paraphrase Detection","Semantic Similarity"],head:"Linear(768, 3) from [CLS]",color:"orange"}},a=m[x];o.useEffect(()=>{if(n){const r=setInterval(()=>{d(t=>t>=i.length-1?(l(!1),t):t+1)},2500);return()=>clearInterval(r)}},[n]);const h=()=>{d(0),l(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"text-yellow-400",children:"Fine-Tuning"})," BERT for Downstream Tasks"]}),e.jsx("p",{className:"text-gray-400",children:"Transfer learning: adapt pre-trained BERT to specific tasks with minimal training"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsxs("button",{onClick:()=>l(!n),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg transition-colors",children:[n?e.jsx(b,{size:18}):e.jsx(j,{size:18}),n?"Pause":"Play Animation"]}),e.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(N,{size:18}),"Reset"]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:i.map((r,t)=>e.jsxs("button",{onClick:()=>{d(t),l(!1)},className:`px-3 py-1 rounded-full text-sm transition-all ${t===s?"bg-yellow-500 text-black":t<s?"bg-yellow-900 text-yellow-300":"bg-white/10 text-gray-500"}`,children:[t+1,". ",r.title]},t))}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-bold text-yellow-400",children:["Step ",s+1,": ",i[s].title]}),e.jsx("p",{className:"text-gray-300 mt-1",children:i[s].description})]}),e.jsx("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10 overflow-x-auto",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 min-w-max",children:[e.jsx("div",{className:`text-center transition-all duration-500 ${s>=0?"opacity-100 scale-100":"opacity-30 scale-90"}`,children:e.jsxs("div",{className:"bg-blue-900/30 border-2 border-blue-500 rounded-xl p-4 w-48",children:[e.jsx(g,{className:"mx-auto mb-2 text-blue-400",size:32}),e.jsx("p",{className:"font-bold text-blue-300",children:"Pre-trained BERT"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"12 Encoder Layers"}),e.jsx("p",{className:"text-xs text-gray-400",children:"110M Parameters"})]})}),e.jsx(c,{className:`text-gray-500 transition-all duration-500 ${s>=1?"opacity-100":"opacity-30"}`}),e.jsx("div",{className:`text-center transition-all duration-500 ${s>=1?"opacity-100 scale-100":"opacity-30 scale-90"}`,children:e.jsxs("div",{className:`bg-${a.color}-900/30 border-2 border-${a.color}-500 rounded-xl p-4 w-48`,children:[e.jsx(u,{className:`mx-auto mb-2 text-${a.color}-400`,size:32}),e.jsx("p",{className:`font-bold text-${a.color}-300`,children:"+ Task Head"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.head}),e.jsx("p",{className:"text-xs text-gray-400",children:"~Few K params"})]})}),e.jsx(c,{className:`text-gray-500 transition-all duration-500 ${s>=2?"opacity-100":"opacity-30"}`}),e.jsx("div",{className:`text-center transition-all duration-500 ${s>=2?"opacity-100 scale-100":"opacity-30 scale-90"}`,children:e.jsxs("div",{className:"bg-green-900/30 border-2 border-green-500 rounded-xl p-4 w-48",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üìä"}),e.jsx("p",{className:"font-bold text-green-300",children:"Task Dataset"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Labeled examples"}),e.jsx("p",{className:"text-xs text-gray-400",children:"~1K - 100K samples"})]})}),e.jsx(c,{className:`text-gray-500 transition-all duration-500 ${s>=3?"opacity-100":"opacity-30"}`}),e.jsx("div",{className:`text-center transition-all duration-500 ${s>=3?"opacity-100 scale-100":"opacity-30 scale-90"}`,children:e.jsxs("div",{className:"bg-yellow-900/30 border-2 border-yellow-500 rounded-xl p-4 w-48",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üéØ"}),e.jsx("p",{className:"font-bold text-yellow-300",children:"Fine-tuned Model"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Task-specific"}),e.jsx("p",{className:"text-xs text-gray-400",children:"2-4 epochs"})]})}),e.jsx(c,{className:`text-gray-500 transition-all duration-500 ${s>=4?"opacity-100":"opacity-30"}`}),e.jsx("div",{className:`text-center transition-all duration-500 ${s>=4?"opacity-100 scale-100":"opacity-30 scale-90"}`,children:e.jsxs("div",{className:"bg-purple-900/30 border-2 border-purple-500 rounded-xl p-4 w-48",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üöÄ"}),e.jsx("p",{className:"font-bold text-purple-300",children:"Production"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Ready for inference"}),e.jsx("p",{className:"text-xs text-gray-400",children:"State-of-the-art!"})]})})]})}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-center",children:"Select a Downstream Task"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:Object.entries(m).map(([r,t])=>e.jsx("button",{onClick:()=>p(r),className:`p-3 rounded-xl border-2 transition-all ${x===r?`bg-${t.color}-900/30 border-${t.color}-500 scale-105`:"bg-white/5 border-white/10 hover:border-white/30"}`,children:e.jsx("p",{className:`font-bold text-sm ${x===r?`text-${t.color}-400`:"text-gray-300"}`,children:t.name})},r))}),e.jsxs("div",{className:`bg-${a.color}-900/20 rounded-xl p-4 border border-${a.color}-500/30`,children:[e.jsx("h4",{className:`font-bold text-${a.color}-400 mb-3`,children:a.name}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:a.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Input Format:"}),e.jsx("code",{className:"text-xs bg-black/30 px-2 py-1 rounded text-green-300 block",children:a.inputFormat})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Output:"}),e.jsx("code",{className:"text-xs bg-black/30 px-2 py-1 rounded text-orange-300 block",children:a.outputFormat})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Example Tasks:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.examples.map((r,t)=>e.jsx("span",{className:"text-xs bg-white/10 px-2 py-1 rounded",children:r},t))})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-900/20 rounded-xl p-4 border border-green-500/30",children:[e.jsx("h4",{className:"font-bold text-green-400 mb-3",children:"‚úÖ Best Practices"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Learning rate:"})," 2e-5 to 5e-5 (small!)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Batch size:"})," 16 or 32"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Epochs:"})," 2-4 (avoid overfitting)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Warmup:"})," 10% of training steps"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Max length:"})," Task-dependent (128-512)"]})]})]}),e.jsxs("div",{className:"bg-red-900/20 rounded-xl p-4 border border-red-500/30",children:[e.jsx("h4",{className:"font-bold text-red-400 mb-3",children:"‚ö†Ô∏è Common Mistakes"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[e.jsx("li",{children:"‚Ä¢ Learning rate too high ‚Üí catastrophic forgetting"}),e.jsx("li",{children:"‚Ä¢ Too many epochs ‚Üí overfitting"}),e.jsx("li",{children:"‚Ä¢ Wrong tokenizer ‚Üí vocabulary mismatch"}),e.jsx("li",{children:"‚Ä¢ No [CLS]/[SEP] tokens ‚Üí poor performance"}),e.jsx("li",{children:"‚Ä¢ Sequence too long ‚Üí truncation issues"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-900/20 to-yellow-900/20 rounded-xl p-4 border border-white/20",children:[e.jsx("h4",{className:"font-bold text-white mb-3",children:"üîÑ What Gets Updated During Fine-Tuning?"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-black/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-400 font-medium mb-1",children:"BERT Weights (All)"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"All 110M parameters get updated with small gradients"})]}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-yellow-400 font-medium mb-1",children:"Task Head (New)"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"New layers trained from scratch"})]}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-400 font-medium mb-1",children:"Option: Freeze BERT"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Only train head (faster, less accurate)"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-4 border border-white/10",children:[e.jsx("h4",{className:"font-bold text-yellow-400 mb-3",children:"üìà BERT Performance on GLUE Benchmark"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"text-left py-2 text-gray-400",children:"Task"}),e.jsx("th",{className:"text-center py-2 text-gray-400",children:"Dataset"}),e.jsx("th",{className:"text-center py-2 text-gray-400",children:"BERT-Base"}),e.jsx("th",{className:"text-center py-2 text-gray-400",children:"BERT-Large"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("td",{className:"py-2",children:"Sentiment"}),e.jsx("td",{className:"text-center text-gray-400",children:"SST-2"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"93.5%"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"94.9%"})]}),e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("td",{className:"py-2",children:"NLI"}),e.jsx("td",{className:"text-center text-gray-400",children:"MNLI"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"84.6%"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"86.7%"})]}),e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("td",{className:"py-2",children:"Paraphrase"}),e.jsx("td",{className:"text-center text-gray-400",children:"QQP"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"71.2%"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"72.1%"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Question NLI"}),e.jsx("td",{className:"text-center text-gray-400",children:"QNLI"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"90.5%"}),e.jsx("td",{className:"text-center font-mono text-green-400",children:"92.7%"})]})]})]})})]}),e.jsxs("div",{className:"bg-black/40 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"üêç PyTorch Fine-Tuning Example (Classification):"}),e.jsx("pre",{className:"text-sm overflow-x-auto",children:e.jsx("code",{className:"text-orange-300",children:`from transformers import BertForSequenceClassification, BertTokenizer, AdamW

# Load pre-trained BERT with classification head
model = BertForSequenceClassification.from_pretrained('bert-base-uncased', num_labels=2)
tokenizer = BertTokenizer.from_pretrained('bert-base-uncased')

# Prepare data
texts = ["I love this movie!", "This was terrible."]
labels = [1, 0]  # Positive, Negative

# Tokenize
inputs = tokenizer(texts, padding=True, truncation=True, return_tensors='pt')
inputs['labels'] = torch.tensor(labels)

# Fine-tuning setup
optimizer = AdamW(model.parameters(), lr=2e-5)

# Training loop
model.train()
for epoch in range(3):
    optimizer.zero_grad()
    outputs = model(**inputs)
    loss = outputs.loss
    loss.backward()
    optimizer.step()
    print(f"Epoch {epoch+1}, Loss: {loss.item():.4f}")

# Inference
model.eval()
with torch.no_grad():
    test_input = tokenizer("Great performance!", return_tensors='pt')
    output = model(**test_input)
    prediction = torch.argmax(output.logits, dim=1)
    print(f"Prediction: {'Positive' if prediction == 1 else 'Negative'}")`})})]})]})}export{k as default};
