import{r,j as e,m as k,Z as w}from"./index-quAWpIA7.js";import{P as C}from"./pause-Ch50eX2B.js";import{P}from"./play-DgR7o5cW.js";import{m as g}from"./proxy-D7LjGbFl.js";import{A as S}from"./index-5ncPk15p.js";function H(){const[n,i]=r.useState(!1),[a,d]=r.useState(0),[t,b]=r.useState(16),[c,p]=r.useState(8),[o,j]=r.useState(64),[m,f]=r.useState(12),N=Array.from({length:a},(s,l)=>`T${l}`);r.useEffect(()=>{if(n&&a<t){const s=setTimeout(()=>{d(l=>l+1)},300);return()=>clearTimeout(s)}else a>=t&&i(!1)},[n,a,t]);const v=()=>{d(0),i(!1)},x=s=>2*s*c*o*m*4/(1024*1024),h=x(a),u=x(t),y=h/u*100||0;return e.jsx("div",{className:"p-8 h-full overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-emerald-600 dark:text-emerald-400 mb-4",children:"KV Cache Memory Simulator"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Watch the KV Cache grow as tokens are generated. Adjust model parameters to see memory impact."})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-200 mb-4",children:"Model Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Sequence Length"}),e.jsx("span",{className:"font-mono text-emerald-600",children:t})]}),e.jsx("input",{type:"range",min:"8",max:"64",step:"8",value:t,onChange:s=>{b(parseInt(s.target.value)),d(0)},className:"w-full accent-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Number of Heads"}),e.jsx("span",{className:"font-mono text-emerald-600",children:c})]}),e.jsx("input",{type:"range",min:"4",max:"32",step:"4",value:c,onChange:s=>p(parseInt(s.target.value)),className:"w-full accent-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Head Dimension"}),e.jsx("span",{className:"font-mono text-emerald-600",children:o})]}),e.jsx("input",{type:"range",min:"32",max:"128",step:"32",value:o,onChange:s=>j(parseInt(s.target.value)),className:"w-full accent-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Number of Layers"}),e.jsx("span",{className:"font-mono text-emerald-600",children:m})]}),e.jsx("input",{type:"range",min:"6",max:"48",step:"6",value:m,onChange:s=>f(parseInt(s.target.value)),className:"w-full accent-emerald-500"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:v,className:"p-3 rounded-full bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",children:e.jsx(k,{size:20})}),e.jsx("button",{onClick:()=>i(!n),disabled:a>=t,className:"p-4 rounded-full bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-50 transition-colors shadow-lg",children:n?e.jsx(C,{size:24}):e.jsx(P,{size:24})}),e.jsx("button",{onClick:()=>d(s=>Math.min(s+1,t)),disabled:a>=t,className:"px-4 py-2 rounded-lg bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 disabled:opacity-50 font-medium",children:"Step +1"})]}),e.jsxs("div",{className:"text-center mt-4 text-slate-500 text-sm",children:["Token ",a," / ",t]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsxs("h3",{className:"font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx(w,{className:"text-yellow-500"}),"Memory Usage"]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx(g.div,{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-500",initial:{width:0},animate:{width:`${y}%`},transition:{type:"spring",stiffness:100}})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:[h.toFixed(2)," MB"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Current Usage"})]}),e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-slate-600 dark:text-slate-300",children:[u.toFixed(2)," MB"]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Max at ",t," tokens"]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-200 mb-4",children:"Generated Tokens in Cache"}),e.jsxs("div",{className:"flex flex-wrap gap-2 min-h-[100px]",children:[e.jsx(S,{children:N.map((s,l)=>e.jsx(g.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:"w-10 h-10 rounded-lg bg-gradient-to-br from-emerald-400 to-teal-500 text-white flex items-center justify-center text-xs font-mono shadow-sm",children:l},l))}),a===0&&e.jsx("div",{className:"text-slate-400 text-sm italic",children:"Press Play to start generating..."})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-fuchsia-500 rounded-2xl p-6 text-white",children:[e.jsx("h4",{className:"font-bold mb-2",children:"Why does this matter?"}),e.jsxs("p",{className:"text-purple-100 text-sm",children:["As sequences get longer, the KV Cache becomes the main memory bottleneck.",e.jsx("strong",{children:" Grouped-Query Attention (GQA)"})," reduces this by sharing KV heads across multiple query heads, cutting memory usage while preserving quality!"]})]})]})]})]})})}export{H as default};
