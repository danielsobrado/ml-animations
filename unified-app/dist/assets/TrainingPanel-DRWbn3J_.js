import{r as o,j as e}from"./index-quAWpIA7.js";import{R as G}from"./CategoricalChart-q5_a8qWL.js";import{L as K,a as V}from"./LineChart-CoWhyZmT.js";import{C as W,X,Y}from"./CartesianChart-CAXOaB3h.js";import{T as D}from"./Tooltip-YDxRvdtC.js";import"./with-selector-CsIvExq7.js";import"./ActivePoints-Bh5iuYIL.js";import"./ErrorBarContext-Cye6_j5d.js";import"./getRadiusAndStrokeWidthFromDot-1Us6Ea5J.js";import"./ActiveShapeUtils-CPNwDibL.js";import"./Sector-C4hPwxCr.js";import"./Symbols-D2UkYTzA.js";import"./useElementOffset-e28GaSXW.js";function ne(){var C,M;const v=[[0,0,0,0],[0,1,0,1],[0,0,0,0],[1,0,1,2]],[N,w]=o.useState({r:0,c:0}),[p,k]=o.useState({}),[g,y]=o.useState(0),[x,S]=o.useState([]),[m,$]=o.useState(!1),[u,Q]=o.useState(50),L=.5,A=.9,E=.1,b=o.useRef(null),f=(d,a)=>{const t=`${d},${a}`;return p[t]?p[t]:{up:0,down:0,left:0,right:0}},I=()=>{w(d=>{const{r:a,c:t}=d,r=f(a,t);let s;Math.random()<E?s=["up","down","left","right"][Math.floor(Math.random()*4)]:s=Object.keys(r).reduce((n,T)=>r[n]>r[T]?n:T);let i=a,l=t;s==="up"&&(i=Math.max(0,a-1)),s==="down"&&(i=Math.min(3,a+1)),s==="left"&&(l=Math.max(0,t-1)),s==="right"&&(l=Math.min(3,t+1));const h=v[i][l];let c=-1,j=!1;h===1&&(c=-10,j=!0),h===2&&(c=10,j=!0);const P=f(i,l),q=Math.max(...Object.values(P)),R=r[s],z=R+L*(c+A*q-R);return k(n=>({...n,[`${a},${t}`]:{...r,[s]:z}})),j?(y(n=>n+1),S(n=>[...n.slice(-49),{episode:g+1,reward:c}]),{r:0,c:0}):{r:i,c:l}})};o.useEffect(()=>(m?b.current=setInterval(I,u):clearInterval(b.current),()=>clearInterval(b.current)),[m,u,p,g]);const O=()=>{k({}),y(0),S([]),w({r:0,c:0}),$(!1)};return e.jsxs("div",{className:"p-8 h-full flex flex-col items-center overflow-y-auto",children:[e.jsxs("div",{className:"max-w-3xl w-full text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mb-4",children:"Training Loop"}),e.jsx("p",{className:"text-lg text-slate-700 dark:text-slate-300 leading-relaxed",children:"Watch the agent explore and learn from its mistakes in real-time."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-12 w-full max-w-6xl items-start",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"grid grid-cols-4 gap-2 bg-slate-800 p-4 rounded-xl border border-slate-700",children:v.map((d,a)=>d.map((t,r)=>{const s=f(a,r),i=Math.max(...Object.values(s)),l=Object.keys(s).reduce((h,c)=>s[h]>s[c]?h:c);return e.jsxs("div",{className:`w-16 h-16 rounded flex items-center justify-center relative ${t===1?"bg-slate-950":t===2?"bg-yellow-900/50 border border-yellow-500":"bg-slate-700"}`,style:{backgroundColor:t===0?`rgba(34, 197, 94, ${Math.max(0,i/10)})`:void 0},children:[t===1&&"ðŸ’€",t===2&&"ðŸ†",N.r===a&&N.c===r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-3xl z-10 animate-bounce",children:"ðŸ¤–"}),t===0&&i!==0&&e.jsx("div",{className:`absolute text-white/50 text-xs ${l==="up"?"rotate-0":l==="right"?"rotate-90":l==="down"?"rotate-180":"-rotate-90"}`,children:"â¬†ï¸"})]},`${a}-${r}`)}))}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx("button",{onClick:()=>$(!m),className:`px-6 py-3 rounded-xl font-bold text-white shadow-lg ${m?"bg-red-600":"bg-green-600"}`,children:m?"Pause":"Start Training"}),e.jsx("button",{onClick:O,className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold",children:"Reset"})]}),e.jsxs("div",{className:"mt-4 w-full max-w-xs",children:[e.jsxs("label",{className:"text-xs text-slate-800 dark:text-slate-400",children:["Speed: ",u,"ms"]}),e.jsx("input",{type:"range",min:"10",max:"500",step:"10",value:u,onChange:d=>Q(Number(d.target.value)),className:"w-full"})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Learning Progress"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-900 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-slate-700 dark:text-slate-500",children:"Episodes"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:g})]}),e.jsxs("div",{className:"bg-slate-900 p-3 rounded",children:[e.jsx("div",{className:"text-xs text-slate-700 dark:text-slate-500",children:"Last Reward"}),e.jsx("div",{className:`text-2xl font-bold ${((C=x[x.length-1])==null?void 0:C.reward)>0?"text-green-400":"text-red-400"}`,children:((M=x[x.length-1])==null?void 0:M.reward)||0})]})]}),e.jsx("div",{className:"h-48",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(K,{data:x,children:[e.jsx(W,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(X,{dataKey:"episode",stroke:"#64748b"}),e.jsx(Y,{stroke:"#64748b"}),e.jsx(D,{contentStyle:{backgroundColor:"#1e293b",border:"none"}}),e.jsx(V,{type:"monotone",dataKey:"reward",stroke:"#22c55e",strokeWidth:2,dot:!1})]})})})]}),e.jsx("div",{className:"bg-blue-900/20 border border-blue-500/50 p-4 rounded-xl",children:e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("strong",{children:"Observation:"})," Initially, the agent falls into holes often (Red spikes). As Q-values propagate from the goal, it learns the safe path, and rewards stabilize at +10 (Green line)."]})})]})]})]})}export{ne as default};
