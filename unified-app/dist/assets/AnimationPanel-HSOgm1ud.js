import{r as p,j as i}from"./index-CsxpOLHd.js";import{S as fe,C as we,O as ye,W as ve,G as Ce,P as Le,M as ze,a as Se,L as ke,E as Re,b as Ee,e as V,f as Y,g as q}from"./three.module-CNl0Zq82.js";import{g as n}from"./index-C8pce-KX.js";const H=[2,1,3],J=[1,-1,1],je=-5,Ne=-1,Pe=0,f={input:6003669,weights:7384391,bias:7352480,output:15564081,relu:16760832,bg:16777215},c=[{id:"show-inputs",title:"Input Vector X",desc:"The input vector X contains our input values: [2, 1, 3]"},{id:"show-weights",title:"Weight Vector W",desc:"The weight vector W contains learned parameters: [1, -1, 1]"},{id:"show-bias",title:"Bias b",desc:"The bias term b = -5"},{id:"dot-product",title:"Dot Product W·X",desc:"(1×2) + (-1×1) + (1×3) = 2 - 1 + 3 = 4"},{id:"add-bias",title:"Add Bias: z = W·X + b",desc:"z = 4 + (-5) = -1"},{id:"apply-relu",title:"Apply ReLU: φ(z)",desc:"ReLU(-1) = max(0, -1) = 0"}];function Xe({onStepChange:N}){const w=p.useRef(null),K=p.useRef(null),Q=p.useRef(null),P=p.useRef({}),[r,k]=p.useState(0),[u,M]=p.useState(!1),[Z,L]=p.useState("Click Play to see how ReLU activation works");p.useEffect(()=>{N&&N(r,Ne,Pe)},[r,N]),p.useEffect(()=>{if(!w.current)return;const t=w.current.clientWidth,e=400,s=new fe;s.background=new we(f.bg),Q.current=s;const o=new ye(t/-2,t/2,e/2,e/-2,.1,1e3);o.position.z=100;const m=new ve({antialias:!0});m.setSize(t,e),w.current.appendChild(m.domElement),K.current=m;const y=40,R=4,v=(l,g,W,T,C=!0)=>{const a=new Ce,j=new Le(y,y),X=new ze({color:T,transparent:!0,opacity:.8}),x=new Se(j,X);a.add(x);const he=new ke(new Re(j),new Ee({color:3355443,linewidth:2}));a.add(he);const z=document.createElement("canvas");z.width=128,z.height=128;const S=z.getContext("2d");S.fillStyle="black",S.font="bold 56px Arial",S.textAlign="center",S.textBaseline="middle",S.fillText(l.toString(),64,64);const D=new V(z),ge=new Y({map:D,transparent:!0}),I=new q(ge);return I.scale.set(32,32,1),a.add(I),a.position.set(g,W,0),a.visible=C,a.userData={value:l,mesh:x,canvas:z,texture:D},s.add(a),a},d=(l,g,W,T=36)=>{const C=document.createElement("canvas");C.width=512,C.height=128;const a=C.getContext("2d");a.fillStyle="black",a.font=`bold ${T*2}px Arial`,a.textAlign="center",a.textBaseline="middle",a.fillText(l,256,64);const j=new V(C),X=new Y({map:j}),x=new q(X);return x.scale.set(160,40,1),x.position.set(g,W,0),x.visible=!1,s.add(x),x},h=120,b=20,B=[],U=-180;for(let l=0;l<H.length;l++){const g=v(H[l],U,h-l*(y+R),f.input,!1);B.push(g)}const se=d("X",U,h+50),F=[],E=-80;for(let l=0;l<J.length;l++){const g=v(J[l],E+l*(y+R),h-22,f.weights,!1);F.push(g)}const le=d("W",E+44,h+50),ae=v(je,E+3*(y+R),h-22,f.bias,!1),ne=d("b",E+3*(y+R),h+50),oe=v("4",60,b,f.output,!1),ie=d("W·X",60,b+50),re=v("-1",140,b,f.output,!1),ce=d("z",140,b+50),de=v("0",220,b,f.relu,!1),ue=d("φ(z)",220,b+50),be=d("·",-20,h-22,48),pe=d("+",100,b,48),xe=d("→",180,b,36),me=d("ReLU",180,b-40,24);P.current={xCells:B,wCells:F,biasCell:ae,dotResultCell:oe,zCell:re,reluCell:de,xLabel:se,wLabel:le,biasLabel:ne,dotLabel:ie,zLabel:ce,reluLabel:ue,multLabel:be,plusLabel:pe,arrowLabel:xe,reluFuncLabel:me};let G;const O=()=>{G=requestAnimationFrame(O),m.render(s,o)};return O(),()=>{var l;cancelAnimationFrame(G),m.dispose(),(l=w.current)!=null&&l.contains(m.domElement)&&w.current.removeChild(m.domElement)}},[]);const A=t=>{const e=P.current;switch(t){case 1:e.xLabel.visible=!0,e.xCells.forEach((s,o)=>{s.visible=!0,s.scale.set(.01,.01,.01),n.to(s.scale,{x:1,y:1,z:1,duration:.4,delay:o*.15,ease:"back.out"})});break;case 2:e.wLabel.visible=!0,e.multLabel.visible=!0,e.wCells.forEach((s,o)=>{s.visible=!0,s.scale.set(.01,.01,.01),n.to(s.scale,{x:1,y:1,z:1,duration:.4,delay:o*.15,ease:"back.out"})});break;case 3:e.biasLabel.visible=!0,e.biasCell.visible=!0,e.biasCell.scale.set(.01,.01,.01),n.to(e.biasCell.scale,{x:1,y:1,z:1,duration:.4,ease:"back.out"});break;case 4:e.xCells.forEach((s,o)=>{n.to(s.scale,{x:1.2,y:1.2,duration:.3,delay:o*.1}),n.to(s.scale,{x:1,y:1,duration:.3,delay:.5+o*.1})}),e.wCells.forEach((s,o)=>{n.to(s.scale,{x:1.2,y:1.2,duration:.3,delay:o*.1}),n.to(s.scale,{x:1,y:1,duration:.3,delay:.5+o*.1})}),e.dotLabel.visible=!0,e.dotResultCell.visible=!0,e.dotResultCell.scale.set(.01,.01,.01),n.to(e.dotResultCell.scale,{x:1,y:1,z:1,duration:.5,delay:.8,ease:"back.out"});break;case 5:e.plusLabel.visible=!0,n.to(e.biasCell.scale,{x:1.2,y:1.2,duration:.3}),n.to(e.biasCell.scale,{x:1,y:1,duration:.3,delay:.4}),e.zLabel.visible=!0,e.zCell.visible=!0,e.zCell.scale.set(.01,.01,.01),n.to(e.zCell.scale,{x:1,y:1,z:1,duration:.5,delay:.6,ease:"back.out"});break;case 6:e.arrowLabel.visible=!0,e.reluFuncLabel.visible=!0,e.reluLabel.visible=!0,e.reluCell.visible=!0,e.reluCell.scale.set(.01,.01,.01),n.to(e.reluCell.scale,{x:1,y:1,z:1,duration:.5,delay:.3,ease:"back.out"}),n.to(e.zCell.userData.mesh.material,{opacity:.3,duration:.2,yoyo:!0,repeat:3});break}},_=async()=>{if(!u){M(!0);for(let t=r;t<c.length;t++)k(t+1),L(`${c[t].title}
${c[t].desc}`),A(t+1),await new Promise(e=>setTimeout(e,1800));L("Complete! ReLU outputs 0 for negative inputs, preserving positive values."),M(!1)}},ee=()=>{if(u||r>=c.length)return;const t=r+1;k(t),L(`${c[t-1].title}
${c[t-1].desc}`),A(t)},te=()=>{if(u||r<=0)return;$();const t=r-1;setTimeout(()=>{for(let e=1;e<=t;e++)A(e);k(t),t>0&&L(`${c[t-1].title}
${c[t-1].desc}`)},100)},$=()=>{if(u)return;const t=P.current;[...t.xCells,...t.wCells,t.biasCell,t.dotResultCell,t.zCell,t.reluCell].forEach(e=>{e&&(e.visible=!1,e.scale.set(1,1,1))}),[t.xLabel,t.wLabel,t.biasLabel,t.dotLabel,t.zLabel,t.reluLabel,t.multLabel,t.plusLabel,t.arrowLabel,t.reluFuncLabel].forEach(e=>{e&&(e.visible=!1)}),k(0),L("Click Play to see how ReLU activation works")};return i.jsxs("div",{className:"flex flex-col items-center p-3",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Animation Demo"}),i.jsx("div",{ref:w,className:"w-full rounded-lg overflow-hidden shadow-lg bg-white"}),i.jsx("div",{className:"mt-2 p-2 bg-white rounded-lg w-full text-center shadow",children:i.jsx("p",{className:"text-gray-800 whitespace-pre-line text-sm",children:Z})}),i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsx("button",{onClick:te,disabled:u||r<=0,className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:"← Prev"}),i.jsxs("div",{className:"px-3 py-1 bg-gray-200 rounded-lg font-mono text-gray-700 min-w-[80px] text-center text-sm",children:[r," / ",c.length]}),i.jsx("button",{onClick:ee,disabled:u||r>=c.length,className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:"Next →"})]}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx("button",{onClick:_,disabled:u||r>=c.length,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:u?"Playing...":"▶ Play"}),i.jsx("button",{onClick:$,disabled:u,className:"px-4 py-2 bg-red-500 hover:bg-red-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:"↺ Reset"})]})]})}export{Xe as default};
