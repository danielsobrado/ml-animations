import{r as n,j as e,m as f,z as c}from"./index-quAWpIA7.js";import{P as b}from"./pause-Ch50eX2B.js";import{P as j}from"./play-DgR7o5cW.js";function w(){const[t,d]=n.useState(0),[i,l]=n.useState(!1),g=n.useRef(null),s=[{title:"Input Image",description:"A 28×28 grayscale image (like MNIST digit) is flattened into a 784-dimensional vector.",highlight:"input"},{title:"First Hidden Layer",description:"Linear transformation + activation compresses 784 → 400 dimensions, learning important features.",highlight:"hidden1"},{title:"Second Hidden Layer",description:"Further compression to 200 dimensions, extracting higher-level abstractions.",highlight:"hidden2"},{title:"Mean (μ) Output",description:"A linear layer outputs the mean vector μ of the latent distribution. Each dimension is a center point.",highlight:"mu"},{title:"Log-Variance (log σ²) Output",description:"A separate linear layer outputs log σ² (log-variance for numerical stability). σ = exp(0.5 × log σ²).",highlight:"logvar"},{title:"Reparameterization",description:"Sample ε ~ N(0,1), then compute z = μ + σ ⊙ ε. This allows gradients to flow through sampling!",highlight:"reparam"}];n.useEffect(()=>(i&&(g.current=setInterval(()=>{d(a=>a>=s.length-1?(l(!1),a):a+1)},2500)),()=>clearInterval(g.current)),[i]);const m=()=>{d(0),l(!1)},o=({count:a,width:r,color:p,label:u,active:x,sublabel:h})=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`relative transition-all duration-500 ${x?"scale-110":"scale-100"}`,style:{width:`${r}px`},children:e.jsxs("div",{className:`h-32 rounded-lg ${p} ${x?"ring-2 ring-white ring-offset-2 ring-offset-transparent":""} flex flex-col items-center justify-center transition-all`,children:[e.jsx("p",{className:"text-2xl font-bold",children:a}),e.jsx("p",{className:"text-xs opacity-80",children:"neurons"})]})}),e.jsx("p",{className:`mt-2 text-sm font-medium transition-colors ${x?"text-white":"text-gray-400"}`,children:u}),h&&e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-500",children:h})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Encoder: ",e.jsx("span",{className:"text-green-400",children:"From Data to Distribution"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"The encoder learns to map input data to latent distribution parameters μ and σ"})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors",children:[i?e.jsx(b,{size:18}):e.jsx(j,{size:18}),i?"Pause":"Play Animation"]}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(f,{size:18}),"Reset"]})]}),e.jsx("div",{className:"flex justify-center gap-2",children:s.map((a,r)=>e.jsx("button",{onClick:()=>{d(r),l(!1)},className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-all ${r===t?"bg-green-500 text-white scale-110":r<t?"bg-green-900 text-green-300":"bg-white/10 text-gray-700 dark:text-gray-500"}`,children:r+1},r))}),e.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-bold text-green-400",children:["Step ",t+1,": ",s[t].title]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:s[t].description})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-8 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(o,{count:784,width:80,color:"bg-gradient-to-b from-blue-600 to-blue-800",label:"Input",sublabel:"28×28 = 784",active:s[t].highlight==="input"}),e.jsx(c,{className:"text-gray-800 dark:text-gray-600"}),e.jsx(o,{count:400,width:60,color:"bg-gradient-to-b from-green-600 to-green-800",label:"Hidden 1",sublabel:"ReLU",active:s[t].highlight==="hidden1"}),e.jsx(c,{className:"text-gray-800 dark:text-gray-600"}),e.jsx(o,{count:200,width:50,color:"bg-gradient-to-b from-green-600 to-green-800",label:"Hidden 2",sublabel:"ReLU",active:s[t].highlight==="hidden2"}),e.jsx(c,{className:"text-gray-800 dark:text-gray-600"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:`transition-all duration-500 ${s[t].highlight==="mu"?"scale-110":""}`,children:[e.jsxs("div",{className:`w-16 h-14 rounded-lg bg-gradient-to-br from-purple-500 to-purple-700 flex flex-col items-center justify-center ${s[t].highlight==="mu"?"ring-2 ring-white":""}`,children:[e.jsx("p",{className:"text-lg font-bold",children:"20"}),e.jsx("p",{className:"text-xs",children:"μ"})]}),e.jsx("p",{className:`text-center text-xs mt-1 ${s[t].highlight==="mu"?"text-purple-300":"text-gray-500"}`,children:"Mean"})]}),e.jsxs("div",{className:`transition-all duration-500 ${s[t].highlight==="logvar"?"scale-110":""}`,children:[e.jsxs("div",{className:`w-16 h-14 rounded-lg bg-gradient-to-br from-pink-500 to-pink-700 flex flex-col items-center justify-center ${s[t].highlight==="logvar"?"ring-2 ring-white":""}`,children:[e.jsx("p",{className:"text-lg font-bold",children:"20"}),e.jsx("p",{className:"text-xs",children:"log σ²"})]}),e.jsx("p",{className:`text-center text-xs mt-1 ${s[t].highlight==="logvar"?"text-pink-300":"text-gray-500"}`,children:"Log-Var"})]})]}),e.jsx(c,{className:"text-gray-800 dark:text-gray-600"}),e.jsxs("div",{className:`transition-all duration-500 ${s[t].highlight==="reparam"?"scale-110":""}`,children:[e.jsxs("div",{className:`w-20 h-20 rounded-full bg-gradient-to-br from-violet-500 to-purple-700 flex flex-col items-center justify-center ${s[t].highlight==="reparam"?"ring-2 ring-white sample-bounce":""}`,children:[e.jsx("p",{className:"text-lg font-bold",children:"z"}),e.jsx("p",{className:"text-xs opacity-80",children:"latent"})]}),e.jsx("p",{className:`text-center text-xs mt-1 ${s[t].highlight==="reparam"?"text-purple-300":"text-gray-500"}`,children:"Sample"})]})]}),s[t].highlight==="reparam"&&e.jsxs("div",{className:"mt-6 p-4 bg-purple-900/30 rounded-xl border border-purple-500/30",children:[e.jsxs("p",{className:"text-center font-mono text-lg",children:[e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"z"})," =",e.jsx("span",{className:"text-purple-300",children:" μ"})," +",e.jsx("span",{className:"text-pink-300",children:" σ"})," ⊙",e.jsx("span",{className:"text-yellow-300",children:" ε"}),e.jsx("span",{className:"text-gray-800 dark:text-sm ml-2",children:"(where ε ~ N(0, I))"})]}),e.jsx("p",{className:"text-center text-sm text-gray-800 dark:text-gray-400 mt-2",children:"σ = exp(0.5 × log σ²) — computing σ from log-variance for numerical stability"})]})]}),e.jsxs("div",{className:"bg-black/40 rounded-xl p-4 border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400 mb-3",children:"PyTorch Encoder Implementation:"}),e.jsx("pre",{className:"text-sm overflow-x-auto",children:e.jsx("code",{className:"text-green-300",children:`class Encoder(nn.Module):
    def __init__(self, input_dim=784, hidden_dim=400, latent_dim=20):
        super().__init__()
        self.fc1 = nn.Linear(input_dim, hidden_dim)
        self.fc2 = nn.Linear(hidden_dim, hidden_dim // 2)
        self.fc_mu = nn.Linear(hidden_dim // 2, latent_dim)      # Mean
        self.fc_logvar = nn.Linear(hidden_dim // 2, latent_dim)  # Log-variance
    
    def forward(self, x):
        h = F.relu(self.fc1(x))
        h = F.relu(self.fc2(h))
        mu = self.fc_mu(h)
        logvar = self.fc_logvar(h)
        return mu, logvar
    
    def reparameterize(self, mu, logvar):
        std = torch.exp(0.5 * logvar)  # σ = exp(0.5 × log σ²)
        eps = torch.randn_like(std)     # ε ~ N(0, I)
        return mu + std * eps           # z = μ + σ ⊙ ε`})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-purple-900/20 rounded-xl p-4 border border-purple-500/30",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-2",children:"Why Two Outputs?"}),e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["The encoder outputs both μ and log σ² because we're learning a ",e.jsx("strong",{children:"distribution"}),", not a single point. Each latent dimension has its own mean and variance."]})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-xl p-4 border border-green-500/30",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-2",children:"Why Log-Variance?"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"We output log σ² instead of σ because: (1) variance must be positive, but log can be any real number, (2) it's more numerically stable during training."})]})]})]})}export{w as default};
