import{c as q,r as c,j as e,w as y,e as A,y as _,C,Z as z,B as M}from"./index-CsxpOLHd.js";import{g as I}from"./index-C8pce-KX.js";import{P as S}from"./pause-BMcOX1vk.js";import{P as v}from"./play-CIyTSByC.js";import{R as w}from"./rotate-ccw-xVnQluc9.js";import{R as O}from"./refresh-cw-CbjIGqua.js";import{C as P}from"./clock-BXk6uTBc.js";import{H as D}from"./hard-drive-D5TPG31V.js";import{C as F}from"./code-CB4Crw6s.js";import{C as B}from"./check-circle-C5pajHEW.js";import{X as L}from"./x-circle-guWBBJ3U.js";import{T as R}from"./trophy-Dwhtv2pZ.js";import{A as $}from"./arrow-left-right-B1uq9VWv.js";import{S as E}from"./split-CLOmGbw5.js";import{G as W}from"./graduation-cap-R77j1NjU.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=q("Combine",[["rect",{width:"8",height:"8",x:"2",y:"2",rx:"2",key:"z1hh3n"}],["path",{d:"M14 2c1.1 0 2 .9 2 2v4c0 1.1-.9 2-2 2",key:"83orz6"}],["path",{d:"M20 2c1.1 0 2 .9 2 2v4c0 1.1-.9 2-2 2",key:"k86dmt"}],["path",{d:"M10 18H5c-1.7 0-3-1.3-3-3v-1",key:"6vokjl"}],["polyline",{points:"7 21 10 18 7 15",key:"1k02g0"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]);function k(){const[t,h]=c.useState(!1),[o,x]=c.useState(0),r=c.useRef(null),s=[{title:"Separate Modalities",desc:"Image tokens and text tokens exist in different spaces"},{title:"Cross-Attention Limitation",desc:"Traditional approach: text conditions image via cross-attention"},{title:"Joint Attention Solution",desc:"MM-DiT: concatenate all tokens, apply unified self-attention"},{title:"Bidirectional Flow",desc:"Image and text mutually inform each other"}];return c.useEffect(()=>(t?r.current=I.to({},{duration:2,repeat:-1,onRepeat:()=>{x(n=>(n+1)%s.length)}}):r.current&&r.current.kill(),()=>{r.current&&r.current.kill()}),[t]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Why ",e.jsx("span",{className:"text-violet-400",children:"Joint Attention"}),"?"]}),e.jsx("p",{className:"text-gray-400",children:"How MM-DiT revolutionizes text-image interaction in diffusion models"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("div",{className:"flex justify-center mb-6 gap-4",children:[e.jsxs("button",{onClick:()=>h(!t),className:"px-4 py-2 rounded-lg bg-violet-600 hover:bg-violet-500 flex items-center gap-2",children:[t?e.jsx(S,{size:18}):e.jsx(v,{size:18}),t?"Pause":"Play"]}),e.jsxs("button",{onClick:()=>{x(0),h(!1)},className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 flex items-center gap-2",children:[e.jsx(w,{size:18}),"Reset"]})]}),e.jsxs("div",{className:"mb-4 text-center",children:[e.jsxs("span",{className:"text-violet-400 font-bold",children:["Step ",o+1,":"]})," ",e.jsx("span",{className:"text-gray-300",children:s[o].title})]}),e.jsxs("div",{className:"relative h-80 bg-black/30 rounded-xl overflow-hidden",children:[o===0&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-around p-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"grid grid-cols-4 gap-1 mb-3",children:[...Array(16)].map((n,l)=>e.jsx("div",{className:"w-8 h-8 rounded bg-gradient-to-br from-blue-500 to-cyan-500 opacity-80"},l))}),e.jsx("p",{className:"text-blue-400 font-bold",children:"Image Tokens"}),e.jsx("p",{className:"text-xs text-gray-400",children:"4096 tokens (64Ã—64)"})]}),e.jsx("div",{className:"h-40 w-px bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex flex-col gap-1 mb-3",children:["a","cat","on","beach"].map((n,l)=>e.jsx("div",{className:"px-3 py-2 rounded bg-gradient-to-br from-orange-500 to-amber-500",children:n},l))}),e.jsx("p",{className:"text-orange-400 font-bold",children:"Text Tokens"}),e.jsx("p",{className:"text-xs text-gray-400",children:"77-256 tokens"})]})]}),o===1&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center p-8",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center mb-2",children:e.jsx("span",{className:"text-2xl",children:"ðŸ–¼ï¸"})}),e.jsx("p",{className:"text-sm text-blue-400",children:"Self-Attn"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-px bg-orange-400"}),e.jsx("span",{className:"text-xs text-orange-400 my-1",children:"Cross-Attn"}),e.jsx("div",{className:"w-16 h-px bg-orange-400"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-xl bg-gradient-to-br from-orange-500 to-amber-500 flex items-center justify-center mb-2",children:e.jsx("span",{className:"text-2xl",children:"ðŸ“"})}),e.jsx("p",{className:"text-sm text-orange-400",children:"Text Enc"})]})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center",children:e.jsx("p",{className:"text-red-400 text-sm",children:"âš ï¸ One-way flow: Text â†’ Image only"})})]}),o===2&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-8",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Concatenate into unified sequence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[[...Array(4)].map((n,l)=>e.jsx("div",{className:"w-10 h-10 rounded bg-gradient-to-br from-blue-500 to-cyan-500"},`img-${l}`)),e.jsx("span",{className:"text-gray-400 mx-2",children:"..."}),["a","cat","..."].map((n,l)=>e.jsx("div",{className:"px-2 py-2 rounded bg-gradient-to-br from-orange-500 to-amber-500 text-sm",children:n},`txt-${l}`))]}),e.jsx(y,{className:"my-4 text-violet-400"}),e.jsx("div",{className:"w-full max-w-md h-24 rounded-xl bg-gradient-to-r from-violet-600/50 to-fuchsia-600/50 border border-violet-400 flex items-center justify-center",children:e.jsx("span",{className:"text-violet-200 font-bold",children:"Full Self-Attention"})}),e.jsx("p",{className:"text-sm text-green-400 mt-4",children:"âœ“ All tokens can attend to all tokens"})]}),o===3&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-8",children:e.jsxs("div",{className:"relative w-80 h-60",children:[e.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 320 240",children:[e.jsx("defs",{children:e.jsx("marker",{id:"arrow",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",children:e.jsx("path",{d:"M0,0 L0,6 L9,3 z",fill:"#a855f7"})})}),e.jsx("path",{d:"M80,80 Q160,40 240,80",fill:"none",stroke:"#3b82f6",strokeWidth:"2",markerEnd:"url(#arrow)"}),e.jsx("path",{d:"M240,160 Q160,200 80,160",fill:"none",stroke:"#f97316",strokeWidth:"2",markerEnd:"url(#arrow)"})]}),e.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-28 h-28 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ–¼ï¸"})}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-28 h-28 rounded-xl bg-gradient-to-br from-orange-500 to-amber-500 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“"})}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 text-blue-400 text-sm",children:"Image attends to Text"}),e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 text-orange-400 text-sm",children:"Text attends to Image"})]})})]}),e.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:s[o].desc})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-red-900/20 rounded-xl p-5 border border-red-500/30",children:[e.jsx("h3",{className:"font-bold text-red-400 mb-3",children:"âŒ Cross-Attention (SD1.5/SDXL)"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[e.jsx("li",{children:"â€¢ Text tokens are read-only keys/values"}),e.jsx("li",{children:'â€¢ Text cannot "see" the image state'}),e.jsx("li",{children:"â€¢ Separate streams with limited interaction"}),e.jsx("li",{children:"â€¢ More architectural complexity"})]})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-xl p-5 border border-green-500/30",children:[e.jsx("h3",{className:"font-bold text-green-400 mb-3",children:"âœ“ Joint Attention (SD3/MM-DiT)"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[e.jsx("li",{children:"â€¢ All tokens are equal participants"}),e.jsx("li",{children:"â€¢ Text tokens update based on image"}),e.jsx("li",{children:"â€¢ Unified transformer architecture"}),e.jsx("li",{children:"â€¢ Simpler, more scalable design"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-black/30 rounded-xl p-4 text-center border border-white/10",children:[e.jsx("p",{className:"text-2xl font-bold text-violet-400",children:"4096+"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Image tokens (1024px)"})]}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-4 text-center border border-white/10",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:"77-256"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Text tokens"})]}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-4 text-center border border-white/10",children:[e.jsx("p",{className:"text-2xl font-bold text-fuchsia-400",children:"O(NÂ²)"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Attention complexity"})]})]})]})}function G(){const[t,h]=c.useState(16),[o,x]=c.useState(8),r=[...Array(Math.min(t,16))],s=[...Array(Math.min(o,12))];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Token ",e.jsx("span",{className:"text-violet-400",children:"Concatenation"})]}),e.jsx("p",{className:"text-gray-400",children:"How image patches and text tokens become a unified sequence"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Build Your Sequence"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-blue-400 block mb-2",children:["Image Tokens: ",t," (from ",Math.sqrt(t),"Ã—",Math.sqrt(t)," patches)"]}),e.jsx("input",{type:"range",min:"4",max:"64",step:"4",value:t,onChange:n=>h(parseInt(n.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-orange-400 block mb-2",children:["Text Tokens: ",o]}),e.jsx("input",{type:"range",min:"1",max:"20",value:o,onChange:n=>x(parseInt(n.target.value)),className:"w-full"})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-xl p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-8 mb-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"grid gap-1 mb-2",style:{gridTemplateColumns:`repeat(${Math.ceil(Math.sqrt(t))}, minmax(0, 1fr))`},children:r.map((n,l)=>e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 rounded bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-xs font-bold",children:l},l))}),e.jsx("p",{className:"text-blue-400 text-sm",children:"Image Tokens"})]}),e.jsx("div",{className:"text-gray-500 text-2xl",children:"+"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex flex-wrap gap-1 mb-2 justify-center max-w-xs",children:s.map((n,l)=>e.jsxs("div",{className:"px-2 py-1 rounded bg-gradient-to-br from-orange-500 to-amber-500 text-xs font-bold",children:["T",l]},l))}),e.jsx("p",{className:"text-orange-400 text-sm",children:"Text Tokens"})]})]}),e.jsx(y,{className:"mx-auto text-violet-400 mb-4",size:32}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-3",children:["Concatenated Sequence (length: ",t+o,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-1 justify-center p-4 bg-violet-900/20 rounded-xl border border-violet-500/30",children:[r.map((n,l)=>e.jsx("div",{className:"w-6 h-6 rounded bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-xs font-bold",children:l},`img-${l}`)),e.jsx("div",{className:"w-px h-6 bg-white/30 mx-1"}),s.map((n,l)=>e.jsxs("div",{className:"px-2 h-6 rounded bg-gradient-to-br from-orange-500 to-amber-500 flex items-center justify-center text-xs font-bold",children:["T",l]},`txt-${l}`))]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(A,{size:20,className:"text-violet-400"}),"Embedding Process"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-5 border border-blue-500/30",children:[e.jsx("h4",{className:"font-bold text-blue-400 mb-3",children:"Image Tokens"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-blue-500/30 flex items-center justify-center",children:"1"}),e.jsx("span",{children:"VAE encodes image â†’ 128Ã—128Ã—16 latent"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-blue-500/30 flex items-center justify-center",children:"2"}),e.jsx("span",{children:"Patchify into 2Ã—2 patches â†’ 64Ã—64 patches"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-blue-500/30 flex items-center justify-center",children:"3"}),e.jsx("span",{children:"Linear projection â†’ d_model (1536/3072)"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-blue-500/30 flex items-center justify-center",children:"4"}),e.jsx("span",{children:"Add 2D positional encoding"})]})]})]}),e.jsxs("div",{className:"bg-orange-900/20 rounded-xl p-5 border border-orange-500/30",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Text Tokens"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-orange-500/30 flex items-center justify-center",children:"1"}),e.jsx("span",{children:"Tokenize prompt with CLIP/T5"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-orange-500/30 flex items-center justify-center",children:"2"}),e.jsx("span",{children:"Encode through CLIP-L, CLIP-G, T5"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-orange-500/30 flex items-center justify-center",children:"3"}),e.jsx("span",{children:"Concatenate encoder outputs"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded bg-orange-500/30 flex items-center justify-center",children:"4"}),e.jsx("span",{children:"Project to match d_model"})]})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Dimension Breakdown (SD3-Medium)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Stage"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Shape"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Description"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-blue-400",children:"Input Image"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"1024Ã—1024Ã—3"}),e.jsx("td",{className:"py-3 px-4",children:"RGB image"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-blue-400",children:"VAE Latent"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"128Ã—128Ã—16"}),e.jsx("td",{className:"py-3 px-4",children:"8Ã— compression"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-blue-400",children:"Image Tokens"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"4096Ã—1536"}),e.jsx("td",{className:"py-3 px-4",children:"64Ã—64 patches Ã— d_model"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-orange-400",children:"Text (CLIP-L)"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"77Ã—768"}),e.jsx("td",{className:"py-3 px-4",children:"CLIP ViT-L"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-orange-400",children:"Text (CLIP-G)"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"77Ã—1280"}),e.jsx("td",{className:"py-3 px-4",children:"CLIP ViT-bigG"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-orange-400",children:"Text (T5)"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"256Ã—4096"}),e.jsx("td",{className:"py-3 px-4",children:"T5-XXL encoder"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-violet-400",children:"Combined Text"}),e.jsx("td",{className:"py-3 px-4 font-mono",children:"~154Ã—1536"}),e.jsx("td",{className:"py-3 px-4",children:"Projected & concat"})]}),e.jsxs("tr",{className:"bg-violet-900/20",children:[e.jsx("td",{className:"py-3 px-4 text-violet-400 font-bold",children:"Joint Sequence"}),e.jsx("td",{className:"py-3 px-4 font-mono font-bold",children:"~4250Ã—1536"}),e.jsx("td",{className:"py-3 px-4",children:"Ready for attention"})]})]})]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Concatenation in Code"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`# Pseudo-code for token concatenation
def prepare_joint_sequence(image_latent, text_embeddings):
    # Image tokens: (B, H, W, C) -> (B, H*W, D)
    img_tokens = patchify_and_embed(image_latent)  # (B, 4096, 1536)
    img_tokens = img_tokens + pos_embed_2d         # Add 2D position
    
    # Text tokens: already (B, seq_len, D)
    txt_tokens = project_text(text_embeddings)     # (B, ~154, 1536)
    
    # Concatenate along sequence dimension
    joint_seq = torch.cat([img_tokens, txt_tokens], dim=1)
    # joint_seq shape: (B, 4096 + 154, 1536) = (B, 4250, 1536)
    
    return joint_seq, len(img_tokens[0])  # Also return split point`})})]})]})}function U(){const[t,h]=c.useState(null),[o,x]=c.useState(!1),r=c.useRef(null),s=16,n=4,l=s+n,p=(m,a)=>{const g=Math.ceil(Math.sqrt(a)),j=Math.floor(m/g);return{x:60+m%g*50,y:60+j*50}},d=m=>{h(t===m?null:m)};c.useEffect(()=>{if(t!==null&&r.current){const m=r.current.querySelectorAll(".attention-line");I.fromTo(m,{strokeDashoffset:100},{strokeDashoffset:0,duration:.5,stagger:.02})}},[t]);const b=()=>{x(!0);let m=0;const a=setInterval(()=>{h(m),m++,m>=l&&(clearInterval(a),setTimeout(()=>{h(null),x(!1)},1e3))},300)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Attention ",e.jsx("span",{className:"text-violet-400",children:"Flow"})]}),e.jsx("p",{className:"text-gray-400",children:"Visualize how each token attends to every other token"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:b,disabled:o,className:"px-4 py-2 rounded-lg bg-violet-600 hover:bg-violet-500 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(v,{size:18}),"Animate All"]}),e.jsxs("button",{onClick:()=>h(null),className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 flex items-center gap-2",children:[e.jsx(w,{size:18}),"Clear"]})]}),e.jsx("p",{className:"text-center text-sm text-gray-400 mb-4",children:"Click on any token to see what it attends to (all other tokens!)"}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("svg",{ref:r,width:"400",height:"350",className:"bg-black/30 rounded-xl",children:[e.jsx("text",{x:"130",y:"25",fill:"#60a5fa",className:"text-xs",children:"Image Tokens"}),e.jsx("text",{x:"300",y:"25",fill:"#fb923c",className:"text-xs",children:"Text"}),t!==null&&e.jsx("g",{children:[...Array(l)].map((m,a)=>{if(a===t)return null;const g=t<s?p(t,s):{x:300,y:80+(t-s)*50},j=a<s?p(a,s):{x:300,y:80+(a-s)*50},i=t<s&&a>=s,f=t>=s&&a<s,u=i?"#60a5fa":f?"#fb923c":"#a855f7",N=Math.random()*.5+.3;return e.jsx("line",{className:"attention-line",x1:g.x+15,y1:g.y+15,x2:j.x+15,y2:j.y+15,stroke:u,strokeWidth:N*3,strokeOpacity:N,strokeDasharray:"100",strokeDashoffset:"0"},a)})}),[...Array(s)].map((m,a)=>{const g=p(a,s),j=t===a;return e.jsxs("g",{onClick:()=>d(a),className:"cursor-pointer",children:[e.jsx("rect",{x:g.x,y:g.y,width:"30",height:"30",rx:"4",fill:j?"#3b82f6":"#1e40af",stroke:j?"#60a5fa":"transparent",strokeWidth:"2",className:"transition-all hover:fill-blue-500"}),e.jsx("text",{x:g.x+15,y:g.y+19,fill:"white",textAnchor:"middle",className:"text-xs font-bold pointer-events-none",children:a})]},`img-${a}`)}),e.jsx("line",{x1:"260",y1:"50",x2:"260",y2:"280",stroke:"white",strokeOpacity:"0.2",strokeDasharray:"4"}),[...Array(n)].map((m,a)=>{const g=t===s+a;return e.jsxs("g",{onClick:()=>d(s+a),className:"cursor-pointer",children:[e.jsx("rect",{x:"280",y:60+a*50,width:"50",height:"30",rx:"4",fill:g?"#ea580c":"#9a3412",stroke:g?"#fb923c":"transparent",strokeWidth:"2",className:"transition-all hover:fill-orange-500"}),e.jsxs("text",{x:"305",y:79+a*50,fill:"white",textAnchor:"middle",className:"text-xs font-bold pointer-events-none",children:["T",a]})]},`txt-${a}`)}),e.jsxs("g",{transform:"translate(20, 300)",children:[e.jsx("rect",{x:"0",y:"0",width:"12",height:"12",fill:"#3b82f6",rx:"2"}),e.jsx("text",{x:"18",y:"10",fill:"#9ca3af",className:"text-xs",children:"Imgâ†’All"}),e.jsx("rect",{x:"80",y:"0",width:"12",height:"12",fill:"#f97316",rx:"2"}),e.jsx("text",{x:"98",y:"10",fill:"#9ca3af",className:"text-xs",children:"Txtâ†’All"}),e.jsx("rect",{x:"160",y:"0",width:"12",height:"12",fill:"#a855f7",rx:"2"}),e.jsx("text",{x:"178",y:"10",fill:"#9ca3af",className:"text-xs",children:"Same type"})]})]})}),t!==null&&e.jsx("div",{className:"mt-4 text-center p-3 bg-violet-900/30 rounded-lg",children:e.jsxs("p",{className:"text-violet-300",children:["Token ",e.jsx("span",{className:"font-bold",children:t<s?t:`T${t-s}`})," attends to all ",l-1," other tokens"]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Attention Matrix View"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"The full attention matrix for joint attention (simplified 4Ã—4 img + 2 text)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"mx-auto text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-1"}),[...Array(6)].map((m,a)=>e.jsx("th",{className:`p-1 ${a<4?"text-blue-400":"text-orange-400"}`,children:a<4?`I${a}`:`T${a-4}`},a))]})}),e.jsx("tbody",{children:[...Array(6)].map((m,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:`p-1 font-bold ${a<4?"text-blue-400":"text-orange-400"}`,children:a<4?`I${a}`:`T${a-4}`}),[...Array(6)].map((g,j)=>{const i=Math.random()*.8+.1,f=a<4&&j<4,u=a>=4&&j>=4;let N;return f?N=`rgba(59, 130, 246, ${i})`:u?N=`rgba(249, 115, 22, ${i})`:N=`rgba(168, 85, 247, ${i})`,e.jsx("td",{className:"w-10 h-10 text-center border border-white/10",style:{background:N},children:i.toFixed(1)},j)})]},a))})]})}),e.jsxs("div",{className:"mt-4 flex justify-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-500/60"}),e.jsx("span",{className:"text-gray-400",children:"Imageâ†”Image"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-orange-500/60"}),e.jsx("span",{className:"text-gray-400",children:"Textâ†”Text"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-violet-500/60"}),e.jsx("span",{className:"text-gray-400",children:"Cross-modal"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-violet-900/30 to-fuchsia-900/30 rounded-xl p-6 border border-violet-500/30",children:[e.jsx("h3",{className:"font-bold text-violet-300 mb-2",children:"ðŸ’¡ Key Insight"}),e.jsxs("p",{className:"text-gray-300",children:["In joint attention, the attention matrix is ",e.jsx("strong",{children:"fully dense"})," - every token (both image and text) can attend to every other token. This creates four types of attention:"]}),e.jsxs("ul",{className:"mt-3 text-sm text-gray-400 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("span",{className:"text-blue-400",children:"Imageâ†’Image:"})," Spatial coherence, object consistency"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("span",{className:"text-orange-400",children:"Textâ†’Text:"})," Language understanding, context"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("span",{className:"text-violet-400",children:"Imageâ†’Text:"})," Image regions query text for guidance"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("span",{className:"text-violet-400",children:"Textâ†’Image:"})," Text concepts attend to relevant image regions"]})]})]})]})}function X(){const[t,h]=c.useState(0),[o,x]=c.useState(!1),r=c.useRef(null),s=[{title:"Initial State",desc:"Image shows noise, text has semantic meaning",imgLabel:"Noisy latent",txtLabel:'"A cat on beach"'},{title:"Text â†’ Image (Q from Img)",desc:"Image queries text: 'What should I look like?'",direction:"txt-to-img"},{title:"Image regions attend to 'cat'",desc:"Center regions get high attention to 'cat' token",highlight:"cat"},{title:"Image regions attend to 'beach'",desc:"Background regions attend to 'beach' token",highlight:"beach"},{title:"Image â†’ Text (Q from Text)",desc:"Text queries image: 'What's actually forming?'",direction:"img-to-txt"},{title:"Text tokens update",desc:"Text representations refine based on image state",txtUpdate:!0},{title:"Mutual Refinement",desc:"Both modalities have richer representations",final:!0}];return c.useEffect(()=>(o?r.current=setInterval(()=>{h(n=>(n+1)%s.length)},2e3):r.current&&clearInterval(r.current),()=>{r.current&&clearInterval(r.current)}),[o]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"text-violet-400",children:"Bidirectional"})," Fusion"]}),e.jsx("p",{className:"text-gray-400",children:"How image and text mutually refine each other through joint attention"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>x(!o),className:"px-4 py-2 rounded-lg bg-violet-600 hover:bg-violet-500 flex items-center gap-2",children:[o?e.jsx(S,{size:18}):e.jsx(v,{size:18}),o?"Pause":"Auto Play"]}),e.jsx("button",{onClick:()=>h((t-1+s.length)%s.length),className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:e.jsx(_,{size:18})}),e.jsx("button",{onClick:()=>h((t+1)%s.length),className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:e.jsx(y,{size:18})})]}),e.jsxs("div",{className:"mb-4 text-center",children:[e.jsxs("span",{className:"text-violet-400 font-bold",children:["Step ",t+1,"/",s.length,":"]})," ",e.jsx("span",{className:"text-white",children:s[t].title})]}),e.jsx("div",{className:"relative h-80 bg-black/30 rounded-xl overflow-hidden",children:e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`grid grid-cols-3 gap-1 p-4 rounded-xl border-2 transition-all duration-500 ${s[t].direction==="txt-to-img"?"border-orange-400 shadow-lg shadow-orange-400/30":s[t].direction==="img-to-txt"?"border-blue-400 shadow-lg shadow-blue-400/30":s[t].final?"border-violet-400 shadow-lg shadow-violet-400/30":"border-white/20"}`,children:[...Array(9)].map((n,l)=>{let p=t===0?.3:.3+t*.1,d=!1;return s[t].highlight==="cat"&&[1,4,7].includes(l)&&(d=!0),s[t].highlight==="beach"&&[0,2,3,5,6,8].includes(l)&&(d=!0),e.jsx("div",{className:`w-12 h-12 rounded transition-all duration-300 ${d?"ring-2 ring-orange-400 scale-110":""} ${s[t].final?"bg-gradient-to-br from-blue-400 to-cyan-400":"bg-blue-500"}`,style:{opacity:d?1:p}},l)})}),e.jsx("p",{className:"text-center text-blue-400 text-sm mt-2",children:"Image Tokens"})]}),e.jsxs("div",{className:"mx-8 flex flex-col items-center gap-4",children:[e.jsxs("div",{className:`flex items-center transition-all duration-500 ${s[t].direction==="txt-to-img"?"opacity-100 scale-110":"opacity-30"}`,children:[e.jsx(_,{size:32,className:"text-orange-400"}),e.jsx("span",{className:"text-xs text-orange-400 mx-2",children:"Textâ†’Img"})]}),e.jsx(O,{className:`transition-all duration-500 ${s[t].final?"text-violet-400 animate-spin":"text-gray-600"}`,size:24}),e.jsxs("div",{className:`flex items-center transition-all duration-500 ${s[t].direction==="img-to-txt"?"opacity-100 scale-110":"opacity-30"}`,children:[e.jsx("span",{className:"text-xs text-blue-400 mx-2",children:"Imgâ†’Text"}),e.jsx(y,{size:32,className:"text-blue-400"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`flex flex-col gap-2 p-4 rounded-xl border-2 transition-all duration-500 ${s[t].direction==="img-to-txt"?"border-blue-400 shadow-lg shadow-blue-400/30":s[t].txtUpdate?"border-green-400 shadow-lg shadow-green-400/30":s[t].final?"border-violet-400 shadow-lg shadow-violet-400/30":"border-white/20"}`,children:["A","cat","on","beach"].map((n,l)=>{const p=s[t].highlight===n.toLowerCase(),d=s[t].txtUpdate;return e.jsx("div",{className:`px-4 py-2 rounded transition-all duration-300 ${p?"bg-orange-500 ring-2 ring-orange-300 scale-110":d?"bg-gradient-to-r from-orange-500 to-green-500":s[t].final?"bg-gradient-to-r from-orange-400 to-amber-400":"bg-orange-500"}`,children:n},l)})}),e.jsx("p",{className:"text-center text-orange-400 text-sm mt-2",children:"Text Tokens"})]})]})}),e.jsx("p",{className:"text-center text-gray-400 mt-4",children:s[t].desc})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"The Math Behind Bidirectional Flow"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-5 border border-blue-500/30",children:[e.jsx("h4",{className:"font-bold text-blue-400 mb-3",children:"Image Updates from Text"}),e.jsxs("div",{className:"font-mono text-sm space-y-2",children:[e.jsx("p",{children:"Q_img = W_q Â· X_img"}),e.jsx("p",{children:"K_all = W_k Â· [X_img; X_txt]"}),e.jsx("p",{children:"V_all = W_v Â· [X_img; X_txt]"}),e.jsx("p",{className:"text-violet-400",children:"A_img = softmax(Q_img Â· K_all^T / âˆšd)"}),e.jsx("p",{className:"text-green-400",children:"X_img' = A_img Â· V_all"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Image tokens query the joint sequence, receiving information from text"})]}),e.jsxs("div",{className:"bg-orange-900/20 rounded-xl p-5 border border-orange-500/30",children:[e.jsx("h4",{className:"font-bold text-orange-400 mb-3",children:"Text Updates from Image"}),e.jsxs("div",{className:"font-mono text-sm space-y-2",children:[e.jsx("p",{children:"Q_txt = W_q Â· X_txt"}),e.jsx("p",{children:"K_all = W_k Â· [X_img; X_txt]"}),e.jsx("p",{children:"V_all = W_v Â· [X_img; X_txt]"}),e.jsx("p",{className:"text-violet-400",children:"A_txt = softmax(Q_txt Â· K_all^T / âˆšd)"}),e.jsx("p",{className:"text-green-400",children:"X_txt' = A_txt Â· V_all"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Text tokens query the joint sequence, seeing what's forming in the image"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/30 to-emerald-800/20 rounded-xl p-5 border border-green-500/30",children:[e.jsx("h3",{className:"font-bold text-green-300 mb-3",children:"âœ“ Benefits of Bidirectional"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Text awareness:"})," Text knows what's forming in image"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Context adaptation:"}),' "cat" means different things in different contexts']}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Error correction:"})," Text can guide if image drifts off-topic"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Compositional:"})," Better handling of multiple objects"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-violet-900/30 to-purple-800/20 rounded-xl p-5 border border-violet-500/30",children:[e.jsx("h3",{className:"font-bold text-violet-300 mb-3",children:"ðŸ”„ Per-Layer Refinement"}),e.jsxs("p",{className:"text-sm text-gray-300 mb-3",children:["This bidirectional exchange happens at ",e.jsx("strong",{children:"every transformer layer"}),":"]}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsx("p",{children:"Layer 1: Basic shapes & text parsing"}),e.jsx("p",{children:"Layer 12: Object-level understanding"}),e.jsx("p",{children:"Layer 24: Fine details & consistency"}),e.jsx("p",{children:"Layer 38: Final refinement"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Cross-Attention vs Joint Attention"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Aspect"}),e.jsx("th",{className:"py-3 px-4 text-left text-red-400",children:"Cross-Attention"}),e.jsx("th",{className:"py-3 px-4 text-left text-green-400",children:"Joint Attention"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4",children:"Text Token Updates"}),e.jsx("td",{className:"py-3 px-4",children:"âŒ Frozen"}),e.jsx("td",{className:"py-3 px-4",children:"âœ“ Updated each layer"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4",children:"Information Flow"}),e.jsx("td",{className:"py-3 px-4",children:"One-way (Textâ†’Image)"}),e.jsx("td",{className:"py-3 px-4",children:"Bidirectional"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4",children:"Attention Patterns"}),e.jsx("td",{className:"py-3 px-4",children:"2 types (self, cross)"}),e.jsx("td",{className:"py-3 px-4",children:"4 types (unified)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4",children:"Complexity"}),e.jsx("td",{className:"py-3 px-4",children:"Separate modules"}),e.jsx("td",{className:"py-3 px-4",children:"Single unified attention"})]})]})]})})]})]})}function H(){const[t,h]=c.useState(64),[o,x]=c.useState(77),[r,s]=c.useState(1536),[n,l]=c.useState(24),p=t*t,d=p+o,b=4*d*d*r,m=d*d*n*2,a=4*p*o*r+4*p*p*r,g=i=>i>=1e12?(i/1e12).toFixed(2)+"T":i>=1e9?(i/1e9).toFixed(2)+"G":i>=1e6?(i/1e6).toFixed(2)+"M":i>=1e3?(i/1e3).toFixed(2)+"K":i.toString(),j=i=>i>=1e9?(i/1e9).toFixed(2)+" GB":i>=1e6?(i/1e6).toFixed(2)+" MB":i>=1e3?(i/1e3).toFixed(2)+" KB":i+" B";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:[e.jsx("span",{className:"text-violet-400",children:"Computational"})," Costs"]}),e.jsx("p",{className:"text-gray-400",children:"Understanding the memory and compute requirements of joint attention"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(C,{size:20,className:"text-violet-400"}),"Interactive Calculator"]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Image Size: ",t,"Ã—",t," (",p," tokens)"]}),e.jsx("input",{type:"range",min:"16",max:"128",step:"16",value:t,onChange:i=>h(parseInt(i.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Text Length: ",o," tokens"]}),e.jsx("input",{type:"range",min:"32",max:"256",step:"1",value:o,onChange:i=>x(parseInt(i.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["d_model: ",r]}),e.jsxs("select",{value:r,onChange:i=>s(parseInt(i.target.value)),className:"w-full bg-white/10 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"1024",children:"1024 (Small)"}),e.jsx("option",{value:"1536",children:"1536 (SD3-Medium)"}),e.jsx("option",{value:"3072",children:"3072 (SD3-Large)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-2",children:["Attention Heads: ",n]}),e.jsx("input",{type:"range",min:"8",max:"48",step:"8",value:n,onChange:i=>l(parseInt(i.target.value)),className:"w-full"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-violet-900/30 rounded-xl p-4 border border-violet-500/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Total Sequence"}),e.jsx("p",{className:"text-2xl font-bold text-violet-400",children:g(d)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[p," img + ",o," txt"]})]}),e.jsxs("div",{className:"bg-blue-900/30 rounded-xl p-4 border border-blue-500/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Attention FLOPs"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:g(b)}),e.jsx("p",{className:"text-xs text-gray-500",children:"per layer"})]}),e.jsxs("div",{className:"bg-orange-900/30 rounded-xl p-4 border border-orange-500/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Attn Matrix Memory"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:j(m)}),e.jsx("p",{className:"text-xs text-gray-500",children:"FP16, per layer"})]}),e.jsxs("div",{className:"bg-green-900/30 rounded-xl p-4 border border-green-500/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"vs Cross-Attn"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:[((b/a-1)*100).toFixed(0),"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"more compute"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Complexity Breakdown"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-violet-900/20 rounded-xl p-4 border border-violet-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-bold text-violet-400",children:"Joint Self-Attention"}),e.jsx("span",{className:"font-mono text-violet-300",children:"O((N_img + N_txt)Â²)"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Every token attends to every other token. For 4096 image + 77 text = 4173Â² â‰ˆ 17.4M attention scores per head."}),e.jsx("div",{className:"mt-2 w-full bg-white/10 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-violet-500 to-fuchsia-500 h-3 rounded-full",style:{width:"100%"}})})]}),e.jsxs("div",{className:"bg-blue-900/20 rounded-xl p-4 border border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-bold text-blue-400",children:"Cross-Attention (for comparison)"}),e.jsx("span",{className:"font-mono text-blue-300",children:"O(N_img Ã— N_txt)"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Only image queries text. For 4096 Ã— 77 â‰ˆ 315K attention scores - much smaller!"}),e.jsx("div",{className:"mt-2 w-full bg-white/10 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 h-3 rounded-full",style:{width:`${p*o/(d*d)*100}%`}})})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-900/20 rounded-xl border border-yellow-500/30",children:e.jsxs("p",{className:"text-yellow-300 text-sm",children:[e.jsx("strong",{children:"âš ï¸ Why is joint attention worth the cost?"}),e.jsx("br",{}),"The quadratic scaling means joint attention is computationally expensive, but:",e.jsxs("ul",{className:"mt-2 text-gray-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Flash Attention reduces memory from O(NÂ²) to O(N)"}),e.jsx("li",{children:"â€¢ Modern GPUs handle large matrix ops efficiently"}),e.jsx("li",{children:"â€¢ The quality gains are significant"}),e.jsx("li",{children:"â€¢ Text tokens are few compared to image tokens"})]})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/30 to-emerald-800/20 rounded-xl p-5 border border-green-500/30",children:[e.jsxs("h3",{className:"font-bold text-green-300 mb-3 flex items-center gap-2",children:[e.jsx(z,{size:18})," Flash Attention"]}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Fused CUDA kernels"}),e.jsx("li",{children:"â€¢ O(N) memory instead of O(NÂ²)"}),e.jsx("li",{children:"â€¢ 2-4Ã— faster training"}),e.jsx("li",{children:"â€¢ Enables longer sequences"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-violet-800/20 rounded-xl p-5 border border-purple-500/30",children:[e.jsxs("h3",{className:"font-bold text-purple-300 mb-3 flex items-center gap-2",children:[e.jsx(P,{size:18})," xFormers"]}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Memory-efficient attention"}),e.jsx("li",{children:"â€¢ Automatic kernel selection"}),e.jsx("li",{children:"â€¢ Works with various GPUs"}),e.jsx("li",{children:"â€¢ Easy integration"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-cyan-800/20 rounded-xl p-5 border border-blue-500/30",children:[e.jsxs("h3",{className:"font-bold text-blue-300 mb-3 flex items-center gap-2",children:[e.jsx(D,{size:18})," Gradient Checkpointing"]}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Trade compute for memory"}),e.jsx("li",{children:"â€¢ Recompute activations"}),e.jsx("li",{children:"â€¢ Enable larger batches"}),e.jsx("li",{children:"â€¢ Essential for training"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Resolution vs Memory (Inference, FP16)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Resolution"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Image Tokens"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Total Seq"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Attn Memory"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-400",children:"Total VRAM"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-violet-400",children:"512Ã—512"}),e.jsx("td",{className:"py-3 px-4",children:"1024"}),e.jsx("td",{className:"py-3 px-4",children:"~1100"}),e.jsx("td",{className:"py-3 px-4",children:"~58 MB"}),e.jsx("td",{className:"py-3 px-4 text-green-400",children:"~6 GB"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-violet-400",children:"768Ã—768"}),e.jsx("td",{className:"py-3 px-4",children:"2304"}),e.jsx("td",{className:"py-3 px-4",children:"~2400"}),e.jsx("td",{className:"py-3 px-4",children:"~276 MB"}),e.jsx("td",{className:"py-3 px-4 text-yellow-400",children:"~8 GB"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-violet-400",children:"1024Ã—1024"}),e.jsx("td",{className:"py-3 px-4",children:"4096"}),e.jsx("td",{className:"py-3 px-4",children:"~4200"}),e.jsx("td",{className:"py-3 px-4",children:"~847 MB"}),e.jsx("td",{className:"py-3 px-4 text-orange-400",children:"~12 GB"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-violet-400",children:"1536Ã—1536"}),e.jsx("td",{className:"py-3 px-4",children:"9216"}),e.jsx("td",{className:"py-3 px-4",children:"~9300"}),e.jsx("td",{className:"py-3 px-4",children:"~4.1 GB"}),e.jsx("td",{className:"py-3 px-4 text-red-400",children:"~20+ GB"})]})]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Note: Numbers are approximate. Flash Attention can reduce attention memory significantly. Total VRAM includes model weights, activations, and optimizer states."})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Enabling Flash Attention"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`# In diffusers, enable memory-efficient attention
from diffusers import StableDiffusion3Pipeline

pipe = StableDiffusion3Pipeline.from_pretrained(
    "stabilityai/stable-diffusion-3-medium-diffusers",
    torch_dtype=torch.float16
)

# Option 1: Enable xFormers (if installed)
pipe.enable_xformers_memory_efficient_attention()

# Option 2: Enable native PyTorch flash attention
# Requires PyTorch 2.0+ with CUDA
pipe.enable_attention_slicing()  # For lower VRAM

# Option 3: Use scaled_dot_product_attention (automatic in PyTorch 2.0+)
# No explicit call needed - happens automatically`})})]})]})}function J(){const[t,h]=c.useState(0),[o,x]=c.useState(null),[r,s]=c.useState(!1),[n,l]=c.useState(0),[p,d]=c.useState(!1),[b,m]=c.useState(!1),a=[{question:"What is the key difference between joint attention and cross-attention?",options:["Joint attention is faster","In joint attention, all tokens can attend to all tokens bidirectionally","Cross-attention has more parameters","Joint attention only works with images"],correct:1,explanation:"Joint attention concatenates image and text tokens into one sequence, allowing bidirectional information flow. Cross-attention only allows image to query text."},{question:"How does text token behavior differ in joint vs cross attention?",options:["Text tokens are discarded in both","Text tokens update in joint attention, stay frozen in cross-attention","Text tokens are always frozen","Text tokens update in cross-attention only"],correct:1,explanation:"In joint attention, text tokens participate fully and get updated each layer. In cross-attention, text tokens are read-only (frozen)."},{question:"What is the attention complexity for a joint sequence of N_img + N_txt tokens?",options:["O(N_img Ã— N_txt)","O(N_img + N_txt)","O((N_img + N_txt)Â²)","O(N_imgÂ²)"],correct:2,explanation:"Self-attention on the joint sequence has O(NÂ²) complexity where N = N_img + N_txt, meaning the attention matrix is (N_img + N_txt)Â²."},{question:"For a 1024Ã—1024 image with 2Ã—2 patching, how many image tokens are there?",options:["1024","4096","16384","262144"],correct:1,explanation:"1024px / 8 (VAE) = 128 latent pixels. With 2Ã—2 patches: (128/2)Â² = 64Â² = 4096 image tokens."},{question:"What technique reduces attention memory from O(NÂ²) to O(N)?",options:["Cross-attention","Token pruning","Flash Attention","Quantization"],correct:2,explanation:"Flash Attention uses tiling and recomputation to avoid materializing the full NÃ—N attention matrix, reducing memory to O(N)."},{question:"How many types of attention interactions exist in joint attention?",options:["1 (self-attention only)","2 (image-image, text-text)","3 (self, cross, image)","4 (imgâ†’img, txtâ†’txt, imgâ†’txt, txtâ†’img)"],correct:3,explanation:"Joint attention creates four interaction types: image self-attention, text self-attention, and bidirectional cross-modal attention (imageâ†”text)."},{question:"Why do text tokens benefit from seeing the image state?",options:["To reduce memory usage","To adapt text meaning based on what's actually forming","To speed up inference","It doesn't help - it's just simpler to implement"],correct:1,explanation:"When text tokens see the image, they can adapt their representation. 'Cat' might emphasize different features if a realistic vs cartoon cat is forming."},{question:"In SD3's MM-DiT, what happens to image and text after joint attention?",options:["They're kept together forever","They're split back into separate streams","Text tokens are discarded","Only image tokens continue"],correct:1,explanation:"After joint attention, the sequence is split back into image and text portions. Each goes through separate MLPs before the next layer."}],g=f=>{x(f),s(!0),f===a[t].correct&&l(n+1)},j=()=>{t<a.length-1?(h(t+1),x(null),s(!1)):d(!0)},i=()=>{h(0),x(null),s(!1),l(0),d(!1)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Practice Lab: ",e.jsx("span",{className:"text-violet-400",children:"Joint Attention"})]}),e.jsx("p",{className:"text-gray-400",children:"Test your understanding and explore hands-on exercises"})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>m(!1),className:`px-6 py-3 rounded-xl flex items-center gap-2 transition-all ${b?"bg-white/10 text-gray-400 hover:bg-white/20":"bg-violet-600 text-white"}`,children:[e.jsx(M,{size:18}),"Quiz"]}),e.jsxs("button",{onClick:()=>m(!0),className:`px-6 py-3 rounded-xl flex items-center gap-2 transition-all ${b?"bg-violet-600 text-white":"bg-white/10 text-gray-400 hover:bg-white/20"}`,children:[e.jsx(F,{size:18}),"Code Exercises"]})]}),b?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-violet-600 flex items-center justify-center text-sm",children:"1"}),"Implement Basic Joint Attention"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Create a simple joint attention mechanism from scratch."}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`import torch
import torch.nn as nn
import torch.nn.functional as F

class JointAttention(nn.Module):
    def __init__(self, d_model: int, num_heads: int):
        super().__init__()
        self.d_model = d_model
        self.num_heads = num_heads
        self.head_dim = d_model // num_heads
        
        # TODO: Define Q, K, V projections
        # TODO: Define output projection
        
    def forward(self, img_tokens, txt_tokens):
        # TODO: Concatenate tokens
        # joint = torch.cat([img_tokens, txt_tokens], dim=1)
        
        # TODO: Project to Q, K, V
        
        # TODO: Compute attention (scaled dot-product)
        
        # TODO: Split back into img and txt portions
        
        pass

# Test your implementation
batch_size = 2
img_seq = 64  # 8x8 patches
txt_seq = 10
d_model = 256

img = torch.randn(batch_size, img_seq, d_model)
txt = torch.randn(batch_size, txt_seq, d_model)

# attn = JointAttention(d_model, num_heads=8)
# img_out, txt_out = attn(img, txt)
# print(f"img_out: {img_out.shape}, txt_out: {txt_out.shape}")`})}),e.jsx("div",{className:"mt-4 p-4 bg-green-500/10 rounded-xl border border-green-500/30",children:e.jsxs("p",{className:"text-sm text-green-300",children:[e.jsx("strong",{children:"Goal:"})," Understand how joint attention is just self-attention on concatenated sequences."]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-600 flex items-center justify-center text-sm",children:"2"}),"Visualize Attention Patterns"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Extract and visualize the four attention pattern types."}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`import matplotlib.pyplot as plt
import seaborn as sns

def visualize_joint_attention(attn_weights, n_img, n_txt):
    """
    attn_weights: (n_img + n_txt, n_img + n_txt) attention matrix
    n_img: number of image tokens
    n_txt: number of text tokens
    """
    fig, axes = plt.subplots(2, 2, figsize=(12, 10))
    
    # TODO: Extract four quadrants
    # img_to_img = attn_weights[:n_img, :n_img]
    # img_to_txt = attn_weights[:n_img, n_img:]
    # txt_to_img = attn_weights[n_img:, :n_img]
    # txt_to_txt = attn_weights[n_img:, n_img:]
    
    # TODO: Plot each quadrant as a heatmap
    # Use sns.heatmap() or plt.imshow()
    
    # TODO: Add titles and labels
    # "Imageâ†’Image", "Imageâ†’Text", "Textâ†’Image", "Textâ†’Text"
    
    plt.tight_layout()
    plt.savefig("joint_attention_patterns.png")

# Create synthetic attention weights for testing
n_img, n_txt = 64, 10
total = n_img + n_txt
fake_attn = torch.softmax(torch.randn(total, total), dim=-1)
# visualize_joint_attention(fake_attn.numpy(), n_img, n_txt)`})}),e.jsx("div",{className:"mt-4 p-4 bg-purple-500/10 rounded-xl border border-purple-500/30",children:e.jsxs("p",{className:"text-sm text-purple-300",children:[e.jsx("strong",{children:"Goal:"})," See the four different attention patterns in a joint attention matrix."]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center text-sm",children:"3"}),"Compare Memory Usage"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Benchmark memory usage of joint vs cross attention."}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`import torch
import gc

def measure_attention_memory(attn_type, n_img, n_txt, d_model):
    """Measure peak memory for attention computation."""
    torch.cuda.reset_peak_memory_stats()
    gc.collect()
    torch.cuda.empty_cache()
    
    img = torch.randn(1, n_img, d_model, device='cuda')
    txt = torch.randn(1, n_txt, d_model, device='cuda')
    
    if attn_type == 'joint':
        # TODO: Implement joint attention
        # joint = torch.cat([img, txt], dim=1)
        # attn = F.scaled_dot_product_attention(joint, joint, joint)
        pass
    else:
        # TODO: Implement cross attention
        # cross = F.scaled_dot_product_attention(img, txt, txt)
        # self_attn = F.scaled_dot_product_attention(img, img, img)
        pass
    
    peak_mem = torch.cuda.max_memory_allocated() / 1e6  # MB
    return peak_mem

# Test different sequence lengths
results = []
for n_img in [256, 1024, 4096]:
    n_txt = 77
    d_model = 1536
    
    # joint_mem = measure_attention_memory('joint', n_img, n_txt, d_model)
    # cross_mem = measure_attention_memory('cross', n_img, n_txt, d_model)
    # results.append((n_img, joint_mem, cross_mem))
    
# TODO: Plot results showing memory scaling`})}),e.jsx("div",{className:"mt-4 p-4 bg-blue-500/10 rounded-xl border border-blue-500/30",children:e.jsxs("p",{className:"text-sm text-blue-300",children:[e.jsx("strong",{children:"Goal:"})," Understand the quadratic memory scaling of joint attention."]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-rose-600 flex items-center justify-center text-sm",children:"4"}),"Extract Real Attention from SD3"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Hook into SD3's MM-DiT to visualize real attention patterns."}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm overflow-x-auto",children:e.jsx("pre",{className:"text-gray-300",children:`from diffusers import StableDiffusion3Pipeline
from diffusers.models.attention_processor import Attention
import torch

# Storage for attention maps
attention_maps = {}

def create_attention_hook(name):
    def hook(module, input, output):
        # The attention module computes attention internally
        # We need to capture the attention weights before softmax
        # This requires modifying the attention processor
        pass
    return hook

def register_hooks(pipe):
    """Register hooks on all attention layers."""
    for name, module in pipe.transformer.named_modules():
        if isinstance(module, Attention):
            module.register_forward_hook(create_attention_hook(name))

# pipe = StableDiffusion3Pipeline.from_pretrained(...)
# register_hooks(pipe)

# Run inference
# image = pipe("a cat on the beach", num_inference_steps=1)

# TODO: Analyze attention_maps
# - Which text tokens get highest attention from image regions?
# - How does attention change across layers?
# - Do certain image regions specialize for certain words?`})}),e.jsx("div",{className:"mt-4 p-4 bg-rose-500/10 rounded-xl border border-rose-500/30",children:e.jsxs("p",{className:"text-sm text-rose-300",children:[e.jsx("strong",{children:"Goal:"})," See how SD3 actually uses joint attention during generation."]})})]})]}):e.jsx("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"w-20 h-20 mx-auto mb-6 text-yellow-400"}),e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Quiz Complete!"}),e.jsxs("p",{className:"text-4xl font-bold text-violet-400 mb-4",children:[n," / ",a.length]}),e.jsx("p",{className:"text-gray-400 mb-6",children:n===a.length?"Perfect! You've mastered joint attention!":n>=a.length*.7?"Great job! You understand the core concepts.":"Keep learning! Review the panels and try again."}),e.jsxs("button",{onClick:i,className:"px-6 py-3 bg-violet-600 hover:bg-violet-500 rounded-xl transition-colors flex items-center gap-2 mx-auto",children:[e.jsx(w,{size:18}),"Retry Quiz"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("span",{className:"text-gray-400",children:["Question ",t+1," of ",a.length]}),e.jsxs("span",{className:"text-violet-400",children:["Score: ",n]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 mb-8",children:e.jsx("div",{className:"bg-gradient-to-r from-violet-500 to-fuchsia-500 h-2 rounded-full transition-all",style:{width:`${(t+1)/a.length*100}%`}})}),e.jsx("h3",{className:"text-xl font-bold mb-6",children:a[t].question}),e.jsx("div",{className:"space-y-3",children:a[t].options.map((f,u)=>e.jsx("button",{onClick:()=>!r&&g(u),disabled:r,className:`w-full p-4 rounded-xl text-left transition-all ${r?u===a[t].correct?"bg-green-500/30 border-green-500":u===o?"bg-red-500/30 border-red-500":"bg-white/5 border-white/10":"bg-white/10 border-white/20 hover:bg-white/20"} border`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-white/10 flex items-center justify-center font-bold",children:String.fromCharCode(65+u)}),e.jsx("span",{children:f}),r&&u===a[t].correct&&e.jsx(B,{className:"ml-auto text-green-400",size:20}),r&&u===o&&u!==a[t].correct&&e.jsx(L,{className:"ml-auto text-red-400",size:20})]})},u))}),r&&e.jsx("div",{className:"mt-6 p-4 rounded-xl bg-violet-500/20 border border-violet-500/30",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-bold text-violet-300",children:"Explanation:"})," ",a[t].explanation]})}),r&&e.jsx("button",{onClick:j,className:"mt-6 px-6 py-3 bg-violet-600 hover:bg-violet-500 rounded-xl transition-colors",children:t<a.length-1?"Next Question":"See Results"})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-violet-900/30 to-fuchsia-900/30 rounded-2xl p-6 border border-violet-500/30",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Key Takeaways"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-400 mt-2"}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("strong",{children:"Joint attention"})," concatenates image and text tokens, then applies self-attention"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-fuchsia-400 mt-2"}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("strong",{children:"Bidirectional flow"})," allows text to see and adapt to the forming image"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400 mt-2"}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("strong",{children:"Quadratic complexity"})," O((N_img + N_txt)Â²) is the cost of full interaction"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 mt-2"}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("strong",{children:"Flash Attention"})," makes joint attention practical at scale"]})]})]})]})]})}const T=[{id:"overview",label:"1. Why Joint?",icon:Q},{id:"concat",label:"2. Token Concatenation",icon:A},{id:"flow",label:"3. Attention Flow",icon:$},{id:"bidirectional",label:"4. Bidirectional Fusion",icon:E},{id:"computation",label:"5. Computation",icon:C},{id:"practice",label:"6. Practice Lab",icon:W}];function xe(){const[t,h]=c.useState("overview"),o=()=>{switch(t){case"overview":return e.jsx(k,{});case"concat":return e.jsx(G,{});case"flow":return e.jsx(U,{});case"bidirectional":return e.jsx(X,{});case"computation":return e.jsx(H,{});case"practice":return e.jsx(J,{});default:return e.jsx(k,{})}};return e.jsxs("div",{className:"text-white",children:[e.jsx("nav",{className:"bg-black/20 px-6 py-2 flex gap-2 overflow-x-auto",children:T.map((x,r)=>{const s=x.icon,n=t===x.id,l=T.findIndex(d=>d.id===t),p=r<l;return e.jsxs("button",{onClick:()=>h(x.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap ${n?"bg-gradient-to-r from-violet-600 to-fuchsia-600 text-white":p?"bg-violet-500/30 text-violet-300":"bg-white/5 text-gray-400 hover:bg-white/10"}`,children:[e.jsx(s,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:x.label})]},x.id)})}),e.jsx("main",{className:"p-6 max-w-7xl mx-auto",children:o()})]})}export{xe as default};
