import{r as n,j as e,m as y}from"./index-quAWpIA7.js";import{E as N}from"./eye-DVCcmZwk.js";import{m as c}from"./proxy-D7LjGbFl.js";function A(){const[t,m]=n.useState(2),[a,h]=n.useState(5),[l,g]=n.useState(64),[i,u]=n.useState(!0),p=1e4,j=n.useMemo(()=>{const s=l/2;return Array.from({length:Math.min(s,8)},(d,x)=>{const r=Math.pow(p,-2*x/l),f=t*r,b=a*r,v=(t-a)*r;return{pair:x,theta:r,queryAngle:f*180/Math.PI%360,keyAngle:b*180/Math.PI%360,relativeAngle:v*180/Math.PI%360}})},[t,a,l]),o=t-a;return e.jsx("div",{className:"p-8 h-full overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-violet-600 dark:text-violet-400 mb-4",children:"RoPE Rotation Explorer"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"See how query and key positions translate to rotations, and how relative position emerges."})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700 mb-8",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm font-medium mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Query Position (m)"}),e.jsx("span",{className:"font-mono text-violet-600",children:t})]}),e.jsx("input",{type:"range",min:"0",max:"15",value:t,onChange:s=>m(parseInt(s.target.value)),className:"w-full accent-violet-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm font-medium mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Key Position (n)"}),e.jsx("span",{className:"font-mono text-fuchsia-600",children:a})]}),e.jsx("input",{type:"range",min:"0",max:"15",value:a,onChange:s=>h(parseInt(s.target.value)),className:"w-full accent-fuchsia-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm font-medium mb-2 dark:text-slate-300",children:[e.jsx("span",{children:"Embedding Dim"}),e.jsx("span",{className:"font-mono text-slate-600",children:l})]}),e.jsx("input",{type:"range",min:"16",max:"128",step:"16",value:l,onChange:s=>g(parseInt(s.target.value)),className:"w-full accent-slate-500"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-4",children:[e.jsx("div",{className:"bg-violet-100 dark:bg-violet-900/30 px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-sm text-violet-600 dark:text-violet-400",children:["m = ",t]})}),e.jsx("span",{className:"text-slate-400",children:"-"}),e.jsx("div",{className:"bg-fuchsia-100 dark:bg-fuchsia-900/30 px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-sm text-fuchsia-600 dark:text-fuchsia-400",children:["n = ",a]})}),e.jsx("span",{className:"text-slate-400",children:"="}),e.jsxs("div",{className:`px-4 py-2 rounded-lg font-bold ${o>0?"bg-green-100 dark:bg-green-900/30 text-green-600":o<0?"bg-red-100 dark:bg-red-900/30 text-red-600":"bg-slate-100 dark:bg-slate-700 text-slate-600"}`,children:["Δ = ",o]})]})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("button",{onClick:()=>u(!i),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${i?"bg-violet-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:[e.jsx(N,{size:18}),i?"Showing Relative Rotation":"Showing Absolute Rotations"]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:j.map((s,d)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-xs text-slate-500 mb-2 text-center",children:["Pair ",s.pair,": d",e.jsx("sub",{children:s.pair*2}),", d",e.jsx("sub",{children:s.pair*2+1})]}),e.jsx("div",{className:"relative w-full aspect-square max-w-[100px] mx-auto",children:e.jsxs("svg",{viewBox:"-55 -55 110 110",className:"w-full h-full",children:[e.jsx("circle",{cx:"0",cy:"0",r:"40",fill:"none",stroke:"currentColor",strokeOpacity:"0.1"}),i?e.jsxs(c.g,{animate:{rotate:s.relativeAngle},transition:{type:"spring",stiffness:80},children:[e.jsx("line",{x1:"0",y1:"0",x2:"40",y2:"0",stroke:"#10b981",strokeWidth:"3"}),e.jsx("circle",{cx:"40",cy:"0",r:"4",fill:"#10b981"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(c.g,{animate:{rotate:s.queryAngle},transition:{type:"spring",stiffness:80},children:[e.jsx("line",{x1:"0",y1:"0",x2:"40",y2:"0",stroke:"#8b5cf6",strokeWidth:"2"}),e.jsx("circle",{cx:"40",cy:"0",r:"3",fill:"#8b5cf6"})]}),e.jsxs(c.g,{animate:{rotate:s.keyAngle},transition:{type:"spring",stiffness:80},children:[e.jsx("line",{x1:"0",y1:"0",x2:"35",y2:"0",stroke:"#d946ef",strokeWidth:"2",strokeDasharray:"4,2"}),e.jsx("circle",{cx:"35",cy:"0",r:"3",fill:"#d946ef"})]})]})]})}),e.jsx("div",{className:"text-center mt-2",children:i?e.jsxs("div",{className:"text-xs font-mono text-green-600",children:["Δθ = ",s.relativeAngle.toFixed(1),"°"]}):e.jsxs("div",{className:"text-xs font-mono",children:[e.jsxs("span",{className:"text-violet-600",children:["Q: ",s.queryAngle.toFixed(1),"°"]}),e.jsx("span",{className:"text-slate-400 mx-1",children:"|"}),e.jsxs("span",{className:"text-fuchsia-600",children:["K: ",s.keyAngle.toFixed(1),"°"]})]})})]},d))}),e.jsx("div",{className:"bg-gradient-to-r from-violet-500 to-fuchsia-500 rounded-2xl p-6 text-white",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(y,{size:32,className:"flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-2",children:"The Key Insight"}),e.jsxs("p",{className:"text-violet-100",children:["Notice how each dimension pair rotates at a different speed. Low-indexed pairs rotate fast (capturing local patterns), while high-indexed pairs rotate slowly (capturing global/long-range patterns). This is similar to how different frequencies in sinusoidal encoding work, but with the added benefit of ",e.jsx("strong",{children:"naturally encoding relative positions"})," through the dot product."]})]})]})})]})})}export{A as default};
