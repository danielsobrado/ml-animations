import{c as u,r as d,j as e,L as j}from"./index-BmgLEcVh.js";import{P as b}from"./pause-Pw5n6zyp.js";import{P as f}from"./play-4PCPORJF.js";import{R as N}from"./rotate-ccw-DnC3UZWM.js";import{P as v}from"./plus-DlRXu2OK.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=u("Equal",[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}]]);function A(){const[n,o]=d.useState(!1),[r,x]=d.useState(0),[t,m]=d.useState(8),h=d.useRef(null),s=768,a=768,i=[{title:"Original Weight Matrix W",desc:`The original frozen weight matrix has shape ${s}×${a} = ${(s*a).toLocaleString()} parameters`},{title:"Low-Rank Decomposition",desc:`Instead of updating W directly, we learn two small matrices A (${s}×${t}) and B (${t}×${a})`},{title:"Compute ΔW = BA",desc:`The product BA has the same shape as W, but only requires ${s*t+t*a} = ${(s*t+t*a).toLocaleString()} parameters!`},{title:"Final Output: W + ΔW",desc:"During inference, we add the learned adaptation to the frozen weights. Can be merged for zero latency!"}];d.useEffect(()=>{if(n&&r<i.length-1){const c=setTimeout(()=>x(l=>l+1),2500);return()=>clearTimeout(c)}else r>=i.length-1&&o(!1)},[n,r]);const p=()=>{x(0),o(!1)},g=((s*a-(s*t+t*a))/(s*a)*100).toFixed(1);return e.jsxs("div",{className:"p-6 h-full overflow-y-auto",children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-900 mb-2",children:"LoRA: Low-Rank Adaptation"}),e.jsx("p",{className:"text-slate-600",children:"Freeze the base model, learn small rank-decomposed matrices"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>o(!n),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600",children:[n?e.jsx(b,{size:18}):e.jsx(f,{size:18}),n?"Pause":"Play"]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300",children:[e.jsx(N,{size:18}),"Reset"]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Rank (r):"}),e.jsxs("select",{value:t,onChange:c=>m(Number(c.target.value)),className:"px-3 py-1 border rounded bg-white",children:[e.jsx("option",{value:4,children:"4"}),e.jsx("option",{value:8,children:"8"}),e.jsx("option",{value:16,children:"16"}),e.jsx("option",{value:32,children:"32"}),e.jsx("option",{value:64,children:"64"})]})]})]}),e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:i.map((c,l)=>e.jsx("button",{onClick:()=>x(l),className:`px-3 py-1 rounded-full text-sm transition-all ${l===r?"bg-purple-500 text-white":l<r?"bg-green-100 text-green-700":"bg-slate-200 text-slate-500"}`,children:l+1},l))}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 mb-6 text-center border border-purple-200",children:[e.jsx("h3",{className:"font-bold text-purple-800 mb-1",children:i[r].title}),e.jsx("p",{className:"text-purple-700 text-sm",children:i[r].desc})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border shadow-sm mb-6",ref:h,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 flex-wrap",children:[e.jsxs("div",{className:`transition-all ${r>0?"opacity-50":""}`,children:[e.jsx("div",{className:"text-center mb-2 font-bold text-slate-700",children:"W (frozen)"}),e.jsx("div",{className:"bg-gradient-to-br from-blue-200 to-blue-400 rounded-lg flex items-center justify-center",style:{width:120,height:120},children:e.jsxs("span",{className:"text-blue-800 font-mono text-xs",children:[s,"×",a]})}),e.jsxs("div",{className:"text-center mt-1 text-xs text-slate-500",children:[(s*a).toLocaleString()," params"]})]}),r>=1&&e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"text-slate-400",size:24}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{className:"text-center mb-2 font-bold text-green-700",children:"B"}),e.jsx("div",{className:"bg-gradient-to-br from-green-200 to-green-400 rounded-lg flex items-center justify-center",style:{width:120,height:30+t*2},children:e.jsxs("span",{className:"text-green-800 font-mono text-xs",children:[s,"×",t]})}),e.jsxs("div",{className:"text-center mt-1 text-xs text-green-600",children:[(s*t).toLocaleString()," params"]})]}),e.jsx("span",{className:"text-slate-400 font-bold",children:"×"}),e.jsxs("div",{className:"animate-fadeIn",style:{animationDelay:"200ms"},children:[e.jsx("div",{className:"text-center mb-2 font-bold text-orange-700",children:"A"}),e.jsx("div",{className:"bg-gradient-to-br from-orange-200 to-orange-400 rounded-lg flex items-center justify-center",style:{width:30+t*2,height:120},children:e.jsxs("span",{className:"text-orange-800 font-mono text-xs",children:[t,"×",a]})}),e.jsxs("div",{className:"text-center mt-1 text-xs text-orange-600",children:[(t*a).toLocaleString()," params"]})]})]})]}),r>=2&&e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"text-slate-400",size:24}),e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{className:"text-center mb-2 font-bold text-purple-700",children:"ΔW"}),e.jsx("div",{className:"bg-gradient-to-br from-purple-200 to-purple-400 rounded-lg flex items-center justify-center border-2 border-purple-500 border-dashed",style:{width:120,height:120},children:e.jsxs("span",{className:"text-purple-800 font-mono text-xs",children:[s,"×",a]})}),e.jsx("div",{className:"text-center mt-1 text-xs text-purple-600",children:"Low-rank update"})]})]})]}),r>=3&&e.jsx("div",{className:"mt-6 p-4 bg-green-50 rounded-lg border border-green-200 animate-fadeIn",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-800 mb-2",children:"h = W·x + ΔW·x = W·x + B·A·x"}),e.jsx("p",{className:"text-sm text-green-700",children:"The output combines the frozen pretrained knowledge with task-specific adaptation!"})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(s*a).toLocaleString()}),e.jsx("div",{className:"text-sm text-blue-700",children:"Original Params"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(s*t+t*a).toLocaleString()}),e.jsxs("div",{className:"text-sm text-green-700",children:["LoRA Params (r=",t,")"]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[g,"%"]}),e.jsx("div",{className:"text-sm text-purple-700",children:"Reduction"})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 mb-6 text-center",children:[e.jsx("div",{className:"text-slate-400 text-sm mb-2",children:"The LoRA Formula"}),e.jsx("div",{className:"text-white font-mono text-xl",children:"W' = W + α · BA"}),e.jsx("div",{className:"text-slate-400 text-sm mt-2",children:"where α is a scaling factor (typically α/r)"})]}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-200",children:[e.jsxs("h4",{className:"font-bold text-amber-900 mb-2 flex items-center gap-2",children:[e.jsx(j,{size:18}),"Practical Tips"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-amber-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Rank Selection:"})," Start with r=8 or r=16. Higher rank = more capacity but more params."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Which Layers:"})," Usually apply LoRA to attention weights (Q, K, V projections)."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Initialization:"})," A initialized with small random values, B initialized to zero."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Merging:"})," After training, LoRA weights can be merged into base model for fast inference."]})]})]})]}),e.jsx("style",{jsx:!0,children:`
                @keyframes fadeIn {
                    from { opacity: 0; transform: scale(0.9); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-fadeIn {
                    animation: fadeIn 0.4s ease-out forwards;
                }
            `})]})}export{A as default};
