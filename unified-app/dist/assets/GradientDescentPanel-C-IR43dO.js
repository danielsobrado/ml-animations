import{r as o,j as n}from"./index-BmgLEcVh.js";import{S as D,C as T,m as V,W as q,B as W,o as H,w as J,x as K,c as Q,d as U,V as X}from"./three.module-DCYoyzkr.js";import{g as Y}from"./index-CH_iu5NA.js";const N={curve:7352480,ball:6003669,bg:16777215};function ee({learningRate:L=.1,startWeight:d=4,onStepChange:p}){const u=o.useRef(null),S=o.useRef(null),P=o.useRef(null),g=o.useRef({}),[m,C]=o.useState(!1),[a,b]=o.useState(d??4),[R,x]=o.useState(0);o.useEffect(()=>{b(d??4),x(0)},[d]),o.useEffect(()=>{if(p&&a!=null){const e=a*a;p(R,a,e)}},[R,a,p]),o.useEffect(()=>{if(!u.current)return;const e=u.current.clientWidth,c=400,s=new D;s.background=new T(N.bg),P.current=s;const l=new V(e/-2,e/2,c/2,c/-2,.1,1e3);l.position.z=100;const t=new q({antialias:!0});t.setSize(e,c),u.current.appendChild(t.domElement),S.current=t;const r=[],w=5,h=50;for(let i=-w;i<=w;i+=.1){const O=i*i,z=i*h,A=-O*10+100;r.push(new X(z,A,0))}const y=new W().setFromPoints(r),j=new H({color:N.curve,linewidth:3}),f=new J(y,j);s.add(f);const F=new K(8,32),I=new Q({color:N.ball}),E=new U(F,I);s.add(E),g.current={ball:E,scene:s,scale:h},v(d??4);let M;const G=()=>{M=requestAnimationFrame(G),t.render(s,l)};return G(),()=>{var i;cancelAnimationFrame(M),t.dispose(),(i=u.current)!=null&&i.contains(t.domElement)&&u.current.removeChild(t.domElement)}},[]);const v=e=>{const{ball:c,scale:s}=g.current;if(!c||e==null)return;const l=e*e,t=e*s,r=-l*10+100;c.position.set(t,r,0)},k=async()=>{if(m)return;C(!0);let e=d??4;b(e),x(0),v(e);const c=50,s=.01;for(let l=0;l<c;l++){const t=2*e,r=e-L*t,{ball:w,scale:h}=g.current,y=r*h,j=-(r*r)*10+100;if(await new Promise(f=>{Y.to(w.position,{x:y,y:j,duration:.5,ease:"power2.inOut",onComplete:f})}),e=r,b(e),x(l+1),Math.abs(e)<s||Math.abs(e)>10)break;await new Promise(f=>setTimeout(f,200))}C(!1)},B=()=>{m||(b(d),x(0),v(d))};return n.jsxs("div",{className:"flex flex-col items-center p-3",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Loss Landscape"}),n.jsx("div",{ref:u,className:"w-full rounded-lg overflow-hidden shadow-lg bg-white"}),n.jsx("div",{className:"mt-2 p-2 bg-white rounded-lg w-full text-center shadow",children:n.jsxs("p",{className:"text-sm text-gray-800",children:["Iteration: ",n.jsx("span",{className:"font-bold",children:R})," | Weight: ",n.jsx("span",{className:"font-bold text-blue-600",children:(a??0).toFixed(3)})," | Loss: ",n.jsx("span",{className:"font-bold text-purple-600",children:((a??0)*(a??0)).toFixed(3)})]})}),n.jsxs("div",{className:"flex gap-2 mt-2",children:[n.jsx("button",{onClick:k,disabled:m,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:m?"Running...":"▶ Run"}),n.jsx("button",{onClick:B,disabled:m,className:"px-4 py-2 bg-red-500 hover:bg-red-600 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg transition-colors text-sm",children:"↺ Reset"})]})]})}export{ee as default};
