import{r as u,j as e,Z as W,m as R,S as Q,T as X,z as K,b as U,C as H,W as Y,o as V}from"./index-quAWpIA7.js";import{P as O}from"./pause-Ch50eX2B.js";import{P as L}from"./play-DgR7o5cW.js";import{I as F}from"./info-CH9TLaYi.js";import{R as G}from"./refresh-cw-BoTFdhd7.js";import{C as Z}from"./code-BC671jUr.js";import{C as J}from"./check-circle-CZEU1TAG.js";import{X as ee}from"./x-circle-D3t0USxl.js";import{C as te}from"./clock-0PPAHBZf.js";import{G as se}from"./graduation-cap-B7np-4AT.js";function A(){const[m,S]=u.useState(null),[c,w]=u.useState(!0),[g,P]=u.useState(0),x=u.useRef(null);u.useEffect(()=>{if(!c)return;const j=setInterval(()=>{P(s=>(s+1)%100)},50);return()=>clearInterval(j)},[c]),u.useEffect(()=>{const j=x.current;if(!j)return;const s=j.getContext("2d"),t=j.width,a=j.height;s.clearRect(0,0,t,a);const n=30;for(let o=n;o<t;o+=n)for(let h=n;h<a;h+=n){const r=t/2,y=a/2,i=(r-o)/t,d=(y-h)/a,N=Math.sqrt(i*i+d*d),k=15,T=i/N*k,f=d/N*k;s.beginPath(),s.moveTo(o,h),s.lineTo(o+T,h+f),s.strokeStyle=`rgba(236, 72, 153, ${.3+N*.5})`,s.lineWidth=1.5,s.stroke();const p=4,v=Math.atan2(f,T);s.beginPath(),s.moveTo(o+T,h+f),s.lineTo(o+T-p*Math.cos(v-Math.PI/6),h+f-p*Math.sin(v-Math.PI/6)),s.lineTo(o+T-p*Math.cos(v+Math.PI/6),h+f-p*Math.sin(v+Math.PI/6)),s.closePath(),s.fillStyle=`rgba(236, 72, 153, ${.3+N*.5})`,s.fill()}const M=20;for(let o=0;o<M;o++){const r=(g+o*(100/M))%100/100,y=o/M*Math.PI*2,i=t/2+Math.cos(y)*(t/2-20),d=a/2+Math.sin(y)*(a/2-20),N=t/2,k=a/2,T=i+(N-i)*r,f=d+(k-d)*r;s.beginPath(),s.arc(T,f,3,0,Math.PI*2),s.fillStyle=`rgba(139, 92, 246, ${1-r*.5})`,s.fill()}},[g]);const l={noise:{title:"Noise Distribution p₀",description:"Starting point: pure Gaussian noise. Data has no structure, just random samples from N(0, I).",color:"from-gray-500 to-slate-500",details:["z₀ ~ N(0, I)","No data structure","High entropy"]},flow:{title:"Velocity Field v_θ",description:"Neural network predicts the velocity at each point to transport noise toward data.",color:"from-fuchsia-500 to-purple-500",details:["Learned by network","Time-dependent","Defines ODE flow"]},data:{title:"Data Distribution p₁",description:"Target: the distribution of real data (images). We want to learn to generate samples from this.",color:"from-blue-500 to-cyan-500",details:["Real images","Complex structure","Low entropy"]}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Flow Matching: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"The Big Picture"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"Learning continuous probability flows from noise to data"})]}),e.jsx("div",{className:"bg-gradient-to-r from-fuchsia-900/30 to-purple-900/30 rounded-2xl p-6 border border-fuchsia-500/30",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(W,{className:"text-fuchsia-600 dark:text-fuchsia-400 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-fuchsia-300 mb-2",children:"The Core Idea"}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Instead of learning to ",e.jsx("strong",{children:"denoise"})," step by step (like DDPM), flow matching learns a",e.jsx("strong",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:" continuous velocity field"}),' that transports samples from noise to data. Think of it as learning the "current" that carries particles through probability space.']})]})]})}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-8 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"relative cursor-pointer transition-transform hover:scale-105",onMouseEnter:()=>S("noise"),onMouseLeave:()=>S(null),children:[e.jsxs("div",{className:`w-28 h-28 rounded-xl bg-gradient-to-br ${l.noise.color} flex items-center justify-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 flex flex-wrap gap-1 p-2 opacity-60",children:Array(16).fill(0).map((j,s)=>e.jsx("div",{className:"w-4 h-4 bg-white/40 rounded-sm",style:{opacity:Math.random()*.8+.2}},s))}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("p",{className:"text-lg font-bold",children:"p₀"}),e.jsx("p",{className:"text-xs opacity-80",children:"Noise"})]})]}),e.jsx("p",{className:"text-center mt-2 text-sm font-medium",children:"t = 0"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"relative cursor-pointer",onMouseEnter:()=>S("flow"),onMouseLeave:()=>S(null),children:[e.jsx("canvas",{ref:x,width:300,height:150,className:"rounded-xl bg-black/20"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"bg-black/50 px-3 py-1 rounded-lg",children:e.jsx("p",{className:"text-sm font-mono text-fuchsia-300",children:"v_θ(x_t, t)"})})})]})}),e.jsxs("div",{className:"relative cursor-pointer transition-transform hover:scale-105",onMouseEnter:()=>S("data"),onMouseLeave:()=>S(null),children:[e.jsxs("div",{className:`w-28 h-28 rounded-xl bg-gradient-to-br ${l.data.color} flex items-center justify-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-40",children:e.jsx("div",{className:"w-16 h-16 rounded-lg bg-white/50"})}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("p",{className:"text-lg font-bold",children:"p₁"}),e.jsx("p",{className:"text-xs opacity-80",children:"Data"})]})]}),e.jsx("p",{className:"text-center mt-2 text-sm font-medium",children:"t = 1"})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[e.jsxs("button",{onClick:()=>w(!c),className:"flex items-center gap-2 px-4 py-2 bg-fuchsia-600 hover:bg-fuchsia-700 rounded-lg transition-colors",children:[c?e.jsx(O,{size:18}):e.jsx(L,{size:18}),c?"Pause":"Play"]}),e.jsxs("button",{onClick:()=>P(0),className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(R,{size:18}),"Reset"]})]}),m&&e.jsx("div",{className:"mt-4 p-4 bg-white/5 rounded-xl border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"text-fuchsia-600 dark:text-fuchsia-400 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:l[m].title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:l[m].description}),e.jsx("div",{className:"flex gap-2 mt-3 flex-wrap",children:l[m].details.map((j,s)=>e.jsx("span",{className:"bg-white/10 px-2 py-1 rounded text-sm",children:j},s))})]})]})})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"The Flow ODE"}),e.jsx("div",{className:"text-center text-2xl font-mono text-fuchsia-300 mb-4",children:"dx/dt = v_θ(x_t, t)"}),e.jsx("p",{className:"text-gray-800 dark:text-center max-w-2xl mx-auto",children:"Starting from x₀ ~ N(0, I), we integrate this ODE from t=0 to t=1 to get x₁ ~ p_data. The network v_θ learns the velocity field that makes this transformation happen."})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-fuchsia-900/30 to-fuchsia-800/20 rounded-xl p-5 border border-fuchsia-500/30",children:[e.jsxs("h3",{className:"font-bold text-fuchsia-300 mb-2 flex items-center gap-2",children:[e.jsx(W,{size:18}),' Why "Flow"?']}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:'Inspired by physics: particles flow through a velocity field. Here, probability mass "flows" from the noise distribution to the data distribution along learned paths.'})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-purple-800/20 rounded-xl p-5 border border-purple-500/30",children:[e.jsxs("h3",{className:"font-bold text-purple-300 mb-2 flex items-center gap-2",children:[e.jsx(Q,{size:18})," vs DDPM"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"DDPM predicts noise ε to be removed. Flow matching predicts velocity v directly. Both achieve similar results, but flow matching has simpler training objectives."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-blue-800/20 rounded-xl p-5 border border-blue-500/30",children:[e.jsxs("h3",{className:"font-bold text-blue-300 mb-2 flex items-center gap-2",children:[e.jsx(X,{size:18})," SD3's Choice"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Stable Diffusion 3 uses flow matching because it enables more flexible noise schedules and often converges faster with fewer sampling steps."})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"Flow Matching vs Score Matching (DDPM)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Aspect"}),e.jsx("th",{className:"py-3 px-4 text-left text-fuchsia-600 dark:text-fuchsia-400",children:"Flow Matching"}),e.jsx("th",{className:"py-3 px-4 text-left text-blue-600 dark:text-blue-400",children:"Score Matching (DDPM)"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:"Network predicts"}),e.jsx("td",{className:"py-3 px-4",children:"Velocity v_θ(x_t, t)"}),e.jsx("td",{className:"py-3 px-4",children:"Noise ε_θ(x_t, t)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:"Training objective"}),e.jsx("td",{className:"py-3 px-4",children:"MSE on velocity"}),e.jsx("td",{className:"py-3 px-4",children:"MSE on noise"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:"Interpolation path"}),e.jsx("td",{className:"py-3 px-4",children:"Linear: x_t = (1-t)x₀ + tx₁"}),e.jsx("td",{className:"py-3 px-4",children:"Gaussian: x_t = √ᾱ_t x₀ + √(1-ᾱ_t) ε"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:"Sampling"}),e.jsx("td",{className:"py-3 px-4",children:"ODE solver (Euler, Heun)"}),e.jsx("td",{className:"py-3 px-4",children:"SDE/ODE (DDPM, DDIM)"})]})]})]})})]})]})}function ae(){const[m,S]=u.useState(!1),[c,w]=u.useState(0),[g,P]=u.useState("linear"),x=u.useRef(null),l={linear:{name:"Linear (Optimal Transport)",formula:"x_t = (1-t)·x₀ + t·x₁",description:"Straight-line interpolation from noise to data. Simple and efficient.",color:"#ec4899"},cosine:{name:"Cosine Schedule",formula:"x_t = cos²(πt/2)·x₀ + sin²(πt/2)·x₁",description:"Smoother transition, spending more time near data distribution.",color:"#8b5cf6"},variance:{name:"Variance Preserving",formula:"x_t = √(1-σ²_t)·x₁ + σ_t·x₀",description:"Maintains unit variance throughout, similar to DDPM.",color:"#3b82f6"}};u.useEffect(()=>{if(!m)return;const s=setInterval(()=>{w(t=>t>=1?(S(!1),1):t+.02)},50);return()=>clearInterval(s)},[m]),u.useEffect(()=>{const s=x.current;if(!s)return;const t=s.getContext("2d"),a=s.width,n=s.height;t.clearRect(0,0,a,n),t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=1;for(let r=0;r<=a;r+=40)t.beginPath(),t.moveTo(r,0),t.lineTo(r,n),t.stroke();for(let r=0;r<=n;r+=40)t.beginPath(),t.moveTo(0,r),t.lineTo(a,r),t.stroke();const M=[{x:80,y:80},{x:60,y:200},{x:100,y:280},{x:40,y:160}],o=[{x:520,y:120},{x:500,y:200},{x:540,y:260},{x:480,y:180}],h=(r,y,i)=>{if(g==="linear")return(1-i)*r+i*y;if(g==="cosine"){const d=Math.cos(Math.PI*i/2)**2,N=Math.sin(Math.PI*i/2)**2;return d*r+N*y}else{const d=1-i;return Math.sqrt(1-d*d)*y+d*r}};M.forEach((r,y)=>{const i=o[y],d=l[g].color;t.beginPath(),t.moveTo(r.x,r.y);for(let b=0;b<=1;b+=.05){const _=h(r.x,i.x,b),E=h(r.y,i.y,b);t.lineTo(_,E)}if(t.strokeStyle=`${d}40`,t.lineWidth=2,t.stroke(),c>0){t.beginPath(),t.moveTo(r.x,r.y);for(let b=0;b<=c;b+=.05){const _=h(r.x,i.x,b),E=h(r.y,i.y,b);t.lineTo(_,E)}t.strokeStyle=d,t.lineWidth=3,t.stroke()}t.beginPath(),t.arc(r.x,r.y,8,0,Math.PI*2),t.fillStyle="rgba(100, 100, 100, 0.8)",t.fill(),t.strokeStyle="white",t.lineWidth=2,t.stroke(),t.beginPath(),t.arc(i.x,i.y,8,0,Math.PI*2),t.fillStyle=d,t.fill(),t.strokeStyle="white",t.lineWidth=2,t.stroke();const N=h(r.x,i.x,c),k=h(r.y,i.y,c);t.beginPath(),t.arc(N,k,10,0,Math.PI*2),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(N,k,6,0,Math.PI*2),t.fillStyle=d,t.fill();const T=.01,f=h(r.x,i.x,Math.min(c+T,1)),p=h(r.y,i.y,Math.min(c+T,1)),v=(f-N)/T*.3,C=(p-k)/T*.3;if(c<.99){t.beginPath(),t.moveTo(N,k),t.lineTo(N+v,k+C),t.strokeStyle="#fbbf24",t.lineWidth=3,t.stroke();const b=Math.atan2(C,v);t.beginPath(),t.moveTo(N+v,k+C),t.lineTo(N+v-8*Math.cos(b-.4),k+C-8*Math.sin(b-.4)),t.lineTo(N+v-8*Math.cos(b+.4),k+C-8*Math.sin(b+.4)),t.closePath(),t.fillStyle="#fbbf24",t.fill()}}),t.fillStyle="rgba(255, 255, 255, 0.7)",t.font="14px sans-serif",t.fillText("Noise (t=0)",20,40),t.fillText("Data (t=1)",480,40),t.fillText(`t = ${c.toFixed(2)}`,a/2-30,40)},[c,g]);const j=()=>{w(0),S(!1)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["The Flow: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"Probability Transport"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"Watch samples flow from noise to data along learned paths"})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("canvas",{ref:x,width:600,height:340,className:"w-full rounded-xl bg-black/30 mb-4"}),e.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[e.jsxs("button",{onClick:()=>S(!m),className:"flex items-center gap-2 px-4 py-2 bg-fuchsia-600 hover:bg-fuchsia-700 rounded-lg transition-colors",children:[m?e.jsx(O,{size:18}):e.jsx(L,{size:18}),m?"Pause":"Play"]}),e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(R,{size:18}),"Reset"]})]}),e.jsxs("div",{className:"flex items-center gap-4 px-4",children:[e.jsx("span",{className:"text-sm text-gray-800 dark:text-gray-400 w-12",children:"t = 0"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c,onChange:s=>{w(parseFloat(s.target.value)),S(!1)},className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"}),e.jsx("span",{className:"text-sm text-gray-800 dark:text-gray-400 w-12",children:"t = 1"})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose Interpolation Path"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Object.entries(l).map(([s,t])=>e.jsxs("button",{onClick:()=>P(s),className:`p-4 rounded-xl border transition-all text-left ${g===s?"border-fuchsia-500 bg-fuchsia-500/20":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"font-bold",children:t.name})]}),e.jsx("code",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:t.formula}),e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-500",children:t.description})]},s))})]}),e.jsxs("div",{className:"bg-gradient-to-r from-fuchsia-900/30 to-purple-900/30 rounded-2xl p-6 border border-fuchsia-500/30",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(F,{size:20,className:"text-fuchsia-600 dark:text-fuchsia-400"}),"Conditional Flow Matching (CFM)"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-2",children:"The Training Trick"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:"We can't compute the true marginal velocity field v(x_t, t) directly. Instead, we condition on individual pairs (x₀, x₁) and learn the conditional velocity:"}),e.jsx("div",{className:"bg-black/30 rounded-lg p-3 font-mono text-center text-fuchsia-300",children:"v_θ(x_t, t) ≈ (x₁ - x₀)"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-2",children:"Training Algorithm"}),e.jsxs("ol",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:"Sample x₀ ~ N(0, I) (noise)"}),e.jsx("li",{children:"Sample x₁ ~ p_data (real data)"}),e.jsx("li",{children:"Sample t ~ U(0, 1)"}),e.jsx("li",{children:"Compute x_t = (1-t)x₀ + tx₁"}),e.jsx("li",{children:"Target velocity: v* = x₁ - x₀"}),e.jsx("li",{children:"Loss: ||v_θ(x_t, t) - v*||²"})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Why This Works: Intuition"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-fuchsia-600 rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:"Straight Paths Are Simple"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"Linear interpolation x_t = (1-t)x₀ + tx₁ creates the simplest possible path. The velocity is constant: v = x₁ - x₀."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:"Network Learns Average"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"At each (x_t, t), multiple flows pass through. The network learns the average velocity direction, which transports probability mass correctly."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:"Consistent Velocity Field"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:'Even though we train on random pairs, the learned velocity field becomes consistent - it always points "toward" the data distribution.'})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center text-sm font-bold",children:"4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:"ODE Solver Follows"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"At generation time, we start from noise and use an ODE solver (Euler, Heun) to follow the learned velocity field until we reach the data."})]})]})]})]})]})]})}function le(){const[m,S]=u.useState(!1),[c,w]=u.useState(0),[g,P]=u.useState(10),[x,l]=u.useState("euler"),j=u.useRef(null),s={euler:{name:"Euler (1st Order)",formula:"x_{t+Δt} = x_t + Δt · v_θ(x_t, t)",description:"Simplest ODE solver. Takes one velocity evaluation per step.",color:"#ec4899",order:1},heun:{name:"Heun (2nd Order)",formula:"x̃ = x_t + Δt·v(x_t, t); x_{t+Δt} = x_t + Δt/2·(v(x_t, t) + v(x̃, t+Δt))",description:"Predictor-corrector method. More accurate but needs 2 evaluations.",color:"#8b5cf6",order:2}};return u.useEffect(()=>{if(!m)return;const t=setInterval(()=>{w(a=>a>=g?(S(!1),g):a+1)},800);return()=>clearInterval(t)},[m,g]),u.useEffect(()=>{const t=j.current;if(!t)return;const a=t.getContext("2d"),n=t.width,M=t.height;a.clearRect(0,0,n,M),a.fillStyle="rgba(0, 0, 0, 0.2)",a.fillRect(0,0,n,M);const o=p=>{const v=60+p*(n-120),C=M/2+Math.sin(p*Math.PI*2)*60-p*40;return{x:v,y:C}};a.beginPath(),a.moveTo(o(0).x,o(0).y);for(let p=0;p<=1;p+=.02){const v=o(p);a.lineTo(v.x,v.y)}a.strokeStyle="rgba(255, 255, 255, 0.3)",a.lineWidth=2,a.setLineDash([5,5]),a.stroke(),a.setLineDash([]);const h=1/g,r=Math.min(c,g);let y=o(0).x,i=o(0).y;const d=[{x:y,y:i,t:0}];for(let p=0;p<r;p++){const v=p/g,C=(p+1)/g,b=o(v),_=o(v+.01),E=(_.x-b.x)/.01,I=(_.y-b.y)/.01,z=h/.01;y+=E*z*.8,i+=I*z*.8,d.push({x:y,y:i,t:C})}let N=o(0).x,k=o(0).y;const T=[{x:N,y:k,t:0}];for(let p=0;p<r;p++){const v=p/g,C=o(v),b=o(v+.01),_=(b.x-C.x)/.01,E=(b.y-C.y)/.01,I=(p+1)/g,z=o(I),q=o(I+.01),$=(q.x-z.x)/.01,B=(q.y-z.y)/.01;N+=(_+$)/2*h/.01*.95,k+=(E+B)/2*h/.01*.95,T.push({x:N,y:k,t:I})}const f=(p,v,C)=>{if(!(p.length<2)){a.beginPath(),a.moveTo(p[0].x,p[0].y);for(let b=1;b<p.length;b++)a.lineTo(p[b].x,p[b].y);a.strokeStyle=C?v:`${v}60`,a.lineWidth=C?3:2,a.stroke(),p.forEach((b,_)=>{a.beginPath(),a.arc(b.x,b.y,C?6:4,0,Math.PI*2),a.fillStyle=C?v:`${v}80`,a.fill(),C&&_>0&&(a.fillStyle="white",a.font="10px sans-serif",a.fillText(_.toString(),b.x+8,b.y-8))})}};x==="euler"?(f(T,s.heun.color,!1),f(d,s.euler.color,!0)):(f(d,s.euler.color,!1),f(T,s.heun.color,!0)),a.fillStyle="rgba(255, 255, 255, 0.7)",a.font="12px sans-serif",a.fillText("Start (t=0)",40,M-20),a.fillText("End (t=1)",n-80,M-20),a.fillText("True path",20,30),a.fillStyle="rgba(255, 255, 255, 0.4)",a.fillText("(dashed)",80,30),a.fillStyle=s.euler.color,a.fillRect(n-150,20,12,12),a.fillStyle="white",a.fillText("Euler",n-130,30),a.fillStyle=s.heun.color,a.fillRect(n-150,40,12,12),a.fillStyle="white",a.fillText("Heun",n-130,50)},[c,g,x]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Euler Scheduler: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"ODE Solvers"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"Numerical methods to follow the velocity field from noise to data"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:Object.entries(s).map(([t,a])=>e.jsxs("button",{onClick:()=>l(t),className:`p-4 rounded-xl border transition-all text-left ${x===t?"border-fuchsia-500 bg-fuchsia-500/20":"border-white/10 bg-black/30 hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:a.color}}),e.jsx("span",{className:"font-bold",children:a.name}),e.jsxs("span",{className:"text-xs bg-white/10 px-2 py-0.5 rounded",children:["Order ",a.order]})]}),e.jsx("p",{className:"text-xs text-gray-800 dark:text-gray-400 mb-2",children:a.description}),e.jsx("code",{className:"text-xs text-gray-700 dark:text-gray-500 block overflow-x-auto",children:a.formula})]},t))}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("canvas",{ref:j,width:700,height:300,className:"w-full rounded-xl mb-4"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-4",children:[e.jsxs("button",{onClick:()=>S(!m),className:"flex items-center gap-2 px-4 py-2 bg-fuchsia-600 hover:bg-fuchsia-700 rounded-lg transition-colors",children:[m?e.jsx(O,{size:18}):e.jsx(L,{size:18}),m?"Pause":"Run Steps"]}),e.jsxs("button",{onClick:()=>{w(0),S(!1)},className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(R,{size:18}),"Reset"]}),e.jsxs("button",{onClick:()=>w(t=>Math.min(t+1,g)),disabled:c>=g,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(K,{size:18}),"Single Step"]})]}),e.jsxs("div",{className:"flex items-center gap-4 px-4",children:[e.jsxs("span",{className:"text-sm text-gray-800 dark:text-gray-400 w-20",children:["Steps: ",g]}),e.jsx("input",{type:"range",min:"4",max:"30",step:"1",value:g,onChange:t=>{P(parseInt(t.target.value)),w(0),S(!1)},className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{className:"text-center mt-4 text-lg",children:["Step ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400 font-bold",children:c})," / ",g]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-fuchsia-900/30 to-purple-900/30 rounded-2xl p-6 border border-fuchsia-500/30",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(F,{size:20,className:"text-fuchsia-600 dark:text-fuchsia-400"}),"Euler Method Deep Dive"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-3",children:"The Algorithm"}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-4 font-mono text-sm space-y-2",children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"# Initialize"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"x"})," = sample_noise()"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"dt"})," = 1.0 / num_steps"]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mt-2",children:"# Iterate"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"for"})," t ",e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"in"})," linspace(0, 1, num_steps):"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"v"})," = model(x, t)"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"x"})," = x + v * dt"]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mt-2",children:"# x is now the generated sample"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"Key Insights"}),e.jsxs("ul",{className:"space-y-3 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Discretization:"})," We approximate the continuous ODE with discrete steps"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Error:"})," More steps = less error, but more compute"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Trade-off:"})," SD3 typically uses 20-50 steps for good quality"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Heun advantage:"})," 2nd order means same accuracy with fewer steps"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Solver Accuracy Comparison"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Solver"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Order"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"NFE/step"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Error (O)"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Best For"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-fuchsia-600 dark:text-fuchsia-400",children:"Euler"}),e.jsx("td",{className:"py-3 px-4",children:"1st"}),e.jsx("td",{className:"py-3 px-4",children:"1"}),e.jsx("td",{className:"py-3 px-4",children:"O(Δt)"}),e.jsx("td",{className:"py-3 px-4",children:"Fast prototyping, many steps"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-purple-600 dark:text-purple-400",children:"Heun"}),e.jsx("td",{className:"py-3 px-4",children:"2nd"}),e.jsx("td",{className:"py-3 px-4",children:"2"}),e.jsx("td",{className:"py-3 px-4",children:"O(Δt²)"}),e.jsx("td",{className:"py-3 px-4",children:"Balanced quality/speed"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-blue-600 dark:text-blue-400",children:"DPM++"}),e.jsx("td",{className:"py-3 px-4",children:"2nd+"}),e.jsx("td",{className:"py-3 px-4",children:"1-2"}),e.jsx("td",{className:"py-3 px-4",children:"O(Δt²)"}),e.jsx("td",{className:"py-3 px-4",children:"Production, few steps"})]})]})]})}),e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-500 mt-4",children:"NFE = Number of Function Evaluations (model calls). Higher order solvers need more evaluations but achieve better accuracy per step."})]})]})}function re(){const[m,S]=u.useState(0),[c,w]=u.useState(1),[g,P]=u.useState([]),x=u.useRef(null),l=u.useRef(null),j=()=>{const s=[];for(let t=0;t<500;t++){const a=Math.random(),n=Math.random(),M=Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*n),o=m+c*M,h=1/(1+Math.exp(-o));s.push(h)}P(s)};return u.useEffect(()=>{j()},[m,c]),u.useEffect(()=>{const s=x.current;if(!s)return;const t=s.getContext("2d"),a=s.width,n=s.height;t.clearRect(0,0,a,n),t.fillStyle="rgba(0, 0, 0, 0.2)",t.fillRect(0,0,a,n),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=1,t.beginPath(),t.moveTo(40,n-40),t.lineTo(a-20,n-40),t.moveTo(40,n-40),t.lineTo(40,20),t.stroke(),t.fillStyle="rgba(255, 255, 255, 0.6)",t.font="12px sans-serif",t.fillText("0",38,n-20),t.fillText("0.5",a/2-10,n-20),t.fillText("1",a-30,n-20),t.fillText("t (timestep)",a/2-30,n-5),t.save(),t.translate(15,n/2),t.rotate(-Math.PI/2),t.fillText("p(t)",0,0),t.restore();const M=d=>{if(d<=0||d>=1)return 0;const k=-((Math.log(d/(1-d))-m)**2)/(2*c**2),T=1/(c*Math.sqrt(2*Math.PI)),f=1/(d*(1-d));return T*Math.exp(k)*f};let o=0;for(let d=1;d<100;d++){const N=d/100;o=Math.max(o,M(N))}t.beginPath();const h=a-60,r=n-60;for(let d=1;d<=99;d++){const N=d/100,k=M(N),T=40+N*h,f=n-40-k/o*r*.9;d===1?t.moveTo(T,f):t.lineTo(T,f)}t.strokeStyle="#ec4899",t.lineWidth=3,t.stroke(),t.lineTo(40+h,n-40),t.lineTo(40,n-40),t.closePath(),t.fillStyle="rgba(236, 72, 153, 0.2)",t.fill();const y=1/(1+Math.exp(-m)),i=40+y*h;t.beginPath(),t.moveTo(i,n-40),t.lineTo(i,30),t.strokeStyle="rgba(139, 92, 246, 0.8)",t.lineWidth=2,t.setLineDash([5,5]),t.stroke(),t.setLineDash([]),t.fillStyle="#8b5cf6",t.fillText(`μ_t = ${y.toFixed(2)}`,i+5,25)},[m,c]),u.useEffect(()=>{const s=l.current;if(!s||g.length===0)return;const t=s.getContext("2d"),a=s.width,n=s.height;t.clearRect(0,0,a,n);const M=30,o=new Array(M).fill(0);g.forEach(y=>{const i=Math.min(Math.floor(y*M),M-1);o[i]++});const h=Math.max(...o),r=a/M;o.forEach((y,i)=>{const d=y/h*(n-10),N=i*r,k=n-d;t.fillStyle=`rgba(236, 72, 153, ${.4+y/h*.4})`,t.fillRect(N,k,r-1,d)})},[g]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Logit-Normal Sampling: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"Time Distribution"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"How SD3 chooses which timesteps to train on"})]}),e.jsx("div",{className:"bg-gradient-to-r from-fuchsia-900/30 to-purple-900/30 rounded-2xl p-6 border border-fuchsia-500/30",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(F,{className:"text-fuchsia-600 dark:text-fuchsia-400 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-fuchsia-300 mb-2",children:"Why Not Uniform Sampling?"}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["During training, we sample random timesteps t to create training pairs.",e.jsx("strong",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:" Uniform sampling"})," treats all timesteps equally, but not all timesteps are equally important! The middle timesteps (t ≈ 0.5) often contain the most learnable signal. Logit-normal sampling lets us focus more training on these critical timesteps."]})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Logit-Normal Distribution"}),e.jsx("canvas",{ref:x,width:400,height:250,className:"w-full rounded-lg mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:["Mean (μ): ",m.toFixed(1)," → mode at t ≈ ",(1/(1+Math.exp(-m))).toFixed(2)]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:m,onChange:s=>S(parseFloat(s.target.value)),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:["Std Dev (σ): ",c.toFixed(1)]}),e.jsx("input",{type:"range",min:"0.3",max:"2",step:"0.1",value:c,onChange:s=>w(parseFloat(s.target.value)),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold",children:["Sampled Timesteps (",g.length,")"]}),e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-3 py-1.5 bg-fuchsia-600 hover:bg-fuchsia-700 rounded-lg text-sm transition-colors",children:[e.jsx(G,{size:14}),"Resample"]})]}),e.jsx("canvas",{ref:l,width:400,height:200,className:"w-full rounded-lg mb-4"}),e.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-500",children:"Histogram of 500 samples from logit-normal distribution"})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"The Mathematics"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-3",children:"Sampling Process"}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-4 font-mono text-sm space-y-2",children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"# 1. Sample from standard normal"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"z"})," ~ N(0, 1)"]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mt-2",children:"# 2. Transform to logit scale"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"logit"})," = μ + σ × z"]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mt-2",children:"# 3. Apply sigmoid"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"t"})," = sigmoid(logit)"]}),e.jsx("p",{className:"pl-4",children:"= 1 / (1 + e^(-logit))"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"PDF Formula"}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"font-mono text-lg text-fuchsia-300 mb-3",children:"p(t) = 1/(σ√(2π)) × 1/(t(1-t)) × e^(-(logit(t)-μ)²/(2σ²))"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"where logit(t) = log(t/(1-t))"})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-800 dark:text-gray-400",children:e.jsxs("p",{children:["The key term ",e.jsx("code",{className:"bg-black/30 px-1 rounded",children:"1/(t(1-t))"})," is the Jacobian of the logit transform, which causes the distribution to concentrate away from t=0 and t=1."]})})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"SD3 Default Parameters"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-fuchsia-900/30 to-fuchsia-800/20 rounded-xl p-4 border border-fuchsia-500/30",children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-2",children:"μ = 0.0"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:'Centers the distribution at t = 0.5, focusing training on the "middle" of the diffusion process where denoising is most challenging.'})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-purple-800/20 rounded-xl p-4 border border-purple-500/30",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-2",children:"σ = 1.0"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"Controls spread. σ=1 gives good coverage while still concentrating on important timesteps. Smaller σ = more focused."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/30 to-blue-800/20 rounded-xl p-4 border border-blue-500/30",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-2",children:"Why It Works"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"Early timesteps (t≈0) have mostly noise. Late timesteps (t≈1) are almost clean. The action is in the middle!"})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Sampling Strategies Compared"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Strategy"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Distribution"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Focus"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Used By"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:"Uniform"}),e.jsx("td",{className:"py-3 px-4",children:"t ~ U(0, 1)"}),e.jsx("td",{className:"py-3 px-4",children:"Equal for all t"}),e.jsx("td",{className:"py-3 px-4",children:"DDPM, DDIM"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-fuchsia-600 dark:text-fuchsia-400",children:"Logit-Normal"}),e.jsx("td",{className:"py-3 px-4",children:"t = σ(μ + σz)"}),e.jsx("td",{className:"py-3 px-4",children:"Middle timesteps"}),e.jsx("td",{className:"py-3 px-4",children:"SD3, Flux"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-purple-600 dark:text-purple-400",children:"Mode Seeking"}),e.jsx("td",{className:"py-3 px-4",children:"Shifted logit-normal"}),e.jsx("td",{className:"py-3 px-4",children:"Near data (t≈1)"}),e.jsx("td",{className:"py-3 px-4",children:"Fine-tuning"})]})]})]})})]})]})}function ie(){const[m,S]=u.useState("linear"),[c,w]=u.useState(20),g=u.useRef(null),P={linear:{name:"Linear",formula:"σ(t) = 1 - t",description:"Constant denoising rate. Simple and effective baseline.",color:"#ec4899",fn:x=>1-x},cosine:{name:"Cosine",formula:"σ(t) = cos(πt/2)",description:"Slower start and end, faster in the middle. Better for high-res images.",color:"#8b5cf6",fn:x=>Math.cos(Math.PI*x/2)},karras:{name:"Karras",formula:"σ(t) = (σ_max^(1/ρ) + t(σ_min^(1/ρ) - σ_max^(1/ρ)))^ρ",description:"Optimized schedule from Karras et al. Popular in practice (ρ=7).",color:"#3b82f6",fn:x=>{const t=.14285714285714285;return Math.pow(Math.pow(1,t)+x*(Math.pow(.002,t)-Math.pow(1,t)),7)}},exponential:{name:"Exponential",formula:"σ(t) = σ_max × exp(-t × log(σ_max/σ_min))",description:"Geometric progression of noise levels.",color:"#10b981",fn:x=>1*Math.exp(-x*Math.log(1/.01))}};return u.useEffect(()=>{const x=g.current;if(!x)return;const l=x.getContext("2d"),j=x.width,s=x.height;l.clearRect(0,0,j,s),l.fillStyle="rgba(0, 0, 0, 0.2)",l.fillRect(0,0,j,s);const t={left:50,right:20,top:30,bottom:50},a=j-t.left-t.right,n=s-t.top-t.bottom;l.strokeStyle="rgba(255, 255, 255, 0.3)",l.lineWidth=1,l.beginPath(),l.moveTo(t.left,s-t.bottom),l.lineTo(j-t.right,s-t.bottom),l.moveTo(t.left,s-t.bottom),l.lineTo(t.left,t.top),l.stroke(),l.strokeStyle="rgba(255, 255, 255, 0.1)";for(let h=0;h<=10;h++){const r=t.left+h/10*a,y=s-t.bottom-h/10*n;l.beginPath(),l.moveTo(r,s-t.bottom),l.lineTo(r,t.top),l.stroke(),l.beginPath(),l.moveTo(t.left,y),l.lineTo(j-t.right,y),l.stroke()}l.fillStyle="rgba(255, 255, 255, 0.6)",l.font="12px sans-serif",l.fillText("0",t.left-5,s-t.bottom+15),l.fillText("1",j-t.right-5,s-t.bottom+15),l.fillText("t (timestep)",j/2-30,s-10),l.save(),l.translate(15,s/2),l.rotate(-Math.PI/2),l.fillText("σ (noise level)",0,0),l.restore(),l.fillText("1",t.left-15,t.top+5),l.fillText("0",t.left-15,s-t.bottom),Object.entries(P).forEach(([h,r])=>{const y=h===m;l.beginPath();for(let i=0;i<=100;i++){const d=i/100,N=r.fn(d),k=t.left+d*a,T=s-t.bottom-N*n;i===0?l.moveTo(k,T):l.lineTo(k,T)}l.strokeStyle=y?r.color:`${r.color}40`,l.lineWidth=y?3:1.5,l.stroke()});const M=P[m];l.fillStyle=M.color;for(let h=0;h<=c;h++){const r=h/c,y=M.fn(r),i=t.left+r*a,d=s-t.bottom-y*n;l.beginPath(),l.arc(i,d,5,0,Math.PI*2),l.fill()}let o=t.top+10;Object.entries(P).forEach(([h,r])=>{const y=h===m;l.fillStyle=r.color,l.fillRect(j-120,o,15,3),l.fillStyle=y?"white":"rgba(255, 255, 255, 0.5)",l.font=y?"bold 11px sans-serif":"11px sans-serif",l.fillText(r.name,j-100,o+4),o+=18})},[m,c]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Sigma Schedules: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"Noise Level Control"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"How noise decreases during the generation process"})]}),e.jsx("div",{className:"bg-gradient-to-r from-fuchsia-900/30 to-purple-900/30 rounded-2xl p-6 border border-fuchsia-500/30",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(F,{className:"text-fuchsia-600 dark:text-fuchsia-400 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-fuchsia-300 mb-2",children:"What is a Sigma Schedule?"}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["The sigma schedule σ(t) defines how much noise is present at each timestep. At t=0, we have maximum noise (σ ≈ 1). At t=1, we have minimum noise (σ ≈ 0). The ",e.jsx("strong",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"shape of this curve"})," affects image quality and generation speed. Different schedules work better for different scenarios."]})]})]})}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("canvas",{ref:g,width:700,height:350,className:"w-full rounded-xl mb-4"}),e.jsxs("div",{className:"flex items-center gap-4 px-4",children:[e.jsxs("span",{className:"text-sm text-gray-800 dark:text-gray-400 w-32",children:["Sampling Steps: ",c]}),e.jsx("input",{type:"range",min:"5",max:"50",step:"1",value:c,onChange:x=>w(parseInt(x.target.value)),className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:Object.entries(P).map(([x,l])=>e.jsxs("button",{onClick:()=>S(x),className:`p-4 rounded-xl border transition-all text-left ${m===x?"border-fuchsia-500 bg-fuchsia-500/20":"border-white/10 bg-black/30 hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:l.color}}),e.jsx("span",{className:"font-bold",children:l.name})]}),e.jsx("code",{className:"text-xs text-gray-800 dark:text-gray-400 block mb-2",children:l.formula}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-500",children:l.description})]},x))}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"When to Use Each Schedule"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/20",children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Schedule"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Pros"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Cons"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-800 dark:text-gray-400",children:"Best For"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/10",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-fuchsia-600 dark:text-fuchsia-400",children:"Linear"}),e.jsx("td",{className:"py-3 px-4",children:"Simple, predictable"}),e.jsx("td",{className:"py-3 px-4",children:"May miss details"}),e.jsx("td",{className:"py-3 px-4",children:"Basic testing"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-purple-600 dark:text-purple-400",children:"Cosine"}),e.jsx("td",{className:"py-3 px-4",children:"Smooth transitions"}),e.jsx("td",{className:"py-3 px-4",children:"Slower at extremes"}),e.jsx("td",{className:"py-3 px-4",children:"High-res images"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-blue-600 dark:text-blue-400",children:"Karras"}),e.jsx("td",{className:"py-3 px-4",children:"Optimized spacing"}),e.jsx("td",{className:"py-3 px-4",children:"More complex"}),e.jsx("td",{className:"py-3 px-4",children:"Production quality"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-green-400",children:"Exponential"}),e.jsx("td",{className:"py-3 px-4",children:"Perceptually uniform"}),e.jsx("td",{className:"py-3 px-4",children:"Needs tuning"}),e.jsx("td",{className:"py-3 px-4",children:"Custom workflows"})]})]})]})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-900/30 to-blue-900/30 rounded-2xl p-6 border border-purple-500/30",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Signal-to-Noise Ratio (SNR)"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-3",children:"The Connection"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:"The sigma schedule directly determines the SNR at each timestep:"}),e.jsxs("div",{className:"bg-black/30 rounded-lg p-4 font-mono text-center",children:[e.jsx("p",{className:"text-lg text-purple-300",children:"SNR(t) = α²(t) / σ²(t)"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400 mt-2",children:"where α(t) = √(1 - σ²(t))"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"Why It Matters"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"High SNR"})," (low σ): Image is mostly visible, fine details"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Low SNR"})," (high σ): Image is mostly noise, global structure"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Karras insight:"})," Equal log-SNR steps work best"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"SD3 Default Configuration"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-2",children:"Schedule"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"Linear or Karras (configurable)"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-purple-300 mb-2",children:"Steps"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"28-50 typical (quality/speed tradeoff)"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-2",children:"Sigma Range"}),e.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-400",children:"σ_max=14.6, σ_min=0.0292"})]})]})]})]})}function ne(){const[m,S]=u.useState("quiz"),[c,w]=u.useState(0),[g,P]=u.useState(null),[x,l]=u.useState(!1),[j,s]=u.useState(0),[t,a]=u.useState(0),[n,M]=u.useState(.5),[o,h]=u.useState(0),[r,y]=u.useState(1),i=[{question:"In flow matching, what does the neural network predict?",options:["The noise ε to be removed","The velocity v_θ(x_t, t) at each point","The final clean image directly","The score function ∇log p(x)"],correct:1,explanation:"Flow matching networks predict the velocity field v_θ(x_t, t) that defines how to move through probability space from noise to data."},{question:"What is the main advantage of flow matching over DDPM?",options:["It uses less memory","It always produces sharper images","It has a simpler training objective and enables flexible noise schedules","It requires no neural network"],correct:2,explanation:"Flow matching has a direct MSE loss on velocity prediction, and the straight-path formulation allows for flexible noise schedules."},{question:"In the Euler method for sampling, what happens at each step?",options:["We subtract predicted noise from the image","We add the velocity times step size: x += v * dt","We multiply by the noise schedule","We sample new noise"],correct:1,explanation:"The Euler method follows the ODE: x_{t+dt} = x_t + v_θ(x_t, t) × dt, adding the velocity times the timestep."},{question:"Why does logit-normal sampling focus on middle timesteps?",options:["Because the network is faster there","Because edge timesteps have less learnable signal","To save computation time","It's just a convention, no real reason"],correct:1,explanation:"Near t=0, images are almost pure noise with little structure. Near t=1, they're almost clean. The most challenging denoising happens in the middle."},{question:"What is the formula for linear interpolation in conditional flow matching?",options:["x_t = x₀ × x₁","x_t = (1-t)x₀ + tx₁","x_t = x₀ - t × x₁","x_t = exp(-t) × x₀"],correct:1,explanation:"Linear interpolation: x_t = (1-t)x₀ + tx₁, where x₀ is noise and x₁ is the target image. At t=0 we have noise, at t=1 we have data."},{question:"What is the target velocity for training when using linear interpolation?",options:["v* = x₀ (the noise)","v* = x₁ (the data)","v* = x₁ - x₀ (data minus noise)","v* = (x₁ + x₀) / 2"],correct:2,explanation:"For linear paths, the velocity is constant: v* = d(x_t)/dt = x₁ - x₀. The network learns to predict this direction at each point."},{question:"What does the Heun method do differently from Euler?",options:["Uses smaller step sizes","Predicts velocity at both start and end of step, then averages","Only works at certain timesteps","Doesn't use a neural network"],correct:1,explanation:"Heun (a predictor-corrector method) evaluates velocity at both the start and predicted end position, then averages them for a more accurate step."},{question:"What does NFE mean in the context of ODE solvers?",options:["Neural Function Estimation","Number of Function Evaluations (model calls)","Normalized Flow Error","Network Forward Execution"],correct:1,explanation:"NFE = Number of Function Evaluations, counting how many times we call the neural network. More NFE = more compute but potentially better quality."},{question:"In the Karras noise schedule, what does the ρ parameter control?",options:["The total number of steps","The curvature of the schedule (how sigmas are spaced)","The final noise level","The learning rate"],correct:1,explanation:"ρ (rho) controls the spacing of sigma values. Higher ρ means more steps at low noise levels. ρ=7 is commonly used."},{question:"What is the relationship between sigma (σ) and SNR?",options:["SNR = σ","SNR = 1/σ","SNR = (1-σ²)/σ²","SNR = σ²"],correct:2,explanation:"SNR (Signal-to-Noise Ratio) = α²/σ² where α = √(1-σ²). Higher σ means more noise, lower SNR."}],d=f=>{x||(P(f),l(!0),a(p=>p+1),f===i[c].correct&&s(p=>p+1))},N=()=>{c<i.length-1&&(w(f=>f+1),P(null),l(!1))},k=()=>{w(0),P(null),l(!1),s(0),a(0)},T=(f,p,v)=>{if(f<=0||f>=1)return 0;const b=-((Math.log(f/(1-f))-p)**2)/(2*v**2),_=1/(v*Math.sqrt(2*Math.PI)),E=1/(f*(1-f));return _*Math.exp(b)*E};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Practice Lab: ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"Test Your Knowledge"})]}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"Quiz yourself and explore interactive calculations"})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>S("quiz"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all ${m==="quiz"?"bg-fuchsia-600 text-white":"bg-white/10 text-gray-800 dark:text-gray-400 hover:bg-white/20"}`,children:[e.jsx(U,{size:20}),"Knowledge Quiz"]}),e.jsxs("button",{onClick:()=>S("calculator"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all ${m==="calculator"?"bg-fuchsia-600 text-white":"bg-white/10 text-gray-800 dark:text-gray-400 hover:bg-white/20"}`,children:[e.jsx(H,{size:20}),"Interactive Calculator"]}),e.jsxs("button",{onClick:()=>S("code"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all ${m==="code"?"bg-fuchsia-600 text-white":"bg-white/10 text-gray-800 dark:text-gray-400 hover:bg-white/20"}`,children:[e.jsx(Z,{size:20}),"Code Exercises"]})]}),m==="quiz"&&e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("span",{className:"text-gray-800 dark:text-gray-400",children:["Question ",c+1," of ",i.length]}),e.jsxs("span",{className:"text-fuchsia-600 dark:text-fuchsia-400 font-bold",children:["Score: ",j,"/",t]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full mb-6 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-fuchsia-500 to-purple-500 transition-all duration-300",style:{width:`${(c+1)/i.length*100}%`}})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:i[c].question}),e.jsx("div",{className:"space-y-3",children:i[c].options.map((f,p)=>{const v=p===i[c].correct,C=g===p;let b="w-full text-left p-4 rounded-xl border transition-all ";return x?v?b+="border-green-500 bg-green-500/20 text-green-300":C?b+="border-red-500 bg-red-500/20 text-red-300":b+="border-white/10 bg-white/5 text-gray-700 dark:text-gray-500":b+="border-white/10 bg-white/5 hover:bg-white/10 hover:border-fuchsia-500/50",e.jsx("button",{onClick:()=>d(p),className:b,disabled:x,children:e.jsxs("div",{className:"flex items-center gap-3",children:[x&&v&&e.jsx(J,{className:"text-green-400",size:20}),x&&C&&!v&&e.jsx(ee,{className:"text-red-400",size:20}),e.jsx("span",{children:f})]})},p)})})]}),x&&e.jsx("div",{className:"bg-white/5 rounded-xl p-4 mb-6",children:e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:"Explanation:"})," ",i[c].explanation]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:[e.jsx(R,{size:18}),"Reset Quiz"]}),x&&c<i.length-1&&e.jsx("button",{onClick:N,className:"px-6 py-2 bg-fuchsia-600 hover:bg-fuchsia-700 rounded-lg transition-colors",children:"Next Question →"}),x&&c===i.length-1&&e.jsxs("div",{className:"text-lg font-bold text-fuchsia-600 dark:text-fuchsia-400",children:["Quiz Complete! Final Score: ",j,"/",i.length]})]})]}),m==="calculator"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Logit-Normal PDF Calculator"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:["t = ",n.toFixed(2)]}),e.jsx("input",{type:"range",min:"0.01",max:"0.99",step:"0.01",value:n,onChange:f=>M(parseFloat(f.target.value)),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:["μ = ",o.toFixed(1)]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:o,onChange:f=>h(parseFloat(f.target.value)),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-800 dark:text-gray-400 block mb-2",children:["σ = ",r.toFixed(1)]}),e.jsx("input",{type:"range",min:"0.3",max:"2",step:"0.1",value:r,onChange:f=>y(parseFloat(f.target.value)),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("h4",{className:"font-bold text-fuchsia-300 mb-3",children:"Results"}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:["logit(t) = log(",n.toFixed(2)," / ",(1-n).toFixed(2),") = ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:Math.log(n/(1-n)).toFixed(4)})]}),e.jsxs("p",{children:["PDF(t) = ",e.jsx("span",{className:"text-fuchsia-600 dark:text-fuchsia-400",children:T(n,o,r).toFixed(4)})]}),e.jsxs("p",{children:["Mode ≈ ",e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:(1/(1+Math.exp(-o))).toFixed(3)})]})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Euler Step Calculator"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("h4",{className:"text-sm text-gray-800 dark:text-gray-400 mb-2",children:"Current Position (x)"}),e.jsx("input",{type:"number",defaultValue:"0",className:"w-full bg-black/30 rounded px-3 py-2 text-white",id:"euler-x"})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("h4",{className:"text-sm text-gray-800 dark:text-gray-400 mb-2",children:"Velocity (v)"}),e.jsx("input",{type:"number",defaultValue:"1",className:"w-full bg-black/30 rounded px-3 py-2 text-white",id:"euler-v"})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("h4",{className:"text-sm text-gray-800 dark:text-gray-400 mb-2",children:"Step Size (dt)"}),e.jsx("input",{type:"number",defaultValue:"0.1",step:"0.01",className:"w-full bg-black/30 rounded px-3 py-2 text-white",id:"euler-dt"})]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-fuchsia-500/20 rounded-xl text-center",children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-400",children:"x_new = x + v × dt"}),e.jsx("p",{className:"text-2xl font-bold text-fuchsia-600 dark:text-fuchsia-400 mt-2",children:"= 0 + 1 × 0.1 = 0.1"})]})]})]}),m==="code"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Exercise 1: Implement Linear Interpolation"}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mb-4",children:"Complete the function to perform linear interpolation between noise x₀ and data x₁:"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm",children:e.jsx("pre",{className:"text-gray-700 dark:text-gray-300",children:`fn interpolate(x0: f32, x1: f32, t: f32) -> f32 {
    // TODO: Return the interpolated value
    // x_t = (1-t)*x0 + t*x1
    ???
}`})}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"text-fuchsia-600 dark:text-fuchsia-400 cursor-pointer hover:text-fuchsia-300",children:"Show Solution"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm mt-2",children:e.jsx("pre",{className:"text-green-400",children:`fn interpolate(x0: f32, x1: f32, t: f32) -> f32 {
    (1.0 - t) * x0 + t * x1
}`})})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Exercise 2: Implement Euler Sampler"}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mb-4",children:"Complete the Euler sampling loop:"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm",children:e.jsx("pre",{className:"text-gray-700 dark:text-gray-300",children:`fn euler_sample(model: &Model, num_steps: usize) -> Tensor {
    let mut x = sample_noise();  // Start from noise
    let dt = 1.0 / num_steps as f32;
    
    for i in 0..num_steps {
        let t = i as f32 / num_steps as f32;
        let v = model.predict_velocity(&x, t);
        // TODO: Update x using Euler step
        ???
    }
    x
}`})}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"text-fuchsia-600 dark:text-fuchsia-400 cursor-pointer hover:text-fuchsia-300",children:"Show Solution"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm mt-2",children:e.jsx("pre",{className:"text-green-400",children:`fn euler_sample(model: &Model, num_steps: usize) -> Tensor {
    let mut x = sample_noise();
    let dt = 1.0 / num_steps as f32;
    
    for i in 0..num_steps {
        let t = i as f32 / num_steps as f32;
        let v = model.predict_velocity(&x, t);
        x = x + v * dt;  // Euler step!
    }
    x
}`})})]})]}),e.jsxs("div",{className:"bg-black/30 rounded-2xl p-6 border border-white/10",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Exercise 3: Sample from Logit-Normal"}),e.jsx("p",{className:"text-gray-800 dark:text-gray-400 mb-4",children:"Implement logit-normal sampling for timesteps:"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm",children:e.jsx("pre",{className:"text-gray-700 dark:text-gray-300",children:`fn sample_logit_normal(mean: f32, std: f32) -> f32 {
    let z: f32 = /* sample from N(0,1) */;
    // TODO: Apply logit-normal transform
    // 1. Compute logit = mean + std * z
    // 2. Apply sigmoid to get t in (0, 1)
    ???
}`})}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"text-fuchsia-600 dark:text-fuchsia-400 cursor-pointer hover:text-fuchsia-300",children:"Show Solution"}),e.jsx("div",{className:"bg-black/50 rounded-lg p-4 font-mono text-sm mt-2",children:e.jsx("pre",{className:"text-green-400",children:`fn sample_logit_normal(mean: f32, std: f32) -> f32 {
    let z = randn();  // Standard normal sample
    let logit = mean + std * z;
    1.0 / (1.0 + (-logit).exp())  // Sigmoid
}`})})]})]})]})]})}const D=[{id:"overview",label:"1. What is Flow Matching?",icon:Y},{id:"flow",label:"2. Flow Concept",icon:W},{id:"euler",label:"3. Euler Scheduler",icon:V},{id:"logit",label:"4. Logit-Normal Sampling",icon:H},{id:"sigma",label:"5. Sigma Schedules",icon:te},{id:"practice",label:"6. Practice Lab",icon:se}];function be(){const[m,S]=u.useState("overview"),c=()=>{switch(m){case"overview":return e.jsx(A,{});case"flow":return e.jsx(ae,{});case"euler":return e.jsx(le,{});case"logit":return e.jsx(re,{});case"sigma":return e.jsx(ie,{});case"practice":return e.jsx(ne,{});default:return e.jsx(A,{})}};return e.jsxs("div",{className:"text-white",children:[e.jsx("nav",{className:"bg-black/20 px-6 py-2 flex gap-2 overflow-x-auto",children:D.map((w,g)=>{const P=w.icon,x=m===w.id,l=D.findIndex(s=>s.id===m),j=g<l;return e.jsxs("button",{onClick:()=>S(w.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${x?"bg-fuchsia-600 text-white":j?"bg-fuchsia-900/50 text-fuchsia-300 hover:bg-fuchsia-800/50":"bg-white/5 text-gray-800 dark:text-gray-400 hover:bg-white/10 hover:text-white"}`,children:[e.jsx(P,{size:18}),w.label]},w.id)})}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("nav",{className:"px-6 py-2 flex gap-2 overflow-x-auto",children:D.map((w,g)=>{const P=w.icon,x=m===w.id,l=D.findIndex(s=>s.id===m),j=g<l;return e.jsxs("button",{onClick:()=>S(w.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${x?"bg-fuchsia-600 text-white":j?"bg-fuchsia-900/50 text-fuchsia-300 hover:bg-fuchsia-800/50":"bg-white/5 text-gray-800 dark:text-gray-400 hover:bg-white/10 hover:text-white"}`,children:[e.jsx(P,{size:18}),w.label]},w.id)})}),e.jsx("div",{className:"h-1 flex",children:D.map((w,g)=>{const P=D.findIndex(x=>x.id===m);return e.jsx("div",{className:`flex-1 transition-all duration-300 ${g<=P?"bg-gradient-to-r from-fuchsia-500 to-purple-600":"bg-transparent"}`},w.id)})}),e.jsx("main",{className:"p-6",children:c()})]})]})}export{be as default};
