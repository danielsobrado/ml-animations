import{r as d,j as e,o as g,e as N}from"./index-BmgLEcVh.js";import{P as f}from"./pause-Pw5n6zyp.js";import{P as v}from"./play-4PCPORJF.js";import{R as y}from"./rotate-ccw-DnC3UZWM.js";import{A as r}from"./arrow-down-Cl-37PhJ.js";function A(){var x,m,p,h;const[t,c]=d.useState(0),[i,o]=d.useState(!1),[w,k]=d.useState(0),b=["The","cat","sat"],j=["Le","chat","s'est","assis"],a=[{title:"Input Tokenization",description:"The input sentence is split into tokens and converted to IDs.",phase:"input"},{title:"Input Embedding",description:"Each token ID is mapped to a dense vector of size d_model (512).",phase:"embed"},{title:"Add Positional Encoding",description:"Positional information is added to embeddings using sinusoidal functions.",phase:"positional"},{title:"Encoder Processing",description:"Input passes through N encoder layers (self-attention + FFN). Each position attends to all positions.",phase:"encoder"},{title:"Encoder Output",description:"Final encoder representations are passed to decoder via cross-attention.",phase:"encoder_out"},{title:"Decoder Input (Shifted)",description:"Previous outputs are embedded and shifted right. <BOS> token starts generation.",phase:"decoder_input"},{title:"Masked Self-Attention",description:"Decoder attends to previous positions only (causal mask prevents looking ahead).",phase:"masked_attn"},{title:"Cross-Attention",description:'Decoder queries attend to encoder keys/values. This is where translation "happens"!',phase:"cross_attn"},{title:"Output Projection",description:"Linear layer + softmax produces probability distribution over vocabulary.",phase:"output"},{title:"Next Token Selection",description:"Select highest probability token (greedy) or sample from distribution. Feed back as input.",phase:"select"}];d.useEffect(()=>{let n;return i&&t<a.length-1?n=setInterval(()=>{c(s=>s+1)},2500):t>=a.length-1&&o(!1),()=>clearInterval(n)},[i,t]);const l=n=>{var u;return((u=a[t])==null?void 0:u.phase)===n?"ring-2 ring-yellow-400 shadow-lg shadow-yellow-400/20 scale-105":""};return e.jsx("div",{className:"p-6 min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-white mb-2",children:["Data Flow: ",e.jsx("span",{className:"gradient-text",children:"End-to-End Journey"})]}),e.jsx("p",{className:"text-slate-400",children:"Watch how data transforms as it flows through the entire Transformer"})]}),e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-2 px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-all",children:[i?e.jsx(f,{size:20}):e.jsx(v,{size:20}),i?"Pause":"Play Flow"]}),e.jsxs("button",{onClick:()=>{c(0),o(!1)},className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-all",children:[e.jsx(y,{size:20}),"Reset"]})]}),e.jsx("div",{className:"flex justify-center gap-1 mb-8",children:a.map((n,s)=>e.jsx("button",{onClick:()=>c(s),className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium transition-all ${t===s?"bg-green-500 text-white scale-110":t>s?"bg-green-500/50 text-white":"bg-slate-700 text-slate-400"}`,children:s+1},s))}),e.jsxs("div",{className:"bg-green-500/20 rounded-xl p-4 mb-6 border border-green-500/30",children:[e.jsxs("h3",{className:"text-green-400 font-bold text-lg mb-1",children:["Step ",t+1,": ",a[t].title]}),e.jsx("p",{className:"text-slate-300",children:a[t].description})]}),e.jsx("div",{className:"bg-slate-800/50 rounded-2xl p-6 border border-slate-700 mb-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"text-slate-400 text-sm text-center mb-2",children:"INPUT (English)"}),e.jsx("div",{className:`flex justify-center gap-2 p-3 rounded-lg transition-all ${l("input")}`,children:b.map((n,s)=>e.jsx("div",{className:"bg-blue-500/80 px-4 py-2 rounded-lg text-white font-medium",children:n},s))})]}),e.jsx(r,{className:`text-slate-500 transition-all ${((x=a[t])==null?void 0:x.phase)==="embed"?"text-yellow-400 scale-125":""}`}),e.jsxs("div",{className:`w-64 p-3 rounded-lg bg-indigo-500/70 text-white text-center transition-all ${l("embed")}`,children:[e.jsx("div",{className:"font-medium",children:"Embedding Layer"}),e.jsx("div",{className:"text-xs opacity-80",children:"token → d_model vector"})]}),e.jsx(r,{className:`text-slate-500 transition-all ${((m=a[t])==null?void 0:m.phase)==="positional"?"text-yellow-400 scale-125":""}`}),e.jsxs("div",{className:`w-64 p-3 rounded-lg bg-cyan-500/70 text-white text-center transition-all ${l("positional")}`,children:[e.jsx("div",{className:"font-medium",children:"+ Positional Encoding"}),e.jsx("div",{className:"text-xs opacity-80",children:"sin/cos functions"})]}),e.jsx(r,{className:"text-slate-500"}),e.jsxs("div",{className:`w-72 p-4 rounded-lg border-2 border-dashed border-green-500/50 transition-all ${l("encoder")}`,children:[e.jsx("div",{className:"text-green-400 font-bold text-center mb-2",children:"ENCODER ×6"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-green-600/50 p-2 rounded text-white text-xs text-center",children:"Self-Attention"}),e.jsx("div",{className:"bg-green-500/50 p-1 rounded text-white text-xs text-center",children:"Add & Norm"}),e.jsx("div",{className:"bg-green-600/50 p-2 rounded text-white text-xs text-center",children:"FFN"}),e.jsx("div",{className:"bg-green-500/50 p-1 rounded text-white text-xs text-center",children:"Add & Norm"})]})]}),e.jsxs("div",{className:"flex items-start gap-8 w-full justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(r,{className:"text-slate-500 mb-2"}),e.jsxs("div",{className:`p-3 rounded-lg bg-green-500 text-white text-center transition-all ${l("encoder_out")}`,children:[e.jsx("div",{className:"text-sm font-medium",children:"Encoder Output"}),e.jsx("div",{className:"text-xs opacity-80",children:"[seq_len, d_model]"})]}),e.jsx(g,{className:"text-yellow-400 mt-2",size:32})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-slate-400 text-xs mb-2",children:"OUTPUT (French) - shifted"}),e.jsxs("div",{className:`flex gap-1 p-2 rounded-lg transition-all ${l("decoder_input")}`,children:[e.jsx("div",{className:"bg-pink-500/80 px-2 py-1 rounded text-white text-xs",children:"<s>"}),j.slice(0,-1).map((n,s)=>e.jsx("div",{className:"bg-pink-500/80 px-2 py-1 rounded text-white text-xs",children:n},s))]}),e.jsx(r,{className:"text-slate-500 my-2"}),e.jsxs("div",{className:`w-64 p-4 rounded-lg border-2 border-dashed border-purple-500/50 transition-all ${l("masked_attn")||l("cross_attn")}`,children:[e.jsx("div",{className:"text-purple-400 font-bold text-center mb-2",children:"DECODER ×6"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`bg-purple-600/50 p-2 rounded text-white text-xs text-center ${((p=a[t])==null?void 0:p.phase)==="masked_attn"?"ring-2 ring-yellow-400":""}`,children:"Masked Self-Attn"}),e.jsx("div",{className:"bg-purple-500/50 p-1 rounded text-white text-xs text-center",children:"Add & Norm"}),e.jsx("div",{className:`bg-yellow-500/50 p-2 rounded text-slate-900 text-xs text-center ${((h=a[t])==null?void 0:h.phase)==="cross_attn"?"ring-2 ring-yellow-400":""}`,children:"Cross-Attention ← K,V"}),e.jsx("div",{className:"bg-purple-500/50 p-1 rounded text-white text-xs text-center",children:"Add & Norm"}),e.jsx("div",{className:"bg-purple-600/50 p-2 rounded text-white text-xs text-center",children:"FFN"})]})]}),e.jsx(r,{className:"text-slate-500 my-2"}),e.jsxs("div",{className:`w-48 p-3 rounded-lg bg-red-500 text-white text-center transition-all ${l("output")}`,children:[e.jsx("div",{className:"font-medium",children:"Linear + Softmax"}),e.jsx("div",{className:"text-xs opacity-80",children:"→ vocab_size probs"})]}),e.jsx(r,{className:"text-slate-500 my-2"}),e.jsxs("div",{className:`p-3 rounded-lg bg-emerald-500 text-white text-center transition-all ${l("select")}`,children:[e.jsx("div",{className:"text-sm font-medium",children:'Selected: "assis"'}),e.jsx("div",{className:"text-xs opacity-80",children:"argmax or sample"})]})]})]})]})}),e.jsxs("div",{className:"bg-slate-800/50 rounded-2xl p-6 border border-slate-700",children:[e.jsxs("h3",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[e.jsx(N,{size:20}),"Tensor Shape Journey"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left text-slate-400 py-2 px-3",children:"Stage"}),e.jsx("th",{className:"text-left text-slate-400 py-2 px-3",children:"Shape"}),e.jsx("th",{className:"text-left text-slate-400 py-2 px-3",children:"Example"})]})}),e.jsxs("tbody",{className:"text-slate-300",children:[e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===0?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"Input tokens"}),e.jsx("td",{className:"py-2 px-3 font-mono text-blue-400",children:"[batch, seq_len]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 128]"})]}),e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===1?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"After embedding"}),e.jsx("td",{className:"py-2 px-3 font-mono text-indigo-400",children:"[batch, seq_len, d_model]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 128, 512]"})]}),e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===3?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"Attention Q,K,V"}),e.jsx("td",{className:"py-2 px-3 font-mono text-purple-400",children:"[batch, heads, seq, d_k]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 8, 128, 64]"})]}),e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===3?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"Attention scores"}),e.jsx("td",{className:"py-2 px-3 font-mono text-yellow-400",children:"[batch, heads, seq, seq]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 8, 128, 128]"})]}),e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===3?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"FFN hidden"}),e.jsx("td",{className:"py-2 px-3 font-mono text-orange-400",children:"[batch, seq, d_ff]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 128, 2048]"})]}),e.jsxs("tr",{className:`border-b border-slate-700/50 ${t===4?"bg-green-500/10":""}`,children:[e.jsx("td",{className:"py-2 px-3",children:"Encoder output"}),e.jsx("td",{className:"py-2 px-3 font-mono text-green-400",children:"[batch, seq_len, d_model]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 128, 512]"})]}),e.jsxs("tr",{className:t===8?"bg-green-500/10":"",children:[e.jsx("td",{className:"py-2 px-3",children:"Final logits"}),e.jsx("td",{className:"py-2 px-3 font-mono text-red-400",children:"[batch, seq_len, vocab_size]"}),e.jsx("td",{className:"py-2 px-3",children:"[32, 128, 32000]"})]})]})]})})]})]})})}export{A as default};
