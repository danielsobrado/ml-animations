import{r as m,j as e,f as c,Z as x}from"./index-quAWpIA7.js";import{H as o}from"./hard-drive-DPqZp4MO.js";import{m as a}from"./proxy-D7LjGbFl.js";import{A as h}from"./alert-triangle-BSxPma3v.js";import{C as b}from"./check-circle-CZEU1TAG.js";function v(){const[r,l]=m.useState(!1),t=8,d=t*t;return e.jsx("div",{className:"p-8 h-full flex flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl w-full",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400 mb-4",children:"The Problem: Memory Bandwidth Bottleneck"}),e.jsxs("p",{className:"text-lg text-slate-700 dark:text-slate-300 leading-relaxed max-w-3xl mx-auto",children:["Standard attention computes the ",e.jsx("strong",{children:"full N×N attention matrix"})," and stores it in slow HBM (High Bandwidth Memory). Flash Attention uses ",e.jsx("strong",{children:"tiling"})," to keep computations in fast SRAM, avoiding the memory bottleneck."]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(o,{className:"text-red-500",size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:"HBM (GPU Memory)"}),e.jsx("p",{className:"text-sm text-red-500",children:"~1.5 TB/s bandwidth"})]})]}),e.jsx("div",{className:"bg-red-100 dark:bg-red-900/40 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-red-600 dark:text-red-400 mb-1",children:"40-80 GB"}),e.jsx("div",{className:"text-sm text-red-500",children:"Large but SLOW to access"})]})}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Standard attention stores the full N×N matrix here. Reading/writing this data is the ",e.jsx("strong",{children:"main bottleneck"}),"!"]})]}),e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-200 dark:border-emerald-800 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(c,{className:"text-emerald-500",size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:"SRAM (On-chip)"}),e.jsx("p",{className:"text-sm text-emerald-500",children:"~19 TB/s bandwidth"})]})]}),e.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/40 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-emerald-600 dark:text-emerald-400 mb-1",children:"20 MB"}),e.jsx("div",{className:"text-sm text-emerald-500",children:"Small but 10x FASTER"})]})}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Flash Attention keeps computations here using ",e.jsx("strong",{children:"tiling"}),". Only small blocks are loaded at a time!"]})]})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("button",{onClick:()=>l(!r),className:"px-6 py-3 bg-amber-500 text-white rounded-xl font-medium hover:bg-amber-600 transition-colors shadow-lg",children:[r?"Hide":"Show"," Attention Matrix Comparison"]})}),r&&e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid md:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(h,{className:"text-red-500",size:20}),e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Standard Attention"})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"grid gap-0.5",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:Array.from({length:d}).map((i,s)=>e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:s*.01},className:"w-6 h-6 bg-red-400 dark:bg-red-600 rounded-sm"},s))})}),e.jsxs("div",{className:"text-center text-sm text-slate-600 dark:text-slate-400",children:["Full ",t,"×",t," = ",e.jsx("span",{className:"font-bold text-red-600",children:d})," elements in HBM"]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"text-emerald-500",size:20}),e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Flash Attention (Tiled)"})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${t/2}, 1fr)`},children:Array.from({length:4}).map((i,s)=>e.jsx(a.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:s*.2},className:"border-2 border-emerald-400 dark:border-emerald-600 rounded p-0.5",children:e.jsx("div",{className:"grid grid-cols-2 gap-0.5",children:Array.from({length:4}).map((j,n)=>e.jsx("div",{className:"w-5 h-5 bg-emerald-400 dark:bg-emerald-600 rounded-sm"},n))})},s))})}),e.jsxs("div",{className:"text-center text-sm text-slate-600 dark:text-slate-400",children:["Only ",e.jsx("span",{className:"font-bold text-emerald-600",children:"4"})," elements in SRAM at a time!"]})]})]}),e.jsx(a.div,{className:"bg-gradient-to-r from-amber-500 to-orange-500 rounded-2xl p-6 text-white",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{size:36}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xl mb-2",children:"The Key Insight"}),e.jsxs("p",{className:"text-amber-100",children:["GPUs spend more time ",e.jsx("strong",{children:"moving data"})," than computing. Flash Attention reduces HBM reads/writes from O(N²) to O(N), achieving ",e.jsx("strong",{children:"2-4x speedup"})," and ",e.jsx("strong",{children:"5-20x memory reduction"}),"while computing ",e.jsx("em",{children:"exact"})," attention!"]})]})]})})]})})}export{v as default};
