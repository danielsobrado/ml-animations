import{r as x,j as e,x as j,L as N}from"./index-CsxpOLHd.js";import{g as y}from"./index-C8pce-KX.js";import{R as v}from"./rotate-ccw-xVnQluc9.js";import{C as w}from"./chevron-left-qHzaZS-I.js";import{P as k}from"./pause-BMcOX1vk.js";import{P as S}from"./play-CIyTSByC.js";const C=(h,b=10)=>{const c=[];h.split(/\s+/).map(i=>i.split("").map((r,d,m)=>d===m.length-1?r+"</w>":r)).flat();let l=h.split(/\s+/).map(i=>i.split("").map((r,d,m)=>d===m.length-1?r+"</w>":r));c.push({title:"Initial Characters",description:"Split each word into characters. Add </w> to mark word endings.",wordTokens:JSON.parse(JSON.stringify(l)),vocabulary:[...new Set(l.flat())],merge:null});for(let i=0;i<b;i++){const r={};if(l.forEach(s=>{for(let a=0;a<s.length-1;a++){const o=s[a]+" "+s[a+1];r[o]=(r[o]||0)+1}}),Object.keys(r).length===0)break;const d=Object.entries(r).reduce((s,a)=>a[1]>s[1]?a:s);if(d[1]<2)break;const[m,n]=d,[p,g]=m.split(" "),t=p+g;l=l.map(s=>{const a=[];let o=0;for(;o<s.length;)o<s.length-1&&s[o]===p&&s[o+1]===g?(a.push(t),o+=2):(a.push(s[o]),o++);return a}),c.push({title:`Merge #${i+1}: "${p}" + "${g}"`,description:`Found pair "${p} ${g}" appears ${n} times. Merge into "${t}"`,wordTokens:JSON.parse(JSON.stringify(l)),vocabulary:[...new Set(l.flat())],merge:{first:p,second:g,merged:t,count:n}})}return c},f=["bg-blue-200 border-blue-400","bg-green-200 border-green-400","bg-purple-200 border-purple-400","bg-orange-200 border-orange-400","bg-pink-200 border-pink-400","bg-yellow-200 border-yellow-400","bg-cyan-200 border-cyan-400","bg-red-200 border-red-400"];function O(){var p,g;const[h,b]=x.useState("low lower lowest"),[c,u]=x.useState([]),[l,i]=x.useState(0),[r,d]=x.useState(!1),m=x.useRef(null);x.useEffect(()=>{const t=C(h,8);u(t),i(0)},[h]),x.useEffect(()=>{if(!r)return;const t=setInterval(()=>{i(s=>s>=c.length-1?(d(!1),s):s+1)},2e3);return()=>clearInterval(t)},[r,c.length]),x.useEffect(()=>{m.current&&y.fromTo(m.current.querySelectorAll(".token-item"),{scale:.8,opacity:0},{scale:1,opacity:1,duration:.3,stagger:.05})},[l]);const n=c[l]||{wordTokens:[],vocabulary:[],title:"",description:""};return e.jsx("div",{className:"p-8 h-full",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-indigo-900 mb-2",children:"Byte Pair Encoding (BPE)"}),e.jsx("p",{className:"text-slate-600",children:"Watch how BPE iteratively merges the most frequent pairs of tokens"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Training Text:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:t=>b(t.target.value),className:"flex-1 p-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500",placeholder:"Enter training text..."}),e.jsx("div",{className:"flex gap-1",children:["low lower lowest","happy happier happiest","play playing played"].map(t=>e.jsxs("button",{onClick:()=>b(t),className:"px-3 py-1 text-xs bg-slate-100 rounded-lg hover:bg-slate-200 whitespace-nowrap",children:[t.slice(0,12),"..."]},t))})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>i(0),className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 transition-colors",title:"Reset",children:e.jsx(v,{size:20})}),e.jsx("button",{onClick:()=>i(Math.max(0,l-1)),disabled:l===0,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 transition-colors disabled:opacity-50",children:e.jsx(w,{size:20})}),e.jsx("button",{onClick:()=>d(!r),className:`px-6 py-2 rounded-lg font-bold transition-colors ${r?"bg-red-500 text-white":"bg-indigo-600 text-white"}`,children:r?e.jsx(k,{size:20}):e.jsx(S,{size:20})}),e.jsx("button",{onClick:()=>i(Math.min(c.length-1,l+1)),disabled:l===c.length-1,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 transition-colors disabled:opacity-50",children:e.jsx(j,{size:20})}),e.jsxs("span",{className:"text-sm text-slate-600",children:["Step ",l+1," / ",c.length]})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-4 mb-6 border border-indigo-200",children:[e.jsx("h3",{className:"font-bold text-indigo-900 text-lg",children:n.title}),e.jsx("p",{className:"text-indigo-800",children:n.description}),n.merge&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-indigo-200 rounded font-mono",children:n.merge.first}),e.jsx("span",{className:"text-indigo-600",children:"+"}),e.jsx("span",{className:"px-2 py-1 bg-indigo-200 rounded font-mono",children:n.merge.second}),e.jsx("span",{className:"text-indigo-600",children:"â†’"}),e.jsx("span",{className:"px-2 py-1 bg-green-200 rounded font-mono font-bold",children:n.merge.merged}),e.jsxs("span",{className:"text-sm text-indigo-600",children:["(",n.merge.count," occurrences)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-bold text-slate-800 mb-3",children:"Current Tokenization"}),e.jsx("div",{ref:m,className:"space-y-3",children:h.split(/\s+/).map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-mono text-slate-600 w-20",children:[t,":"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(n.wordTokens[s]||[]).map((a,o)=>e.jsx("span",{className:`token-item px-2 py-1 rounded border-2 font-mono text-sm ${f[(s+o)%f.length]}`,children:a},o))})]},s))})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-3",children:["Vocabulary (",((p=n.vocabulary)==null?void 0:p.length)||0," tokens)"]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-48 overflow-y-auto",children:(g=n.vocabulary)==null?void 0:g.map((t,s)=>{var a;return e.jsx("span",{className:`px-2 py-1 rounded border font-mono text-xs ${((a=n.merge)==null?void 0:a.merged)===t?"bg-green-200 border-green-400 ring-2 ring-green-500":"bg-white border-slate-300"}`,children:t},s)})})]})]}),e.jsx("div",{className:"mt-6 bg-amber-50 p-4 rounded-xl border border-amber-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(N,{className:"text-amber-600 flex-shrink-0 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-900 mb-2",children:"BPE Algorithm"}),e.jsxs("ol",{className:"text-amber-800 text-sm space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Start with character-level tokens (add end-of-word marker)"}),e.jsx("li",{children:"Count all adjacent token pairs across the corpus"}),e.jsx("li",{children:"Merge the most frequent pair into a new token"}),e.jsx("li",{children:"Repeat until vocabulary size is reached or no more merges"})]})]})]})})]})})}export{O as default};
