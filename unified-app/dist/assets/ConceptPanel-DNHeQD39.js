import{r as n,j as e,R as d,e as c,L as m}from"./index-quAWpIA7.js";import{A as o}from"./alert-triangle-BSxPma3v.js";import{m as r}from"./proxy-D7LjGbFl.js";import{A as i}from"./arrow-down-B9RWJrDO.js";import{C as l}from"./check-circle-CZEU1TAG.js";import{P as h}from"./plus-C2RRVVSj.js";function v(){const[p,j]=n.useState(!1),[a,x]=n.useState(0);return n.useEffect(()=>{const t=setInterval(()=>{x(s=>(s+1)%4)},2e3);return()=>clearInterval(t)},[]),e.jsx("div",{className:"p-8 h-full flex flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl w-full",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400 mb-4",children:"The Residual Stream: A Highway for Information"}),e.jsxs("p",{className:"text-lg text-slate-700 dark:text-slate-300 leading-relaxed max-w-3xl mx-auto",children:["In transformers, each token has a ",e.jsx("strong",{children:"residual stream"})," - a vector that flows through all layers. Instead of overwriting this vector, each layer ",e.jsx("strong",{children:"adds"})," to it. This is the secret to why deep networks work!"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(o,{className:"text-red-500",size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:"Without Residuals"}),e.jsx("p",{className:"text-sm text-red-500",children:"Information gets overwritten"})]})]}),e.jsx("div",{className:"flex flex-col items-center gap-2 mb-4",children:["Input","Layer 1","Layer 2","Layer 3"].map((t,s)=>e.jsxs(d.Fragment,{children:[e.jsxs(r.div,{className:`w-full py-3 rounded-lg text-center font-medium ${s===0?"bg-blue-400 dark:bg-blue-600 text-white":a>=s?"bg-red-400 dark:bg-red-600 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300"}`,animate:{opacity:a>=s||s===0?1:.5,scale:a===s&&s>0?1.02:1},children:[t,a>=s&&s>0&&e.jsx("span",{className:"ml-2 text-xs opacity-80",children:"(overwrites previous)"})]}),s<3&&e.jsx(r.div,{animate:{opacity:a>s?1:.3,y:a===s?[0,5,0]:0},transition:{duration:.5},children:e.jsx(i,{className:"text-red-400",size:20})})]},t))}),e.jsxs("div",{className:"bg-red-100 dark:bg-red-900/40 rounded-lg p-3 text-sm text-red-700 dark:text-red-300",children:[e.jsx("strong",{children:"Problem:"}),' Early information is lost! The model "forgets" what it learned in earlier layers.']})]}),e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-200 dark:border-emerald-800 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(l,{className:"text-emerald-500",size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:"With Residual Stream"}),e.jsx("p",{className:"text-sm text-emerald-500",children:"Information accumulates"})]})]}),e.jsx("div",{className:"flex flex-col items-center gap-2 mb-4",children:["Input","Layer 1","Layer 2","Layer 3"].map((t,s)=>e.jsxs(d.Fragment,{children:[e.jsxs("div",{className:"w-full flex items-center gap-2",children:[e.jsx(r.div,{className:"flex-1 py-3 rounded-lg text-center font-medium bg-gradient-to-r from-cyan-400 to-blue-500 text-white",animate:{boxShadow:a>=s?`0 0 ${10+s*5}px rgba(34, 211, 238, ${.3+s*.1})`:"none"},children:s===0?"x":"x + Î£ layers"}),s>0&&e.jsxs(r.div,{className:"flex items-center gap-1",initial:{opacity:0,x:20},animate:{opacity:a>=s?1:.3,x:0},children:[e.jsx(h,{className:"text-emerald-500",size:16}),e.jsxs("span",{className:"text-xs font-mono bg-emerald-200 dark:bg-emerald-800 px-2 py-1 rounded text-emerald-700 dark:text-emerald-300",children:["f",s,"(x)"]})]})]}),s<3&&e.jsx(r.div,{animate:{opacity:a>s?1:.3,y:a===s?[0,5,0]:0},children:e.jsx(i,{className:"text-emerald-400",size:20})})]},t))}),e.jsxs("div",{className:"bg-emerald-100 dark:bg-emerald-900/40 rounded-lg p-3 text-sm text-emerald-700 dark:text-emerald-300",children:[e.jsx("strong",{children:"Solution:"})," Each layer adds its contribution. Original information is preserved throughout!"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700 mb-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx(c,{className:"text-cyan-500",size:24}),"The Residual Formula"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4",children:[e.jsxs("div",{className:"text-center font-mono text-lg mb-2",children:[e.jsx("span",{className:"text-cyan-600 dark:text-cyan-400",children:"x"}),e.jsx("span",{className:"text-slate-500 mx-2",children:"="}),e.jsx("span",{className:"text-cyan-600 dark:text-cyan-400",children:"x"}),e.jsx("span",{className:"text-emerald-500 mx-2",children:"+"}),e.jsx("span",{className:"text-indigo-500",children:"f(x)"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center",children:"Output = Input + Layer's Contribution"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4",children:[e.jsxs("div",{className:"text-center font-mono text-lg mb-2",children:[e.jsxs("span",{className:"text-cyan-600 dark:text-cyan-400",children:["x",e.jsx("sub",{children:"out"})]}),e.jsx("span",{className:"text-slate-500 mx-2",children:"="}),e.jsxs("span",{className:"text-cyan-600 dark:text-cyan-400",children:["x",e.jsx("sub",{children:"in"})]}),e.jsx("span",{className:"text-slate-500 mx-1",children:"+"}),e.jsx("span",{className:"text-purple-500",children:"Attn(x)"}),e.jsx("span",{className:"text-slate-500 mx-1",children:"+"}),e.jsx("span",{className:"text-orange-500",children:"FFN(x)"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center",children:"In Transformers: Add Attention + MLP outputs"})]})]})]}),e.jsx(r.div,{className:"bg-gradient-to-r from-cyan-500 to-blue-500 rounded-2xl p-6 text-white",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(m,{size:36,className:"flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xl mb-3",children:"Why This Design is Brilliant"}),e.jsxs("ul",{className:"space-y-2 text-cyan-100",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No Overwriting:"}),' Information from layer 1 can directly influence layer 96. The model never "forgets" early features.']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Gradient Highway:"})," Gradients can flow directly back through the residual connection, solving the vanishing gradient problem."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(l,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Depth Works:"})," This is why we can train 96-layer GPT-4 or 80-layer Llama models. Without residuals, 6 layers would be the limit!"]})]})]})]})]})})]})})}export{v as default};
